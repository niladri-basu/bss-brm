select unique TO_CHAR(h.VALID_FROM, 'YYYYMMDDHH24MISS') VALID_FROM, g.REF_PARAM, f.PIN_SERVICETYPE, f.SERVICECODE, e.RATEPLAN, (select CODE from ifw_rateplan where rateplan = e.rateplan) RATEPLANNAME, a.CODE, h.VERSION, c.CASCADING  from ifw_discountmodel a, ifw_discountdetail b,  ifw_dscmdl_cnf c, ifw_discountstep d, ifw_rateplan_ver e, ifw_service f, ifw_ref_map g, ifw_dscmdl_ver h where d.DISCOUNTRULE = c.DISCOUNTRULE and c.DISCOUNTMODEL = a.DISCOUNTMODEL and d.DISCOUNTMASTER = b.DISCOUNTMASTER and (b.servicecode IN('.*', '*') OR  f.SERVICECODE = b.SERVICECODE OR 0 < INSTR(b.servicecode, f.servicecode, 1, 1)) and f.servicecode <> '*' AND f.PIN_SERVICETYPE = g.REF_OBJ and h.DISCOUNTMODEL = a.DISCOUNTMODEL and h.DISCOUNTMODEL = c.DISCOUNTMODEL and a.DISCOUNTMODEL = e.DISCOUNTMODEL (+);
