#version 7.5.0 1.50
# @(#)$Id: wireless.reg /cgbubrm_7.5.0.pipeline/3 2013/05/08 03:17:20 asranjan Exp $
#=======================================================
# Updated by GSM
#=======================================================

ifw
{
  Active              = TRUE
  ProcessLoopTimeout  = 10
  QueueRequestTimeout = 0

  ParallelLoadManager
  {
    #Active = TRUE
    Active = False
    NumberOfThreads = 5 
  }

  Instrumentation
  {
    #-----------------------------------------------------------
    # ProbeBroker registry entries.
    #    ProbeInfoFilePath - The path that contains all probe
    #                        info files used by instrumented objects.
    #-----------------------------------------------------------
    ProbeBroker
    {
      ProbeInfoFilePath = ./instrumentation
    }

    #-----------------------------------------------------------
    # SnmpServer registry entries. (Optional)
    #    Port - The SNMP AgentX port number.
    #    ProcessDescription - The description of this process.
    #                         If not specified, the process description
    #                         has format as follows:
    #                         <<user>>:<<process_name>>::<<registry_filename>>
    #-----------------------------------------------------------
    #SnmpServer
    #{
    #  Port = < SNMP AgentX Port >
    #  ProcessDescription = ifw
    #}

    #-----------------------------------------------------------
    # HttpServer registry entries. (Optional)
    #    Port - The Http port number.
    #    StyleSheetFile - The full path name of style sheet file.
    #    PortalLogoFile - The full path name of Portal logo file.
    #-----------------------------------------------------------
    #HttpServer
    #{
    #  Port = < HTTP Port >
    #  StyleSheetFile = ./instrumentation/portal_omf.xsl
    #  PortalLogoFile = ./instrumentation/portal_omf.gif
    #}
  }

  DiagnosticDataHandler   
  {
    DiagnosticFilePath = ./log
    DiagnosticFileName = diagnostic.dat      
  }

  LogMessageTable
  {
    MessageFilePath   = ./etc
    MessageFileSuffix = .msg
  }

  Semaphore
  {
    FilePath = ./semaphore
    FileName = semaphore.reg
  }

  Registry
  {
    FilePath           = ./info
    FileName           = infoWIRELESS.reg
    NiceFormatFileName = infoNiceWIRELESS.reg
    Buffer
    {
      Size = 100
    }
  }

  ProcessLog
  {
    ModuleName = LOG
    Module
    {
      ITO
      {
        WriteMessageKey  = True
        FilePath          = /var/portal/ifw/log/process
        FileName          = processWIRELESS
        FileSuffix        = .log
        ProcessName       = ifw
        MessageGroup      = IFW
        ShowOriginator    = TRUE
	# Added by GSM
	#LogLevel = warning
	LogLevel = major
      }
      Buffer
      {
        Size = 1000
      }
    }
  }
 
  MemoryMonitor
  {
    ScaleUnit = M
    WarningFreeMemLimit = 10
    ShutdownFreeMemLimit = 5
  }

  DataPool
  {
    #-----------------------------------------------------------
    # Database Connection IntegRate
    #-----------------------------------------------------------
    #-----------------------------------------------------------
 Login
    {
      ModuleName = DBC
      Module
      {
        # Common
	UserName           = INTEGRATE
        PassWord           = &aes|08|0D5E11BFDD97D2769D9B0DBFBD1BBF7E174B446E7DA339AD5BEAFC967ECA419FD3
        DatabaseName       = BRMUAT
        AccessLib          = oci11g72
        Connections        = 5


        #ConvertToUpperCase = False
        #UsableCheckTable   = IFW_DBVERSION
      }
    }

    #-----------------------------------------------------------
    # Database Connection Infranet
    #-----------------------------------------------------------
    LoginInfranet 
    { 
      ModuleName = DBC 
      Module 
      {
        # Common
         UserName           = PIN
        PassWord           = &aes|10|0D5E11BFDD97D2769D9B0DBFBD1BBF7EC23D94E0FFD3C7A7B1152827133F1C2726
        DatabaseName       = BRMUAT
        AccessLib          = oci11g72
        Connections        = 5
        #ConvertToUpperCase = False
        #UsableCheckTable   = IFW_DBVERSION
      } 
    }  

    #-----------------------------------------------------------
    # Database Connection Queue
    #-----------------------------------------------------------
    LoginQueue
    {
      ModuleName = DBC
      Module
      {
        # Common
         UserName           = PIN
        PassWord           = &aes|10|0D5E11BFDD97D2769D9B0DBFBD1BBF7EC23D94E0FFD3C7A7B1152827133F1C2726
        DatabaseName       = BRMUAT
        AccessLib          = oci11g72
        Connections        = 5

        #ConvertToUpperCase = False
        #UsableCheckTable   = IFW_DBVERSION
      }
    }

	#--------------------------------------------------------
    # PortalConfig Data Module
    #-----------------------------------------------------------
    PortalConfigDataModule
    {
      ModuleName = DAT_PortalConfig
      Module
      {
      # ReuseOnFailure = True
        InfranetConnection = ifw.DataPool.LoginInfranet
      }
    }

    #-----------------------------------------------------------
    # Infranet Listener
    #-----------------------------------------------------------
    Listener 
    { 
      ModuleName = DAT_Listener 
      Module 
      { 
        InfranetConnection = ifw.DataPool.LoginQueue
        QueueName = IFW_SYNC_QUEUE
        LogEvents = TRUE
	#Disabled by GSM from performance perspective
        #LogEvents = FALSE
        QueueLibrary = OracleQueue

#       AckQueueName = RERATING_ACK_QUEUE 
#       AckQueueNameAMM = AMT_QUEUE
        EventThreadAllocation
        {
  	   RecycleRequest = 1
#          OpenNewAcctCycle = 2
#          RecycleJob = 1
        }
#       EnableInterLeavingStatistics = false
#       ProcessAllEvents             = true
#       InterleavingReqd             = false
#       MaxNumEvents                 = 900   # suggested min. value 900
#       MinNumEvents                 = 300   # suggested min. value 300
       CheckInterval                = 60    # suggested min. value 60 [sec]
#       MaxEventProcessTime          = 60    # suggested min. value 60 [sec]
#       MaxCDRProcessTime            = 300   # suggested min. value 300 [sec]
      } 
    }

    #-----------------------------------------------------------
    # Infranet Customer Data
    #-----------------------------------------------------------
    CustomerData
    {
      ModuleName = DAT_AccountBatch
      Module
      {
        IntegrateConnection = ifw.DataPool.Login
        InfranetConnection  = ifw.DataPool.LoginInfranet
        PortalConfigDataModule = ifw.DataPool.PortalConfigDataModule
        #LogEvents           = True
	#Disabled by GSM
        LogEvents           = False
        LoadLogins          = True    
        Connections         = 5
        #InitialLoading      = True    
        InitialLoading      = FALSE    
        AddAliasList        = False    
        ReadAccountBalances = False    
        Threads             = 4
        UseAsRouter         = False    
        Listener            = ifw.DataPool.Listener
	LoadPercentage  = 10
	
	## TimesTenEnabled should be set to True for TimesTen Enabled Installations
	TimesTenEnabled     = False 

        ##To enable UseLatestProductAndDiscount if you do NOT want to
        ##consider the product creation time when establishing product validity.
        ##If only the usage start and end times are considered, 
        ##updates to product (like back-dated purchases) are validated immediately.

        #UseLatestProductAndDiscount = False

        ##To read System Product data from main table for rerating pipeline and
        ##from the audit table for batch pipeline processing
        #ReadSystemProductFromMain = False

        #ReadAllProducts     = False
        #ReadPlans           = False

        ##Balance Group Monitor related registries:
        # Below entry is obsolete now, as this config value is requested 
        # from DAT_PortalConfig. If the below entry present, the value
        # in DAT_PortalConfig cache will take higher priority. 
        #ReadBalanceGroupMonitors = False

        #ThreadGroupSharingBalanceMonitorsHashMapSize = 1024

        ##Rating Product related registry setting:
        # The default is true; meaning that the edr is enriched only with 
        # purchasedProducts whose serviceId matches thelogin serviceId.
        # If false, then the scope is widened and the edr is enriched with 
        # all purchased products whose serviceType matches the login serviceType;
        #EnrichRatingProductOnly = true

        ## Registry Values to override the default HashMap sizes
        ## during the multi-threaded initialization operation.
        #ThreadAccountHashMapSize               = 1024
        #ThreadServiceHashMapSize               = 1024
        #ThreadLoginHashMapSize                 = 1024
        #ThreadGroupSharingDiscountsHashMapSize = 1024
        #ThreadGroupSharingChargesHashMapSize   = 1024
        #ThreadGroupSharingMonitorsHashMapSize  = 1024
        #ThreadGroupSharingProfilesHashMapSize  = 1024
        #ThreadEventOrderProfilesHashMapSize    = 1024
        #ProfilesNotLoadedIntoEdr { FRIENDS_FAMILY }
      }
	ModuleName = Dat_AccountRealtime
    	Module
    	{
      		#
    	}
    }

    #-----------------------------------------------------------
    # Zone Data Module
    #-----------------------------------------------------------
    ZoneDataModule
    {
      ModuleName = DAT_Zone
      Module
      {
        ReuseOnFailure = FALSE
        Source         = DataBase
        MaxAge         = 0
        DistCalcMode   = DISC
        DataConnection = ifw.DataPool.Login
        LoadZoneDescription = False
        LoadZoneEntryName = False
        CliMode       = DEC

        ZoneModels
        {
        }
      }
    }


    #-----------------------------------------------------------
    # USC Map Data Module
    #-----------------------------------------------------------
    USCDataModule
    {
      ModuleName = DAT_USC_Map
      Module
      {
        Source         = DataBase
        DataConnection = ifw.DataPool.Login
        LoadZoneDescription = False
        LoadZoneEntryName = False
#        PreCompiledDataDir = ./compiled_usc_data
#        NumberOfThreads = 5
#        UscGroups {  ALL_RATE }
      }
    }

    #-----------------------------------------------------------
    # Prefix Description Data Module
    #-----------------------------------------------------------
    PrefixDescDataModule
    { 
      ModuleName = DAT_PrefixDesc 
      Module 
      { 
        Source = Database 
        DataConnection = ifw.DataPool.Login
        ReuseOnFailure = false 
        CLIBase = 10 
      } 
    }
    #-----------------------------------------------------------
    # Price Data Module
    #-----------------------------------------------------------
    PriceDataModule
    {
      ModuleName = DAT_PriceModel
      Module
      {
        DataConnection = ifw.DataPool.Login
        Listener = ifw.DataPool.Listener
        LogEvents = false
      }
    }
    #-----------------------------------------------------------
    # Calendar Data Module
    #-----------------------------------------------------------
    CalendarDataModule
    {
      ModuleName = DAT_Calendar
      Module
      {
        DataConnection = ifw.DataPool.Login
      }
    }
    #-----------------------------------------------------------
    # Rateplan Data Module
    #-----------------------------------------------------------
    RateplanDataModule
    {
      ModuleName = DAT_Rateplan
      Module
      {
        DataConnection = ifw.DataPool.Login
        Listener = ifw.DataPool.Listener
        LogEvents = false
      }
    }
    #-----------------------------------------------------------
    # Time Data Module
    #-----------------------------------------------------------
    TimeDataModule
    {
      ModuleName = DAT_TimeModel
      Module
      {
        DataConnection = ifw.DataPool.Login
      }
    }
    #-----------------------------------------------------------
    # DayRate Data Module
    #-----------------------------------------------------------
    DayRateDataModule
    {
      ModuleName = DAT_Dayrate
      Module
      {
        DataConnection = ifw.DataPool.Login
      }
    }
    #-----------------------------------------------------------
    # Exchange Rate Data Module
    #-----------------------------------------------------------    
    ExchangeRateDataModule
    {
      ModuleName = DAT_ExchangeRate
      Module
      {
        DataConnection = ifw.DataPool.Login
        ReuseOnFailure = TRUE
      }
    }
    #-----------------------------------------------------------
    # Scenario Reader
    #-----------------------------------------------------------
    ScenarioReader
    {
      ModuleName = DAT_ScenarioReader
      Module
      {
        DataConnection = ifw.DataPool.Login
        Calendar       = 20000
      }
    }
    #-----------------------------------------------------------
    # Currency Data Module
    #-----------------------------------------------------------
    CurrencyDataModule 
    {
      ModuleName = DAT_Currency
      Module
      {
        ReuseOnFailure = TRUE 
        InfranetConnection  = ifw.DataPool.LoginInfranet
      }
    }
    #-----------------------------------------------------------
    # Discount Model Data Module
    #-----------------------------------------------------------
    DiscountModelDataModule
    {
      ModuleName = DAT_Discount
      Module
      {
        InfranetConnection  = ifw.DataPool.LoginInfranet
        IntegrateConnection = ifw.DataPool.Login
        AccountDataModule   = ifw.DataPool.CustomerData
	PortalConfigDataModule = ifw.DataPool.PortalConfigDataModule

	#Customizable iScript files supporting EVAL function - Gurvinder Minhas
        EvalScriptFiles
        {
                #scriptFile2 = ./iScriptLib/iScriptLib_Standard/ISC_getBTDCount.isc
                #scriptFile1 = ./iScriptLib/iScriptLib_Standard/ISC_getAggBalance.isc
		scriptFile1 = ./TD/iScript_custom/ISC_CustomBTD.isc
        }
        #serv_filter_list = /service/telco/gsm/telephony
      }
    }
    #-----------------------------------------------------------
    # Balance Data Module
    #-----------------------------------------------------------
    BalanceDataModule
    {
      ModuleName = DAT_BalanceBatch
      Module
      {
        InfranetConnection  = ifw.DataPool.LoginInfranet
        DiscountDataModule  = ifw.DataPool.DiscountModelDataModule
        AccountDataModule   = ifw.DataPool.CustomerData
        PortalConfigDataModule = ifw.DataPool.PortalConfigDataModule
        ListenerDataModule  = ifw.DataPool.Listener
        BalanceDirectory    = ./data/balance
        UseFlexibleConsumptionRule = True #Default Value = True 
        #LogEvents           = True
        #3LogTransactions     = True
	#Added by GSM 
        LogEvents           = False
        LogTransactions     = False
	SelectiveSubBalLoad = True
	#Added by GSM to support DR1
	#VirtualTime = True
      }
    }
    #--------------------------------------------------------
    # ModelSelector Data Module
    #-----------------------------------------------------------
    ModelSelectorDataModule
    {
      ModuleName = DAT_ModelSelector
      Module
      {
	ListenerDataModule  = ifw.DataPool.Listener
        IntegrateConnection = ifw.DataPool.Login
        LogEvents           = True
      }
    }
    #-----------------------------------------------------------
    # ItemAssign Data Module
    #-----------------------------------------------------------
    ItemAssignDataModule
    {
      ModuleName = DAT_ItemAssign
      Module
      {
        InfranetConnection  = ifw.DataPool.LoginInfranet
        AccountDataModule  = ifw.DataPool.CustomerData
        PortalConfigDataModule = ifw.DataPool.PortalConfigDataModule
        ItemPoidReservedRangeUnitSize = 10000
      }
    }
    #--------------------------------------------------------
    # Recycling Data
    #-----------------------------------------------------------
    RecyclingData
    {
      ModuleName = DAT_Recycle
      Module
      {
        Listener = ifw.DataPool.Listener
        #LogEvents = True
        LogEvents = False
        ControlPath = ./database/Oracle/Scripts/Suspense 
        ParameterFile = parameter.isc
        QueueFileName       = RecycleJobIds_wireless.dat
        QueueFilePath       = ./data
        ProcessCount        = 50
        PipelineCategory    = RatingPipeline
      }
    }
  } # end of data pool
  
  TransactionIdController
  { 
    Source = File
    
    Generator
    {
      FileName = ./tam/TransactionIDsWIRELESS.dat
      Increment = 200
    }
  }

  SequencerPool
  {
  }

  Pipelines
  {

    PRE_PROCESS_PREPAID
    {
      Active = TRUE
      RejectStream = RejectOutput
      TransactionManager
      {
        RedoEnabled = True #False
        SingleTransaction = False
        WriteToLogEnabled = True
        BinaryLogFileName = ./tam/binaryLogFilePRE_PROCESS_PREPAID.dat
      }
      #---------------------------------
      EdrFactory
      {
        DataConnection = ifw.DataPool.Login
        Description = ./TD/formatDesc/Portal/td_containerDesc.dsc
        UsageStatistic = /var/portal/ifw/log/statistic/edrStatisticPRE_PROCESS_PREPAID.txt
        EdrVersionDataConnection = ifw.DataPool.LoginInfranet
      }
      #---------------------------------
      DataDescription  
      {
        Standard
        {
          ModuleName = Standard
          Module
          {
            StreamFormats
            {
              SIMPLESAMPLE = ./TD/formatDesc/Formats/MED_Format/TD_MED_Format.dsc
              SOL42_SUSPENSE = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_RATE.dsc
              SUSPENSE_CREATE_OUTPUT = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageCreation.dsc
              SUSPENSE_UPDATE_OUTPUT = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageUpdate.dsc
            }
            InputMapping
            {
              SIMPLESAMPLE = ./TD/formatDesc/Formats/MED_Format/TD_MED_InMap.dsc
            }
            OutputMapping
            {
              EDR_OUTPUT = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_RATE_OutMap.dsc
              SUSPENSE_CREATE_OUTPUT = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageCreationMapping.dsc
              SUSPENSE_UPDATE_OUTPUT = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageUpdateMapping.dsc
            }
          }
        }
      }

      #---------------------------------
      # Pipeline Log Section
      #---------------------------------
      PipelineLog
      {
        ModuleName = LOG
        Module
        {
          ITO
          {
            FilePath = /var/portal/ifw/log/pipeline
            FileName = pipeline_PRE_PROCESS_PREPAID.log
            ProcessName = ifw
            MessageGroup = IFW
            ShowOriginator = True
	    # Added by GSM
            #LogLevel = warning
            LogLevel = major
            SuppressErrors
            {
              ERR_SPEC_VERSION_INVALID
              ERR_RELEASE_VERSION_INVALID
      	      WRN_NO_GLID 
            }
          }

          Buffer
          {
            Size = 500
          }
        }
       }# Pipeline log
     InputBuffer
      {
        Size = 100
      }

      OutputBuffer
      {
        Size = 100
      }

      #---------------------------------
      # Input section
      #---------------------------------
      Input
      {
        #UnitsPerTransaction = 1
	UnitsPerTransaction = 200

        InputModule
        {
          ModuleName = INP_GenericStream
          Module
          {
            DefaultOutput = EdrOutput
            Grammar = ./TD/formatDesc/Formats/MED_Format/TD_MED_InGrammar.dsc

            InputStream
            {
              ModuleName = EXT_InFileManager
              Module
              {
                InputDirEmptyTimeout = 10

                InputPath   = /cdrapp_prepaid/in
		#InputPath   = /cdrapp_prepaid/in_tmp
                InputPrefix = TD_PRE
                InputSuffix = .cdr
 
                DonePath    = /cdrapp_prepaid/done
                DonePrefix  = test_PREPROCESS
                DoneSuffix  = .done
           
                ErrorPath   = /cdrapp_prepaid/error
                ErrorPrefix = test_PREPROCESS
                ErrorSuffix = .err

                TempPrefix  = tmp_PREPROCESS
  
                Replace     = TRUE
              }
            }
          }
        }
      }

      #---------------------------------
      # Functions Section
      #---------------------------------
      Functions
      {
        Standard
        {
          FunctionPool
          {

        EdrDump_PreProcess
          {
            ModuleName = FCT_EdrDump
            Module
            {
              Active   = FALSE
              FileName = /cdrapp_prepaid/dump/PreProcessMapping.dump
            }
          }


        EdrDump_Fake
          {
            ModuleName = FCT_EdrDump
            Module
            {
              Active   = FALSE
              FileName = /cdrapp_prepaid/dump/Fake.dump
            }
          }
#--------------------------------------------------
            # Duplicate Check
            #--------------------------------------------------
            DuplicateCheck
            {
              ModuleName = FCT_DuplicateCheck
              Module
              {
                Active = TRUE
                Path = /cdrapp_prepaid/dup
                FileName = calls.duplicate
                StreamName = DuplicateOutput
                #BufferLimit = 20150601
                BufferLimit = 20170901
                SearchKey = DETAIL.A_NUMBER
                #StoreLimit = 20150301
                StoreLimit = 20170901
                DataConnection = ifw.DataPool.Login
                IndexSpaceName = INTEGRATE_TS_1_IDX
                TableSpaceName = INTEGRATE_TS_1_DAT
                Fields
                {
                  1 = DETAIL.ASS_CI.SEQUENCE_NUMBER
                  2 = DETAIL.ASS_CI.CDR_TYPE
		  3 = DETAIL.DESCRIPTION
		  4 = DETAIL.ASS_CI.SCP_ID
                }
              }
            }

	    #=====================================================
            # Added by GSM  
	    #=====================================================
	    #--------------------------------------------------
            # Split Output per ServiceCode
            #--------------------------------------------------              
            ServiceOutputEdrSplit
            {
              ModuleName = FCT_IRules
              Module
              {
                Active = TRUE
                Source = File
                Rules
                {
                }
                Descriptions
                {
                  ServiceCodeSplitPost = ./TD/iScript_custom/IRL_EventTypeSplittingEdr_GSM.irl
                }
              }
            }
	    #=====================================================

            #--------------------------------------------------
            # Rejection
            #--------------------------------------------------
            Rejection
            {
              ModuleName = FCT_Reject
              Module
              {
                Active          = True
                NotifyOnReject  = True
                UseRejectStream = True
                StreamMap
                {
                }

              }
            }
          } # end FunctionPool
        } # end Standard
      } # end Functions

      #---------------------------------
      # Output Section
      #---------------------------------
      Output
      {
        ChargePrecision = 3
        WriteDefaultEdr = False
        SpecificationVersionNumber = 2
	#SequenceGeneration = Unit
        SequenceGeneration = Transaction
        #Unit - Transaction

        MaxErrorRates
        {
          INF_EDR_REJECTED = 100
        }
        
        #---------------------------------
        OutputCollection 
        {
        #----------------------------------------------
        # The DevNull stream
        #---------------------------------------------------
        DevNull
        {
          ModuleName = OUT_DevNull
          Module
          {
        }
        } # end of DevNull
##--------------------------------------------------------------------
          ## Output stream for duplicate events
          ##--------------------------------------------------------------------
          DuplicateOutput
          {
            ModuleName = OUT_Reject
            Module
            {
              DeleteEmptyStream = TRUE # defaults to TRUE
              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/reject
                  OutputPrefix = test
                  OutputSuffix = .dup
                  TempPrefix   = tmp
                  TempDataPath    = /cdrapp_prepaid/reject
                  TempDataPrefix  = dup.tmp.
                  TempDataSuffix  = .data
                  Replace = TRUE
                }
              }
            }
          } # end of DuplicateOutput

        ##--------------------------------------------------------------------
        ## Output stream for rejected events
        ##--------------------------------------------------------------------
        RejectOutput
        {
          ModuleName = OUT_Reject
          Module
          {
            DeleteEmptyStream = TRUE # defaults to TRUE
            OutputStream
            {
              ModuleName = EXT_OutFileManager
              Module
              {
                OutputPath = /cdrapp_prepaid/reject
                OutputPrefix = test_PREPROCESS
                OutputSuffix = .data
                TempPrefix   = tmp_PREPROCESS
                TempDataPath    = /cdrapp_prepaid/reject
                TempDataPrefix  = pre.tmp.
                TempDataSuffix  = .pre
                Replace = TRUE
              }
            }
          }
        } # end of RejectOutput

        #-----------------------------
        EdrOutput
        {
          ModuleName = OUT_GenericStream
          ProcessType = PREPROCESS_PIPELINE
          Module
          {
            Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_RATE_OutGrammar.dsc
            DeleteEmptyStream = True
            OutputStream
            {
              ModuleName = EXT_OutFileManager
              Module
              {
                OutputPath = /cdrapp_prepaid/edr/others
                OutputPrefix = TD_RATE_PRE
                OutputSuffix = .edr
                TempPrefix = tmp_PREPROCESS
                TempDataPath = /cdrapp_prepaid/edr/others
                TempDataPrefix = new.tmp.
                TempDataSuffix = .edr
                Replace = True
                AppendSequenceNumber = False
              }
            }
          }
        } # end of EdrOutput

	#=====================================================
        # Added by GSM
        #=====================================================
	EdrTELOutput
        {
          ModuleName = OUT_GenericStream
          ProcessType = PREPROCESS_PIPELINE
          Module
          {
            Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_RATE_OutGrammar.dsc
            DeleteEmptyStream = True
            OutputStream
            {
              ModuleName = EXT_OutFileManager
              Module
              {
                OutputPath = /cdrapp_prepaid/edr/telephony
                OutputPrefix =TD_RATE_PRE_TEL
                OutputSuffix = .edr
                TempPrefix = tmp_PREPROCESS_TEL
                TempDataPath = /cdrapp_prepaid/edr/telephony
                TempDataPrefix = new.tmp.
                TempDataSuffix = .edr
                Replace = True
                AppendSequenceNumber = False
              }
            }
          }
	}
	
	EdrDATAOutput
        {
          ModuleName = OUT_GenericStream
          ProcessType = PREPROCESS_PIPELINE
          Module
          {
            Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_RATE_OutGrammar.dsc
            DeleteEmptyStream = True
            OutputStream
            {
              ModuleName = EXT_OutFileManager
              Module
              {
                OutputPath = /cdrapp_prepaid/edr/data
                OutputPrefix =TD_RATE_PRE_DAT
                OutputSuffix = .edr
                TempPrefix = tmp_PREPROCESS_DAT
                TempDataPath = /cdrapp_prepaid/edr/data
                TempDataPrefix = new.tmp.
                TempDataSuffix = .edr
                Replace = True
                AppendSequenceNumber = False
              }
            }
          }
	}

	EdrSMSOutput
        {
          ModuleName = OUT_GenericStream
          ProcessType = PREPROCESS_PIPELINE
          Module
          {
            Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_RATE_OutGrammar.dsc
            DeleteEmptyStream = True
            OutputStream
            {
              ModuleName = EXT_OutFileManager
              Module
              {
                OutputPath = /cdrapp_prepaid/edr/sms
                OutputPrefix =TD_RATE_PRE_SMS
                OutputSuffix = .edr
                TempPrefix = tmp_PREPROCESS_SMS
                TempDataPath = /cdrapp_prepaid/edr/sms
                TempDataPrefix = new.tmp.
                TempDataSuffix = .edr
                Replace = True
                AppendSequenceNumber = False
              }
            }
          }
	}

        #=====================================================
        } # end of OutputCollection


        #-------------------------------
        OutputLog
        {
          FilePath = /var/portal/ifw/log/stream
          FileName = stream
          FilePrefix = log_
          FileSuffix = .log
          SuppressErrors
          {
            ERR_SPEC_VERSION_INVALID
            ERR_RELEASE_VERSION_INVALID
          WRN_NO_GLID
	  }
        } # end of OutputLog

        #-------------------------------
        EdrTraceEnabled = FALSE
    	EdrTrace
    	{
            TraceLog
            {
                 FilePath   = /var/portal/ifw/log/edrLog
                 FileName   = edrTraceLog
                 FilePrefix = log_
                 FileSuffix = .log
            }

            TraceStartPoint =  Input
            TraceEndPoint   = Output

    	} # END EdrTrace

      } # END Output
    } # END PreProcessPipelinePrepaid

    PRE_PROCESS_POSTPAID
    {
      Active = TRUE
      RejectStream = RejectOutput
      TransactionManager
      {
        RedoEnabled = True #False
        SingleTransaction = False
        WriteToLogEnabled = True
        BinaryLogFileName = ./tam/binaryLogFilePRE_PROCESS_POSTPAID.dat
      }
      #---------------------------------
      EdrFactory
      {
        DataConnection = ifw.DataPool.Login
        Description = ./TD/formatDesc/Portal/td_containerDesc.dsc
        UsageStatistic = /var/portal/ifw/log/statistic/edrStatisticPRE_PROCESS_POSTPAID.txt
        EdrVersionDataConnection = ifw.DataPool.LoginInfranet
      }
      #---------------------------------
      DataDescription  
      {
        Standard
        {
          ModuleName = Standard
          Module
          {
            StreamFormats
            {
              SIMPLESAMPLE = ./TD/formatDesc/Formats/MED_Format/TD_MED_Format.dsc
              SOL42_SUSPENSE = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_RATE.dsc
              SUSPENSE_CREATE_OUTPUT = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageCreation.dsc
              SUSPENSE_UPDATE_OUTPUT = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageUpdate.dsc
            }
            InputMapping
            {
              SIMPLESAMPLE = ./TD/formatDesc/Formats/MED_Format/TD_MED_InMap.dsc
            }
            OutputMapping
            {
              EVENT_LOADER = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_RATE_OutMap.dsc
              SUSPENSE_CREATE_OUTPUT = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageCreationMapping.dsc
              SUSPENSE_UPDATE_OUTPUT = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageUpdateMapping.dsc
            }
          }
        }
      }

      #---------------------------------
      # Pipeline Log Section
      #---------------------------------
      PipelineLog
      {
        ModuleName = LOG
        Module
        {
          ITO
          {
            FilePath = /var/portal/ifw/log/pipeline
            FileName = pipeline_PRE_PROCESS_POSTPAID.log
            ProcessName = ifw
            MessageGroup = IFW
            ShowOriginator = True
	    # Added by GSM
            #LogLevel = warning
            LogLevel = major
            SuppressErrors
            {
              ERR_SPEC_VERSION_INVALID
              ERR_RELEASE_VERSION_INVALID
      		WRN_NO_GLID 
            }
          }

          Buffer
          {
            Size = 500
          }
        }
       }# Pipeline log
     InputBuffer
      {
        Size = 100
      }

      OutputBuffer
      {
        Size = 100
      }

      #---------------------------------
      # Input section
      #---------------------------------
      Input
      {
        #UnitsPerTransaction = 1
        UnitsPerTransaction = 200

        InputModule
        {
          ModuleName = INP_GenericStream
          Module
          {
            DefaultOutput = EdrOutput
            Grammar = ./TD/formatDesc/Formats/MED_Format/TD_MED_InGrammar.dsc

            InputStream
            {
              ModuleName = EXT_InFileManager
              Module
              {
                InputDirEmptyTimeout = 10

                InputPath   = /cdrapp_postpaid/in
                #InputPath   = /cdrapp_postpaid/in_tmp
                InputPrefix = TD_POST
                InputSuffix = .cdr
 
                DonePath    = /cdrapp_postpaid/done
                DonePrefix  = test_PREPROCESS
                DoneSuffix  = .done
           
                ErrorPath   = /cdrapp_postpaid/error
                ErrorPrefix = test_PREPROCESS
                ErrorSuffix = .err

                TempPrefix  = tmp_PREPROCESS
  
                Replace     = TRUE
              }
            }
          }
        }
      }

      #---------------------------------
      # Functions Section
      #---------------------------------
      Functions
      {
        Standard
        {
          FunctionPool
          {

        EdrDump_PreProcess
          {
            ModuleName = FCT_EdrDump
            Module
            {
              Active   = FALSE
              FileName = /cdrapp_postpaid/dump/PreProcessMapping.dump
            }
          }


        EdrDump_Fake
          {
            ModuleName = FCT_EdrDump
            Module
            {
              Active   = FALSE
              FileName = /cdrapp_postpaid/dump/Fake.dump
            }
          }

		#--------------------------------------------------
            # Duplicate Check
            #--------------------------------------------------
            DuplicateCheck
            {
              ModuleName = FCT_DuplicateCheck
              Module
              {
                Active = TRUE
                Path = /cdrapp_postpaid/dup
                FileName = calls.duplicate
                StreamName = DuplicateOutput
                #BufferLimit = 20150601
                BufferLimit = 20170901
                SearchKey = DETAIL.A_NUMBER
                #StoreLimit = 20150301
                StoreLimit = 20170901
                DataConnection = ifw.DataPool.Login
                IndexSpaceName = INTEGRATE_TS_1_IDX
                TableSpaceName = INTEGRATE_TS_1_DAT
                Fields
                {
                  1 = DETAIL.ASS_CI.SEQUENCE_NUMBER
                  2 = DETAIL.ASS_CI.CDR_TYPE
     		  3 = DETAIL.DESCRIPTION
		  4 = DETAIL.ASS_CI.SCP_ID
                }
              }
            }

	    #=====================================================
            # Added by GSM  
	    #=====================================================
	    #--------------------------------------------------
            # Split Output per ServiceCode
            #--------------------------------------------------              
            ServiceOutputEdrSplit
            {
              ModuleName = FCT_IRules
              Module
              {
                Active = TRUE
                Source = File
                Rules
                {
                }
                Descriptions
                {
                  ServiceCodeSplitPost = ./TD/iScript_custom/IRL_EventTypeSplittingEdr_GSM.irl
                }
              }
            }


            #--------------------------------------------------
            # Rejection
            #--------------------------------------------------
            Rejection
            {
              ModuleName = FCT_Reject
              Module
              {
                Active          = True
                NotifyOnReject  = True
                UseRejectStream = True
                StreamMap
                {
                }

              }
            }
          } # end FunctionPool
        } # end Standard
      } # end Functions

      #---------------------------------
      # Output Section
      #---------------------------------
      Output
      {
        ChargePrecision = 3
        WriteDefaultEdr = False
        SpecificationVersionNumber = 2
        #SequenceGeneration = Unit
        SequenceGeneration = Transaction
        #Unit - Transaction

        MaxErrorRates
        {
          INF_EDR_REJECTED = 100
        }
        
        #---------------------------------
        OutputCollection 
        {
        #----------------------------------------------
        # The DevNull stream
        #---------------------------------------------------
        DevNull
        {
          ModuleName = OUT_DevNull
          Module
          {
        }
        } # end of DevNull
			##--------------------------------------------------------------------
          ## Output stream for duplicate events
          ##--------------------------------------------------------------------
          DuplicateOutput
          {
            ModuleName = OUT_Reject
            Module
            {
              DeleteEmptyStream = TRUE # defaults to TRUE
              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_postpaid/reject
                  OutputPrefix = test
                  OutputSuffix = .dup
                  TempPrefix   = tmp
                  TempDataPath    = /cdrapp_postpaid/reject
                  TempDataPrefix  = dup.tmp.
                  TempDataSuffix  = .data
                  Replace = TRUE
                }
              }
            }
          } # end of DuplicateOutput


        ##--------------------------------------------------------------------
        ## Output stream for rejected events
        ##--------------------------------------------------------------------
        RejectOutput
        {
          ModuleName = OUT_Reject
          Module
          {
            DeleteEmptyStream = TRUE # defaults to TRUE
            OutputStream
            {
              ModuleName = EXT_OutFileManager
              Module
              {
                OutputPath = /cdrapp_postpaid/reject
                OutputPrefix = test_PREPROCESS
                OutputSuffix = .data
                TempPrefix   = tmp_PREPROCESS
                TempDataPath    = /cdrapp_postpaid/reject
                TempDataPrefix  = pre.tmp.
                TempDataSuffix  = .pre
                Replace = TRUE
              }
            }
          }
        } # end of RejectOutput

        #-----------------------------
        EdrOutput
        {
          ModuleName = OUT_GenericStream
          ProcessType = PREPROCESS_PIPELINE
          Module
          {
            Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_RATE_OutGrammar.dsc
            DeleteEmptyStream = True
            OutputStream
            {
              ModuleName = EXT_OutFileManager
              Module
              {
                #OutputPath = /cdrapp_postpaid/edr
                OutputPath = /cdrapp_postpaid/edr/others
                OutputPrefix =TD_RATE_POST 
                OutputSuffix = .edr
                TempPrefix = tmp_PREPROCESS
                #TempDataPath = /cdrapp_postpaid/edr
                TempDataPath = /cdrapp_postpaid/edr/others
                TempDataPrefix = new.tmp.
                TempDataSuffix = .edr
                Replace = True
                AppendSequenceNumber = False
              }
            }
          }
        } # end of EdrOutput
        #=====================================================
        # Added by GSM
        #=====================================================
	EdrTELOutput
        {
          ModuleName = OUT_GenericStream
          ProcessType = PREPROCESS_PIPELINE
          Module
          {
            Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_RATE_OutGrammar.dsc
            DeleteEmptyStream = True
            OutputStream
            {
              ModuleName = EXT_OutFileManager
              Module
              {
                OutputPath = /cdrapp_postpaid/edr/telephony
                OutputPrefix =TD_RATE_POST_TEL
                OutputSuffix = .edr
                TempPrefix = tmp_PREPROCESS_TEL
                TempDataPath = /cdrapp_postpaid/edr/telephony
                TempDataPrefix = new.tmp.
                TempDataSuffix = .edr
                Replace = True
                AppendSequenceNumber = False
              }
            }
          }
	}
	
	EdrDATAOutput
        {
          ModuleName = OUT_GenericStream
          ProcessType = PREPROCESS_PIPELINE
          Module
          {
            Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_RATE_OutGrammar.dsc
            DeleteEmptyStream = True
            OutputStream
            {
              ModuleName = EXT_OutFileManager
              Module
              {
                OutputPath = /cdrapp_postpaid/edr/data
                OutputPrefix =TD_RATE_POST_DAT
                OutputSuffix = .edr
                TempPrefix = tmp_PREPROCESS_DAT
                TempDataPath = /cdrapp_postpaid/edr/data
                TempDataPrefix = new.tmp.
                TempDataSuffix = .edr
                Replace = True
                AppendSequenceNumber = False
              }
            }
          }
	}

	EdrSMSOutput
        {
          ModuleName = OUT_GenericStream
          ProcessType = PREPROCESS_PIPELINE
          Module
          {
            Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_RATE_OutGrammar.dsc
            DeleteEmptyStream = True
            OutputStream
            {
              ModuleName = EXT_OutFileManager
              Module
              {
                OutputPath = /cdrapp_postpaid/edr/sms
                OutputPrefix =TD_RATE_POST_SMS
                OutputSuffix = .edr
                TempPrefix = tmp_PREPROCESS_SMS
                TempDataPath = /cdrapp_postpaid/edr/sms
                TempDataPrefix = new.tmp.
                TempDataSuffix = .edr
                Replace = True
                AppendSequenceNumber = False
              }
            }
          }
	}

        #=====================================================
        } # end of OutputCollection

        #-------------------------------
        OutputLog
        {
          FilePath = /var/portal/ifw/log/stream
          FileName = stream
        #=====================================================
        } # end of OutputCollection

        #-------------------------------
        OutputLog
        {
          FilePath = /var/portal/ifw/log/stream
          FileName = stream
          FilePrefix = log_
          FileSuffix = .log
	  # Added by GSM
          #LogLevel = warning
          LogLevel = major
	
          SuppressErrors
          {
            ERR_SPEC_VERSION_INVALID
            ERR_RELEASE_VERSION_INVALID
         WRN_NO_GLID 
	 }
        } # end of OutputLog

        #-------------------------------
        EdrTraceEnabled = FALSE
    	EdrTrace
    	{
            TraceLog
            {
                 FilePath   = /var/portal/ifw/log/edrLog
                 FileName   = edrTraceLog
                 FilePrefix = log_
                 FileSuffix = .log
            }

            TraceStartPoint =  Input
            TraceEndPoint   = Output

    	} # END EdrTrace

      } # END Output
    } # END PreProcessPipelinePostpaid


    PRE_RECYCLE
    {
      Active                      = TRUE
      MobileCountryCode           = 262
      NationalAccessCode          = 0
      #InternationalAccessCode     = 00
      #InternationalAccessCodeSign = +
      NetworkDestinationCode      = 172
      RejectStream                = DevNull
      TransactionManager
      {
        RedoEnabled       = True #False
        SingleTransaction = False
        WriteToLogEnabled = True
        BinaryLogFileName = ./tam/binaryLogFilePRE_RECYCLE.dat
      }
      EdrFactory
      {
        DataConnection = ifw.DataPool.Login
        Description = ./TD/formatDesc/Portal/td_containerDesc.dsc
        UsageStatistic = ./data/log/edrStatisticPRE_RECYCLE.txt
        EdrVersionDataConnection = ifw.DataPool.LoginInfranet
      }
      DataDescription
      {
        Standard
        {
          ModuleName = Standard
          Module
          {
            StreamFormats
            {
              SOL42_SUSPENSE = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_RATE.dsc
            }
            InputMapping
            {
            }
            OutputMapping
            {
              EDR_OUTPUT = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_RATE_OutMap.dsc
            }
          }
        }
      } # end of DataDescription
      PipelineLog
      {
        ModuleName = LOG
        Module
        {
          ITO
          {
            FilePath = /var/portal/ifw/log/pipeline
            FileName = pipeline_PRE_RECYCLE.log
            ProcessName = ifw
            MessageGroup = IFW
            ShowOriginator = TRUE
	    # Added by GSM
            #LogLevel = warning
            LogLevel = major
          }
          Buffer
          {
            Size = 500
          }
        }
      } # end of PipelineLog
      InputBuffer
      {
        BlockTransfer = False
        Size = 100
        BlockSize = 100
      }
      OutputBuffer
      {
        BlockTransfer = False
        Size = 100
        BlockSize = 100
      }
      #-------------------------------------------------------------------
      # Input section
      Input
      {
        UnitsPerTransaction = 1
        InputModule
        {
          ModuleName  = INP_Recycle
          Module
          {
            DefaultOutput       = PreRecycleOutputPrepaid 
            RecyclingDataModule = ifw.DataPool.RecyclingData
            InfranetConnection = ifw.DataPool.LoginInfranet
            InputStream
            {
              ModuleName = EXT_InEasyDB
              Module
              {
                DataConnection        = ifw.DataPool.LoginInfranet
                ControlPath           = ./database/Oracle/Scripts/Suspense 
                FileName              = DB
                FileNameExtension     = true
                InputPrefix           = sol42_
                InputSuffix           = .dat
                FieldDelimiter        = \t
                RecordDelimiter       = \n
                ParameterFile         = parameter.isc
                SqlHeader             = RecycleHeader.sql
                SqlDetail             = RecycleDetail.sql
                Replace               = true
                SynchronizeWithOutput = true
                NumberOfRows          = 1000
              }
            } # end of InputStream
          }
        } # end of InputModule
      } # end of Input

      #---------------------------------------------------------------
      # Function section
      #-----------------------------------------------------------------
      Functions
      {
        PreProcessing
        {
          FunctionPool
          {
            #--------------------------------------------------
            # Split Output per Subscription Type
            #--------------------------------------------------
            SubscriptionOutputSplit
            {
              ModuleName = FCT_IRules
              Module
              {
                Active = TRUE
                Source = File
                Rules
                {
                }
                Descriptions
                {
                  SubscriptionOutputSplit = ./TD/iScript_custom/IRL_RecordTypeSplitting.irl
                }
              }
            }
          } # END FunctionPool
        } # END PreProcessing
      } # END Functions

      #--------------------------------------------------
      # Output Section
      #--------------------------------------------------
      Output
      {
        WriteDefaultEdr            = False
        DeleteEmptyFile            = True

        MaxErrorRates
        {
        }
        OutputCollection
        {
          #----------------------------------------------------------------
          # The DevNull stream
          #---------------------------------------------------------------
          DevNull
          {
            ModuleName = OUT_DevNull
            Module
            {
            }
          } # end of DevNull

          #--------------------------------------------------------------------
          # The EDR output stream
          #--------------------------------------------------------------------
          PreRecycleOutputPrepaid
          {
            ModuleName = OUT_GenericStream
            ProcessType = RECYCLING_PIPELINE
            #EventType = /recycle_suspended_usage
                        EventType = /suspended_usage/telco/gsm
            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_RATE_OutGrammar.dsc
              DeleteEmptyStream         = True
              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath    = /cdrapp_prepaid/edr/others
                  OutputPrefix  = TD_RATE_PRE
                  OutputSuffix  = .edr
                  TempPrefix    = tmp_PRERECYCLE
                  TempDataPath  = /cdrapp_prepaid/edr/others
                  TempDataPrefix = recycle.tmp.
                  TempDataSuffix = .edr
                  Replace = TRUE
                }
              }
            }
          } # end of PreRecycleOutputPrepaid
			
          
		  #--------------------------------------------------------------------
          # The EDR output stream voice
          #--------------------------------------------------------------------
          PreRecycleOutputPrepaidTEL
          {
            ModuleName = OUT_GenericStream
            ProcessType = RECYCLING_PIPELINE
            #EventType = /recycle_suspended_usage
                        EventType = /suspended_usage/telco/gsm
            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_RATE_OutGrammar.dsc
              DeleteEmptyStream         = True
              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath    = /cdrapp_prepaid/edr/telephony
                  OutputPrefix  = TD_RATE_PRE
                  OutputSuffix  = .edr
                  TempPrefix    = tmp_PRERECYCLE
                  TempDataPath  = /cdrapp_prepaid/edr/telephony
                  TempDataPrefix = recycle.tmp.
                  TempDataSuffix = .edr
                  Replace = TRUE
                }
              }
            }
          } # end of PreRecycleOutputPrepaidTEL
		  #--------------------------------------------------------------------
          # The EDR output stream SMS
          #--------------------------------------------------------------------
          PreRecycleOutputPrepaidSMS
          {
            ModuleName = OUT_GenericStream
            ProcessType = RECYCLING_PIPELINE
            #EventType = /recycle_suspended_usage
                        EventType = /suspended_usage/telco/gsm
            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_RATE_OutGrammar.dsc
              DeleteEmptyStream         = True
              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath    = /cdrapp_prepaid/edr/sms
                  OutputPrefix  = TD_RATE_PRE
                  OutputSuffix  = .edr
                  TempPrefix    = tmp_PRERECYCLE
                  TempDataPath  = /cdrapp_prepaid/edr/sms
                  TempDataPrefix = recycle.tmp.
                  TempDataSuffix = .edr
                  Replace = TRUE
                }
              }
            }
          } # end of PreRecycleOutputPrepaidSMS
		  #--------------------------------------------------------------------
          # The EDR output stream DATA
          #--------------------------------------------------------------------
          PreRecycleOutputPrepaidDATA
          {
            ModuleName = OUT_GenericStream
            ProcessType = RECYCLING_PIPELINE
            #EventType = /recycle_suspended_usage
                        EventType = /suspended_usage/telco/gsm
            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_RATE_OutGrammar.dsc
              DeleteEmptyStream         = True
              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath    = /cdrapp_prepaid/edr/data
                  OutputPrefix  = TD_RATE_PRE
                  OutputSuffix  = .edr
                  TempPrefix    = tmp_PRERECYCLE
                  TempDataPath  = /cdrapp_prepaid/edr/data
                  TempDataPrefix = recycle.tmp.
                  TempDataSuffix = .edr
                  Replace = TRUE
                }
              }
            }
          } # end of PreRecycleOutputPrepaidDATA
		  
		  
		  
		  PreRecycleOutputPostpaid
          {
            ModuleName = OUT_GenericStream
            ProcessType = RECYCLING_PIPELINE
            #EventType = /recycle_suspended_usage
            EventType = /suspended_usage/telco/gsm
            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_RATE_OutGrammar.dsc
              DeleteEmptyStream         = True
              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath    = /cdrapp_postpaid/edr/others
                  OutputPrefix  = TD_RATE_POST
                  OutputSuffix  = .edr
                  TempPrefix    = tmp_PRERECYCLE
                  TempDataPath  = /cdrapp_postpaid/edr/others
                  TempDataPrefix = recycle.tmp.
                  TempDataSuffix = .edr
                  Replace = TRUE
                }
              }
            }
          } # end of PreRecycleOutputPostpaid
		  
		  #--------------------------------------------------------------------
          # The EDR output stream voice
          #--------------------------------------------------------------------
		PreRecycleOutputPostpaidTEL
          {
            ModuleName = OUT_GenericStream
            ProcessType = RECYCLING_PIPELINE
            #EventType = /recycle_suspended_usage
            EventType = /suspended_usage/telco/gsm
            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_RATE_OutGrammar.dsc
              DeleteEmptyStream         = True
              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath    = /cdrapp_postpaid/edr/telephony
                  OutputPrefix  = TD_RATE_POST
                  OutputSuffix  = .edr
                  TempPrefix    = tmp_PRERECYCLE
                  TempDataPath  = /cdrapp_postpaid/edr/telephony
                  TempDataPrefix = recycle.tmp.
                  TempDataSuffix = .edr
                  Replace = TRUE
                }
              }
            }
          } # end of PreRecycleOutputPostpaidTEL
		  
		  #--------------------------------------------------------------------
          # The EDR output stream SMS
          #--------------------------------------------------------------------
		  PreRecycleOutputPostpaidSMS
          {
            ModuleName = OUT_GenericStream
            ProcessType = RECYCLING_PIPELINE
            #EventType = /recycle_suspended_usage
            EventType = /suspended_usage/telco/gsm
            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_RATE_OutGrammar.dsc
              DeleteEmptyStream         = True
              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath    = /cdrapp_postpaid/edr/sms
                  OutputPrefix  = TD_RATE_POST
                  OutputSuffix  = .edr
                  TempPrefix    = tmp_PRERECYCLE
                  TempDataPath  = /cdrapp_postpaid/edr/sms
                  TempDataPrefix = recycle.tmp.
                  TempDataSuffix = .edr
                  Replace = TRUE
                }
              }
            }
          } # end of PreRecycleOutputPostpaidSMS
		  
		  #--------------------------------------------------------------------
          # The EDR output stream DATA
          #--------------------------------------------------------------------
			PreRecycleOutputPostpaidDATA
          {
            ModuleName = OUT_GenericStream
            ProcessType = RECYCLING_PIPELINE
            #EventType = /recycle_suspended_usage
            EventType = /suspended_usage/telco/gsm
            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_RATE_OutGrammar.dsc
              DeleteEmptyStream         = True
              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath    = /cdrapp_postpaid/edr/data
                  OutputPrefix  = TD_RATE_POST
                  OutputSuffix  = .edr
                  TempPrefix    = tmp_PRERECYCLE
                  TempDataPath  = /cdrapp_postpaid/edr/data
                  TempDataPrefix = recycle.tmp.
                  TempDataSuffix = .edr
                  Replace = TRUE
                }
              }
            }
          } # end of PreRecycleOutputPostpaidDATA
		
        }


        

        OutputLog
        {
          FilePath        = /var/portal/ifw/log/stream
          FileName        = stream
          FilePrefix      = Stream_
          FileSuffix      = .log

          SuppressErrors
          {
            ERR_SPEC_VERSION_INVALID
            ERR_RELEASE_VERSION_INVALID
         WRN_NO_GLID 
	 }
        }

        SequenceGeneration = Unit

        #-------------------------------
        EdrTraceEnabled = False
        EdrTrace
        {
            TraceLog
            {
                 FilePath   = /var/portal/ifw/log/edrLog
                 FileName   = edrTraceLog
                 FilePrefix = log_
                 FileSuffix = .log
            }

            TraceStartPoint =  Input
            TraceEndPoint   = Output

        } # END EdrTrace
         

      } # END Output
    } # END PreRecyclePipeline
	
    TD_POSTPAID_RATE
    {
      Active                      = TRUE
      
      CountryCode                 = 974 
      MobileCountryCode           = 974
      NationalAccessCode          = 0
      #InternationalAccessCode     = 00
      #InternationalAccessCodeSign = +
      NetworkDestinationCode      = 172
      RejectStream                = SuspenseCreateOutput
      
      TransactionManager
      {
        RedoEnabled = True #False
        SingleTransaction = False
        WriteToLogEnabled = True
        BinaryLogFileName = ./tam/binaryLogFilePostpaidWIRELESS.dat
      }
      
      EdrFactory 
      { 
        DataConnection = ifw.DataPool.Login 
        Description =  ./TD/formatDesc/Portal/td_containerDesc.dsc
        UsageStatistic = /var/portal/ifw/log/statistic/edrStatisticWIRELESS.txt 
        EdrVersionDataConnection = ifw.DataPool.LoginInfranet
      }

      DataDescription
      {
        Standard
        {
          ModuleName = Standard
          Module
          {
            StreamFormats
            {
	      SOL42_FORINPUT = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_RATE_FORINPUT.dsc
              EVENT_LOADER = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_Format.dsc
              SUSPENSE_CREATE_OUTPUT = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageCreation.dsc
              SUSPENSE_UPDATE_OUTPUT = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageUpdate.dsc
            }

            InputMapping
            {
              SOL42_FORINPUT = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_RATE_InMap.dsc
            }

            OutputMapping
            {
              EVENT_LOADER = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutMap.dsc
              SUSPENSE_CREATE_OUTPUT = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageCreationMapping.dsc
              SUSPENSE_UPDATE_OUTPUT = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageUpdateMapping.dsc
            }
          }
        }
      } # end of DataDescription

      PipelineLog 
      { 
        ModuleName = LOG
        Module 
        { 
          ITO 
          { 
            WriteMessageKey  = True
            FilePath = /var/portal/ifw/log/pipeline
            FileName = pipeline_TD_POSTPAID_RATE.log
            ProcessName = ifw
            MessageGroup = IFW
            ShowOriginator = TRUE
	    # Added by GSM
            #LogLevel = warning
            LogLevel = major
          }

          Buffer 
          { 
            #Size = 500
            #Updated by GSM
	    Size = 1000
          } 
        } 
      } # end of PipelineLog


      InputBuffer
      {
        BlockTransfer = False
        #Size = 1
        #BlockSize = 1
	#Updated by GSM
        Size = 100
        BlockSize = 100
      }

      OutputBuffer
      {
        BlockTransfer = False
        #Size = 1
        #BlockSize = 1
        #Updated by GSM
	Size = 100
        BlockSize = 100
      }
      
      #------------------------------------------------------------------------
      # Input section
      #------------------------------------------------------------------------
      Input
      {
        #UnitsPerTransaction = 1
        UnitsPerTransaction = 2

        InputModule
        {
          ModuleName  = INP_GenericStream
          Module
          {
            Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_RATE_InGrammar.dsc
            DefaultOutput = TELOutput

            InputStream
            {
              ModuleName = EXT_InFileManager
              Module
              {
                InputDirEmptyTimeout = 10

                #InputPath   = /cdrapp_postpaid/edr
                InputPath   = /cdrapp_postpaid/edr/others
                InputPrefix = TD_RATE_POST
                InputSuffix = .edr
 
                DonePath    = /cdrapp_postpaid/done
                DonePrefix  = test_ALLRATE
                DoneSuffix  = .done
           
                ErrorPath   = /cdrapp_postpaid/error
                ErrorPrefix = test_ALLRATE
                ErrorSuffix = .err

                TempPrefix  = tmp_ALLRATE
  
                Replace     = TRUE
              }
            } # end of InputStream
          }
        } # end of InputModule
      } # end of Input

      
      #------------------------------------------------------------------------
      # Function section
      #------------------------------------------------------------------------
      Functions 
      {
        Processing
        {
          FunctionPool
          {

        EdrDump_PreSuspenseDump
          {
            ModuleName = FCT_EdrDump
            Module
            {
              Active   = FALSE
              FileName = /cdrapp_postpaid/dump/PreSuspense.dump
            }
          }

            #---------------------------------------------------
            # PreSuspense FCT
            #---------------------------------------------------
            PreSuspense
            {
              ModuleName = FCT_PreSuspense
              Module
              {
                Active = True
			QueryableFields
			{

				SUSP_USAGE_TELCO_INFO_T
				{
					# format : <database_column_name> = <edr_conatiner_field_name>
					START_TIME = DETAIL.CHARGING_START_TIMESTAMP
					CALL_DURATION = DETAIL.DURATION
					CALLING_FROM = DETAIL.A_NUMBER
					CALLED_TO = DETAIL.B_NUMBER
                                        SERVICE_TYPE = DETAIL.BASIC_SERVICE
                                        USAGE_TYPE = DETAIL.USAGE_TYPE
				}
                     		SUSP_USAGE_TELCO_GSM_INFO_T
                     		{
                        		CELL_ID = DETAIL.ASS_GSMW_EXT.CELL_ID
                         		DESTINATION_SID = DETAIL.ASS_GSMW_EXT.TERMINATING_SWITCH_IDENTIFICATION
                        		DIALED_NUMBER = DETAIL.ASS_GSMW_EXT.DIALED_DIGITS
                        		ORIGIN_SID = DETAIL.ASS_GSMW_EXT.ORIGINATING_SWITCH_IDENTIFICATION 
                                     	SECONDARY_MSID = DETAIL.ASS_GSMW_EXT.PORT_NUMBER
                     		}
			}
              }
            }

            #--------------------------------------------------
            # Service Code Mapping
            #--------------------------------------------------
            ServiceCodeMap 
            { 
              ModuleName = FCT_ServiceCodeMap
              Module 
              { 
                Active             = TRUE
                DataConnection     = ifw.DataPool.Login
                MapGroup           = ALL_RATE
              } 
            } 

        EdrDump_ServiceCodeMapDump
          {
            ModuleName = FCT_EdrDump
            Module
            {
              Active   = FALSE
              FileName = /cdrapp_postpaid/dump/ServiceCodeMap.dump
            }
          }

            #--------------------------------------------------
            # Usage Class Mapping
            #--------------------------------------------------
            UsageClassMap
            {
              ModuleName = FCT_UsageClassMap 
              Module 
              { 
                Active              = TRUE
                DataConnection      = ifw.DataPool.Login
                OverwriteUsageClass = False 
                MapGroup            = ALL_RATE
                #OptimizeFor        = Memory
              } 
            }

        EdrDump_UsageClassMapDump
          {
            ModuleName = FCT_EdrDump
            Module
            {
              Active   = FALSE
              FileName = /cdrapp_postpaid/dump/UsageClassMap.dump
            }
          }


            #--------------------------------------------------
            # Discarding (of events)
            #--------------------------------------------------
            EventDiscarding
            {
              ModuleName = FCT_Discard
              Module
              {
                Active = TRUE
                DataConnection = ifw.DataPool.Login
                Function       = Discard
                StreamName     = DevNull
              }
            }

                      
            #--------------------------------------------------
            # Call Assembling 
            #--------------------------------------------------
            CallAssembling 
            { 
              ModuleName = FCT_CallAssembling 
              Module 
              { 
                Active = False 

                Path = . 
                FileName = calls 

                RejectMissingChain = False
              } 
            } 

            #--------------------------------------------------
            # Prefix Description
            #--------------------------------------------------
            PrefixDesc
            {
              ModuleName = FCT_PrefixDesc
              Module
              {
                Active = False
                PrefixDataModule = ifw.DataPool.PrefixDescDataModule
              }
            }
 

            #--------------------------------------------------
            # Infranet Customer
            #--------------------------------------------------
            CustomerSearch 
            { 
              ModuleName = FCT_Account
              Module 
              { 
                Active         = TRUE
                DataModule     = ifw.DataPool.CustomerData
                #DisableRatingProductCheck  = False
              }
            } 

        EdrDump_CustomerDataDump
          {
            ModuleName = FCT_EdrDump
            Module
            {
              Active   = FALSE
              FileName = /cdrapp_postpaid/dump/CustomerData.dump
            }
          }



	#---------------------------------------------------------
            # UpdateGLID - updates GLID field
            #---------------------------------------------------------
            ItemAssign
            {
              ModuleName = FCT_IScript
              Module
              {
                Active = True
                Source = File
                Scripts
                {
                  ItemAssign
                  {
                        FileName = ./TD/iScript_custom/ISC_TD_ItemTag.isc
                  }
                }
              }
            }
            #--------------------------------------------------
            # Profile analysis
            #--------------------------------------------------
            ProfileAnalyzer
            {
              ModuleName = FCT_IScript
              Module
              {
                Active = False
                Source = FILE
                Scripts
                {
                  ProfileAnalyzer
                  {
                    ProfileName = FRIENDS_FAMILY
                    LabelSeparator = ,
                    FileName = ./iScriptLib/iScriptLib_Standard/ISC_ProfileAnalyzer.isc
                  }
                }
              }
            }

            #--------------------------------------------------
            # Usage Type Mapping
            #--------------------------------------------------
            UsageType
            {
               ModuleName = FCT_IRules
               Module
               {
                 #Active = TRUE
                 Active = FALSE
                 Source = File
                 Descriptions
                 {
                   UsageTypeDetermination= ./iScriptLib/iScriptLib_Standard/IRL_UsageType.irl
                 }
               }
            }

            #--------------------------------------------------
            # FCT_Filter_Set registry entry fields.
            #--------------------------------------------------
            # Filter_Set FCT
            #---------------------------
            Filter_Set
            {
              ModuleName                = FCT_Filter_Set
              Module
              {
                Active                   = False
                DiscountDataModule       = ifw.DataPool.DiscountModelDataModule
                AccountDataModule        = ifw.DataPool.CustomerData
                InfranetConnection       = ifw.DataPool.LoginInfranet
              }
            }

            #--------------------------------------------------
            # Get the Least Cost As Per Market Segment and the
            # the product priority for each edr.
            #--------------------------------------------------
            LeastCostPerEDR
            {
               ModuleName = FCT_IRules
               Module
               {
                 Active = False
                 Source = File
                 Descriptions
                 {
                   LeastCostCheck= ./iScriptLib/iScriptLib_Standard/IRL_LeastCostPerEDR.irl
                 }
               }
            }

            #--------------------------------------------------
            # Get the Promotion Saving as per the product attributes
            #--------------------------------------------------
            PromotionalSavingPerEDR
            {
               ModuleName = FCT_IRules
               Module
               {
                 Active = False
                 Source = File
                 Descriptions
                 {
                   PromotionalSaving = ./iScriptLib/iScriptLib_Standard/IRL_PromotionalSavingPerEDR.irl
                 }
               }
            }

        EdrDump_CustomerRatingDump
          {
            ModuleName = FCT_EdrDump
            Module
            {
              Active   = FALSE
              FileName = /cdrapp_postpaid/dump/CustomerRating.dump
            }
          }

            #--------------------------------------------------
            # Customer Individual Rating
            #--------------------------------------------------
            CustomerRating
            { 
              ModuleName = FCT_CustomerRating 
              Module 
              { 
                Active            = TRUE
                Mode              = CUSTOMER 
                DataConnection    = ifw.DataPool.Login 
                DefaultRateplan   = Standard
                LeastCostRating   = False
                PromotionalSaving = False
              } 
            }

 
            #--------------------------------------------------
            # Pre-Rating (Zoning)
            #--------------------------------------------------
            PreRatingZone
            {
              ModuleName = FCT_PreRating
              Module
              {
                Active = True
                RateplanDataModule = ifw.DataPool.RateplanDataModule
                ZoneDataModule = ifw.DataPool.ZoneDataModule
              }
            }

            #--------------------------------------------------
            # Access Point Name Mapping (after zoning)
            #--------------------------------------------------              
            APNMap
            {
              ModuleName = FCT_APN_Map 
              Module 
              { 
                #Active         = True
                Active         = False
                DataConnection = ifw.DataPool.Login
                APNGroup {} 
              }
            } 

            #--------------------------------------------------
            # Usage Scenario Mapping
            #--------------------------------------------------
            UsageScenarioMap
            {
              ModuleName = FCT_USC_Map
              Module
              {
                #Active = TRUE
                Active = FALSE
                DataModule = ifw.DataPool.USCDataModule
                DefaultUSCGroup = ALL_RATE
              }
            }


            #--------------------------------------------------
            # Rate Service Class Mapping
            #--------------------------------------------------              
            RateServiceClassMap 
            { 
              ModuleName = FCT_RSC_Map 
              Module 
              {
                Active          = FALSE 
                DataConnection  = ifw.DataPool.Login
                DefaultRscGroup = ALL_RATE
              } 
            }

##----------------------------------------------------------------------
##         Deprecated because of the introduction of EDR Trace
##----------------------------------------------------------------------
          EdrDump_MainRating_pre
          {
            ModuleName = FCT_EdrDump
            Module
            {
              Active   = FALSE
              FileName = /cdrapp_postpaid/dump/MainRating_pre.dump
            }
          }          
##----------------------------------------------------------------------

            # Main Rating (Pricing)
            #--------------------------------------------------
            MainRating
            {
              ModuleName = FCT_MainRating
              Module
              {
                Active                  = TRUE
                RateplanDataModule      = ifw.DataPool.RateplanDataModule
                CalendarDataModule      = ifw.DataPool.CalendarDataModule
                TimeDataModule          = ifw.DataPool.TimeDataModule
                PriceDataModule         = ifw.DataPool.PriceDataModule
                CurrencyDataModule      = ifw.DataPool.CurrencyDataModule
                ModelSelectorDataModule = ifw.DataPool.ModelSelectorDataModule
              }
            }
 	
##----------------------------------------------------------------------
##         Deprecated because of the introduction of EDR Trace
##----------------------------------------------------------------------
          EdrDump_MainRating_post
          {
            ModuleName = FCT_EdrDump
            Module
            {
              Active   = FALSE
              FileName = /cdrapp_postpaid/dump/MainRating_post.dump
            }
          }   
##----------------------------------------------------------------------

            #--------------------------------------------------
            # Special Dayrates
            #--------------------------------------------------
            SpecialDayRate
            {
              ModuleName = FCT_Dayrate
              Module
              {
                Active = FALSE
                DayrateDataModule = ifw.DataPool.DayRateDataModule
              }
            }

            #--------------------------------------------------
            # Rate Adjustment
            #--------------------------------------------------
            RateAdjustment
            {
              ModuleName = FCT_RateAdjust
              Module
              {
                #Active         = TRUE
                Active         = FALSE
                Source         = Database
                DataConnection = ifw.DataPool.Login
              }
            }

            #--------------------------------------------------
            # Discount Analysis
            #--------------------------------------------------
            DiscountAnalysisModule
            {
              ModuleName = FCT_DiscountAnalysis
              Module
              {
                Active                   = TRUE
                #Active                   = FALSE
                DiscountModelDataModule  = ifw.DataPool.DiscountModelDataModule
                #Filter_SetModule         = ifw.Pipelines.TD_POSTPAID_RATE.Functions.Processing.FunctionPool.Filter_Set 
                ModelSelectorDataModule  = ifw.DataPool.ModelSelectorDataModule

              } 
            }

        EdrDump_ApolloDiscountModuleDump
          {
            ModuleName = FCT_EdrDump
            Module
            {
              Active   = FALSE
              FileName = /cdrapp_postpaid/dump/ApolloDiscountModule.dump
            }
          }


            #--------------------------------------------------
            # Discounting
            #--------------------------------------------------
            ApolloDiscountModule
            {
              ModuleName = FCT_Discount
              Module
              {
                Active                   = TRUE
                #Active                   = FALSE
                DiscountDataModule       = ifw.DataPool.DiscountModelDataModule
                BalanceDataModule        = ifw.DataPool.BalanceDataModule
                AccountDataModule        = ifw.DataPool.CustomerData
                CurrencyDataModule       = ifw.DataPool.CurrencyDataModule
                DiscountMoreThanPossible = False 
                BackOut                  = False 
                SupportBundleERA         = False
                IgnoreEDROnDeadlock      = False
		IgnoreEDROnDiscountError = False
		IgnoreEDROnLock          = False
              } 
            }
	    

            #--------------------------------------------------
            # Rounding (Discounting)
            #--------------------------------------------------
            Round_Discounting
            {
              ModuleName = FCT_Rounding
              Module
              {
                #Active             = TRUE
                Active             = FALSE
                CurrencyDataModule = ifw.DataPool.CurrencyDataModule
                Mode               = Discounting
              }
            }

            #--------------------------------------------------
            # ApplyBalance
            #--------------------------------------------------
            ApolloApplyBalanceModule
            {
              ModuleName = FCT_ApplyBalance
              Module
              {
                Active                       = TRUE
                DiscountDataModule           = ifw.DataPool.DiscountModelDataModule
                BalanceDataModule            = ifw.DataPool.BalanceDataModule
                DiscountFunctionalModule     = Functions.Processing.FunctionPool.ApolloDiscountModule
                PortalConfigDataModule       = ifw.DataPool.PortalConfigDataModule
                #NumberOfNotificationLimit   = 1000
                NotificationOutputDirectory = /cdrapp_postpaid/out/notifybalancebreach
                NotificationOutputPrefix    = balancebreach_
              }
            }


            #--------------------------------------------------
            # ItemAssign PlugIn
            #--------------------------------------------------
            FlexibleItemAssignment
            {
              ModuleName = FCT_ItemAssign
              Module
              {
                 Active     = TRUE
                 DataModule     = ifw.DataPool.ItemAssignDataModule
              }
            }

            #----------------------------------------------------------------
            # Add Infranet Billing Record (plugin version)
            #----------------------------------------------------------------
            AddInfranetBillingRecord
            {
              ModuleName = FCT_BillingRecord
              Module
              {
                Active = TRUE
                CurrencyType = R
                CurrencyDataModule = ifw.DataPool.CurrencyDataModule
                ItemAssignDataModule     = ifw.DataPool.ItemAssignDataModule
                AccountDataModule  = ifw.DataPool.CustomerData
                BalanceDataModule        = ifw.DataPool.BalanceDataModule
                PortalConfigDataModule   = ifw.DataPool.PortalConfigDataModule
              }
            }




	EdrDump_PreServiceOutput
          {
            ModuleName = FCT_EdrDump
            Module
            {
              Active   = FALSE
              FileName = /cdrapp_postpaid/dump/PreServiceOutput.dump
            }
          }

            #--------------------------------------------------
            # Split Output per ServiceCode
            #--------------------------------------------------              
            ServiceOutputPostpaidSplit
            {
              ModuleName = FCT_IRules
              Module
              {
                Active = TRUE
                Source = File
                Rules
                {
                }
                Descriptions
                {
                  ServiceCodeSplitPost = ./TD/iScript_custom/IRL_EventTypeSplittingPostpaid.irl
                }
              }
            }

            #--------------------------------------------------
            # Split Output per ObjectCacheType
            #--------------------------------------------------
            ObjectCacheTypeOutputSplit
            {
              ModuleName = FCT_IScript
              Module
              {
                #Active = TRUE
                Active = FALSE
                Source = File
                Scripts
                {
                  ObjectCacheTypeOutputSplit
                  {
                    FileName = ./iScriptLib/iScriptLib_Standard/ISC_ObjectCacheTypeOutputSplitter.isc
                  }
                }
              }
            }

            #--------------------------------------------------
            # Aggregation
            #--------------------------------------------------
            Aggregate
            {
              ModuleName = FCT_AggreGate
              Module
              {
               Active = False

                 ScenarioReaderDataModule = ifw.DataPool.ScenarioReader

                 Scenarios
                 {
                 }

                 ResultFile
                 {
                   TempSuffix = .tmp
                   DoneSuffix = .dat
                   WriteEmptyFile = FALSE
                 }

                 ControlFile
                 {
                   Suffix = .ctl
                   DataFilePath = TRUE
                 }
              }
            }  

            #--------------------------------------------------
            # Rejection
            #--------------------------------------------------
            Rejection
            {
              ModuleName = FCT_Reject
              Module
              {
                Active          = True 
                NotifyOnReject  = True 
                UseRejectStream = True 
                StreamMap 
                {
                  INF_IGNORE_ON_DISCOUNTACCOUNT_DEADLOCK = DiscountDeadlockOutput
                  INF_IGNORE_ON_DISCOUNT_ERROR           = DiscountErrorOutput
		  INF_IGNORE_ON_BALANCEGROUP_LOCK        = DiscountErrorOutput 
                }
		
		# This is required if FCT_CallAssembing module is being used.
		#CallAssemblingModule = ifw.Pipelines.TD_POSTPAID_RATE.Functions.Processing.FunctionPool.CallAssembling
              }
            }

            #---------------------------
            # Suspense FCT
            #---------------------------
            Suspense
            {
              ModuleName  = FCT_Suspense
              Module
              {
                Active = True
                SuspenseCreateStream     = SuspenseCreateOutput
                SuspenseUpdateStream     = SuspenseUpdateOutput
                DataConnection           = ifw.DataPool.LoginInfranet
                LogTestResults           = False
                PipelineCategory         = RatingPipeline
                RecycleLog
                {
                } 
              }
            }

##----------------------------------------------------------------------
##         Deprecated because of the introduction of EDR Trace
##----------------------------------------------------------------------
##          EdrDump_Suspense_post
##          {
##            ModuleName = FCT_EdrDump
##            Module
##            {
##              Active   = False
##              FileName = /cdrapp_postpaid/dump/Suspense_post.dump
##            }
##          }
##----------------------------------------------------------------------
        EdrDump_ALLRATELastDump
          {
            ModuleName = FCT_EdrDump
            Module
            {
              Active   = FALSE
              FileName = /cdrapp_postpaid/dump/ALLRATELastDump.dump
            }
          }

          } #END FunctionPool
        }
      } # END Functions

      #--------------------------------------------------
      # Output Section
      #--------------------------------------------------
      Output
      {
        WriteDefaultEdr            = False

        MaxErrorRates
        {
          INF_EDR_REJECTED = 100
          ERR_CUST_NOT_FOUND = 20
        }

        #-------------------------------------------
        # Multithreaded writing. This is recommended
        # when EDRs are associated with multiple
        # output streams.
        #------------------------------------------
        MultiThreading
        {
           Active = False      # Defaults to False
           NumberOfThreads = 1 # Number of threads spawned. Defaults to 1
           #Active = True      
           #NumberOfThreads = 7 
           BatchSize = 0       # The number of EDRs cached before sent for writing. Defaults to 0
        }


        OutputCollection
        {
          #--------------------------------------------------------------------
          # The DevNull stream
          #--------------------------------------------------------------------
          DevNull
          {
            ModuleName = OUT_DevNull
            Module
            { 
            } 
          } # end of DevNull

          
          #--------------------------------------------------------------------
          # Output stream for no balance events
          #--------------------------------------------------------------------
          DiscountErrorOutput
          {
            ModuleName = OUT_Reject
            Module
            {
              DeleteEmptyStream = TRUE # defaults to TRUE
	
              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_postpaid/discountError
                  OutputPrefix = test
                  OutputSuffix = .dsc
                  TempPrefix   = tmp
                  TempDataPath    = /cdrapp_postpaid/discountError
                  TempDataPrefix  = dsc.tmp.
                  TempDataSuffix  = .data
                  Replace = TRUE
                }
              }
            }
          }

          #--------------------------------------------------------------------
	  # Output stream for dead-locked events.
	  #--------------------------------------------------------------------
	  DiscountDeadlockOutput
	  {
	    ModuleName = OUT_Reject
	    Module
	    {
	      DeleteEmptyStream = TRUE # defaults to TRUE
	      OutputStream
	      {
	        ModuleName = EXT_OutFileManager
	        Module
	        {
		  OutputPath = /cdrapp_postpaid/discountError
		  OutputPrefix = test
		  OutputSuffix = .dlk
		  TempPrefix   = tmp
		  TempDataPath    = /cdrapp_postpaid/discountError
		  TempDataPrefix  = dlk.tmp.
		  TempDataSuffix  = .data
		  Replace = TRUE
		}
	      }
	    }
	  }  # end of DiscountDeadlockOutput
 
          #--------------------------------------------------------------------
          # The /service/gsm/telephony output stream
          #--------------------------------------------------------------------
          TELOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/voice

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
               
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_postpaid/out/telephony
                  OutputPrefix = test_TEL
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_postpaid/out/telephony
                  TempDataPrefix  = tel.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of TELOutput

           # end of CONV_TELOutput

          SMSOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/sms

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_postpaid/out/sms
                  OutputPrefix = test_SMS
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_postpaid/out/sms
                  TempDataPrefix  = sms.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of SMSOutput

           # end of CONV_SMSOutput

		 #--------------------------------------------------------------------
          # The /service/telco/gsm/mms output stream
          #--------------------------------------------------------------------
          MMSOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/mms

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_postpaid/out/mms
                  OutputPrefix = test_MMS
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_postpaid/out/mms
                  TempDataPrefix  = mms.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of MMSOutput

           # end of CONV_MMSOutput
			#--------------------------------------------------------------------
          # The /service/telco/gsm/voicemail output stream
          #--------------------------------------------------------------------
          VOMOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/voicemail

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_postpaid/out/voicemail
                  OutputPrefix = test_VOM
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_postpaid/out/voicemail
                  TempDataPrefix  = vom.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of VOMOutput

           # end of CONV_VOMOutput
		  
		  		#--------------------------------------------------------------------
          # The /service/telco/gsm/data output stream
          #--------------------------------------------------------------------
          DATOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/data

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_postpaid/out/data
                  OutputPrefix = test_DAT
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_postpaid/out/data
                  TempDataPrefix  = dat.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of DATOutput

           # end of CONV_DATOutput
		  
		  #--------------------------------------------------------------------
          # The /service/telco/gsm/vas output stream
          #--------------------------------------------------------------------
          VASOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/vas

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_postpaid/out/vas
                  OutputPrefix = test_VAS
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_postpaid/out/vas
                  TempDataPrefix  = vas.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of VASOutput

           # end of CONV_VASOutput
		  
		 #--------------------------------------------------------------------
          # The /service/telco/gsm/valuepack output stream
          #--------------------------------------------------------------------
          VAPOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/valuepack

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_postpaid/out/vap
                  OutputPrefix = test_VAP
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_postpaid/out/vap
                  TempDataPrefix  = vap.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of VAPOutput

           # end of CONV_VAPOutput
		  
          #--------------------------------------------------------------------
          # The /service/wap output stream
          #--------------------------------------------------------------------

          #--------------------------------------------------------------------
          # SuspenseCreateOutput stream
          #--------------------------------------------------------------------
          SuspenseCreateOutput
          {
            ModuleName = OUT_GenericStream
            EventType = /suspended_usage/telco/gsm
            Module
            {
              Grammar = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageCreationGrammar.dsc
              DeleteEmptyStream = True
              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_postpaid/reject
                  OutputPrefix = suspense_create_
                  OutputSuffix = .out
                  TempPrefix = tmp
                  TempDataPath = /cdrapp_postpaid/reject
                  TempDataPrefix = susp.create.tmp.
                  TempDataSuffix = .data
                  Replace = True
                  AppendSequenceNumber = False
                }
              }
            }
          } # end of SuspenseCreateOutput

          #--------------------------------------------------------------------
          # SuspenseUpdateOutput stream
          #--------------------------------------------------------------------
          SuspenseUpdateOutput
          {
            ModuleName = OUT_GenericStream
            EventType = /tmp_suspended_usage

            Module
            {
              Grammar = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageUpdateGrammar.dsc
              DeleteEmptyStream = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_postpaid/reject
                  OutputPrefix = suspense_update_
                  OutputSuffix = .out
                  TempPrefix = tmp
                  TempDataPath = /cdrapp_postpaid/reject
                  TempDataPrefix = susp.update.tmp.
                  TempDataSuffix = .data
                  Replace = True
                  AppendSequenceNumber = False
                }
              }
            }
          } # end of SuspenseUpdateOutput
        } # end of OutputCollection

        OutputLog
        {
          FilePath        = /var/portal/ifw/log/stream
          FileName        = stream
          FilePrefix      = Stream_
          FileSuffix      = .log
		
	  # Added by GSM
           #LogLevel = warning
           LogLevel = major

          SuppressErrors
          {
            ERR_SPEC_VERSION_INVALID
            ERR_RELEASE_VERSION_INVALID
         WRN_NO_GLID 
	 }
        }
        
        #SequenceGeneration = Unit
        SequenceGeneration = Transaction

	#-------------------------------
        EdrTraceEnabled = FALSE
        EdrTrace
        {
            TraceLog
            {
                 FilePath   = /var/portal/ifw/log/edrLog
                 FileName   = edrTraceLog
                 FilePrefix = log_
                 FileSuffix = .log
            }

            TraceStartPoint =  Input
            TraceEndPoint   = Output

        } # END EdrTrace

        
      } # end of Output    
      
    } # END TD_POSTPAID_RATE

    #==========================================================
    # Added by GSM
    #==========================================================
    TD_POSTPAID_RATE_TEL
    {
      Active                      = TRUE
      
      CountryCode                 = 64 
      MobileCountryCode           = 64
      NationalAccessCode          = 0
      #InternationalAccessCode     = 00
      #InternationalAccessCodeSign = +
      NetworkDestinationCode      = 172
      RejectStream                = SuspenseCreateOutput
      
      TransactionManager
      {
        RedoEnabled = True #False
        SingleTransaction = False
        WriteToLogEnabled = True
        BinaryLogFileName = ./tam/binaryLogFileTD_POSTPAID_RATE_TEL.dat
      }
      
      EdrFactory 
      { 
        DataConnection = ifw.DataPool.Login 
        Description =  ./TD/formatDesc/Portal/td_containerDesc.dsc
        UsageStatistic = /var/portal/ifw/log/statistic/edrStatisticTD_POSTPAID_RATE_TEL.txt 
        EdrVersionDataConnection = ifw.DataPool.LoginInfranet
      }

      DataDescription
      {
        Standard
        {
          ModuleName = Standard
          Module
          {
            StreamFormats
            {
	      SOL42_FORINPUT = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_RATE_FORINPUT.dsc
              EVENT_LOADER = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_Format.dsc
              SUSPENSE_CREATE_OUTPUT = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageCreation.dsc
              SUSPENSE_UPDATE_OUTPUT = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageUpdate.dsc
            }

            InputMapping
            {
              SOL42_FORINPUT = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_RATE_InMap.dsc
            }

            OutputMapping
            {
              EVENT_LOADER = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutMap.dsc
              SUSPENSE_CREATE_OUTPUT = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageCreationMapping.dsc
              SUSPENSE_UPDATE_OUTPUT = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageUpdateMapping.dsc
            }
          }
        }
      } # end of DataDescription

      PipelineLog 
      { 
        ModuleName = LOG
        Module 
        { 
          ITO 
          { 
            WriteMessageKey  = True
            FilePath = /var/portal/ifw/log/pipeline
            FileName = pipeline_TD_POSTPAID_RATE_TEL.log
            ProcessName = ifw
            MessageGroup = IFW
            ShowOriginator = TRUE
	    # Added by GSM
            #LogLevel = warning
            LogLevel = major
          }

          Buffer 
          { 
            #Size = 500
            #Updated by GSM
	    Size = 1000
          } 
        } 
      } # end of PipelineLog


      InputBuffer
      {
        BlockTransfer = False
        #Size = 1
        #BlockSize = 1
	#Updated by GSM
        Size = 100
        BlockSize = 100
      }

      OutputBuffer
      {
        BlockTransfer = False
        #Size = 1
        #BlockSize = 1
        #Updated by GSM
	Size = 100
        BlockSize = 100
      }
      
      #------------------------------------------------------------------------
      # Input section
      #------------------------------------------------------------------------
      Input
      {
        #UnitsPerTransaction = 1
        UnitsPerTransaction = 2

        InputModule
        {
          ModuleName  = INP_GenericStream
          Module
          {
            Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_RATE_InGrammar.dsc
            DefaultOutput = TELOutput

            InputStream
            {
              ModuleName = EXT_InFileManager
              Module
              {
                InputDirEmptyTimeout = 10

                InputPath   = /cdrapp_postpaid/edr/telephony
                InputPrefix = TD_RATE_POST
                InputSuffix = .edr
 
                DonePath    = /cdrapp_postpaid/done
                DonePrefix  = test_ALLRATE
                DoneSuffix  = .done
           
                ErrorPath   = /cdrapp_postpaid/error
                ErrorPrefix = test_ALLRATE
                ErrorSuffix = .err

                TempPrefix  = tmp_ALLRATE
  
                Replace     = TRUE
              }
            } # end of InputStream
          }
        } # end of InputModule
      } # end of Input

      
      #------------------------------------------------------------------------
      # Function section
      #------------------------------------------------------------------------
      Functions 
      {
        Processing
        {
          FunctionPool
          {

            #---------------------------------------------------
            # PreSuspense FCT
            #---------------------------------------------------
            PreSuspense
            {
              ModuleName = FCT_PreSuspense
              Module
              {
                Active = True
			QueryableFields
			{

				SUSP_USAGE_TELCO_INFO_T
				{
					# format : <database_column_name> = <edr_conatiner_field_name>
					START_TIME = DETAIL.CHARGING_START_TIMESTAMP
					CALL_DURATION = DETAIL.DURATION
					CALLING_FROM = DETAIL.A_NUMBER
					CALLED_TO = DETAIL.B_NUMBER
                                        SERVICE_TYPE = DETAIL.BASIC_SERVICE
                                        USAGE_TYPE = DETAIL.USAGE_TYPE
				}
                     		SUSP_USAGE_TELCO_GSM_INFO_T
                     		{
                        		CELL_ID = DETAIL.ASS_GSMW_EXT.CELL_ID
                         		DESTINATION_SID = DETAIL.ASS_GSMW_EXT.TERMINATING_SWITCH_IDENTIFICATION
                        		DIALED_NUMBER = DETAIL.ASS_GSMW_EXT.DIALED_DIGITS
                        		ORIGIN_SID = DETAIL.ASS_GSMW_EXT.ORIGINATING_SWITCH_IDENTIFICATION 
                                     	SECONDARY_MSID = DETAIL.ASS_GSMW_EXT.PORT_NUMBER
                     		}
			}
              }
            }

            #--------------------------------------------------
            # Service Code Mapping
            #--------------------------------------------------
            ServiceCodeMap 
            { 
              ModuleName = FCT_ServiceCodeMap
              Module 
              { 
                Active             = TRUE
                DataConnection     = ifw.DataPool.Login
                MapGroup           = ALL_RATE
              } 
            } 

            #--------------------------------------------------
            # Usage Class Mapping
            #--------------------------------------------------
            UsageClassMap
            {
              ModuleName = FCT_UsageClassMap 
              Module 
              { 
                Active              = TRUE
                DataConnection      = ifw.DataPool.Login
                OverwriteUsageClass = False 
                MapGroup            = ALL_RATE
                #OptimizeFor        = Memory
              } 
            }


            #--------------------------------------------------
            # Discarding (of events)
            #--------------------------------------------------
            EventDiscarding
            {
              ModuleName = FCT_Discard
              Module
              {
                Active = TRUE
                DataConnection = ifw.DataPool.Login
                Function       = Discard
                StreamName     = DevNull
              }
            }


            #--------------------------------------------------
            # Infranet Customer
            #--------------------------------------------------
            CustomerSearch 
            { 
              ModuleName = FCT_Account
              Module 
              { 
                Active         = TRUE
                DataModule     = ifw.DataPool.CustomerData
                #DisableRatingProductCheck  = False
              }
            } 

	#---------------------------------------------------------
            # UpdateGLID - updates GLID field
            #---------------------------------------------------------
            ItemAssign
            {
              ModuleName = FCT_IScript
              Module
              {
                Active = True
                Source = File
                Scripts
                {
                  ItemAssign
                  {
                        FileName = ./TD/iScript_custom/ISC_TD_ItemTag.isc
                  }
                }
              }
            }

            #--------------------------------------------------
            # Customer Individual Rating
            #--------------------------------------------------
            CustomerRating
            { 
              ModuleName = FCT_CustomerRating 
              Module 
              { 
                Active            = TRUE
                Mode              = CUSTOMER 
                DataConnection    = ifw.DataPool.Login 
                DefaultRateplan   = Standard
                LeastCostRating   = False
                PromotionalSaving = False
              } 
            }

 
            #--------------------------------------------------
            # Pre-Rating (Zoning)
            #--------------------------------------------------
            PreRatingZone
            {
              ModuleName = FCT_PreRating
              Module
              {
                Active = True
                RateplanDataModule = ifw.DataPool.RateplanDataModule
                ZoneDataModule = ifw.DataPool.ZoneDataModule
              }
            }

	##----------------------------------------------------------------------

            # Main Rating (Pricing)
            #--------------------------------------------------
            MainRating
            {
              ModuleName = FCT_MainRating
              Module
              {
                Active                  = TRUE
                RateplanDataModule      = ifw.DataPool.RateplanDataModule
                CalendarDataModule      = ifw.DataPool.CalendarDataModule
                TimeDataModule          = ifw.DataPool.TimeDataModule
                PriceDataModule         = ifw.DataPool.PriceDataModule
                CurrencyDataModule      = ifw.DataPool.CurrencyDataModule
                ModelSelectorDataModule = ifw.DataPool.ModelSelectorDataModule
              }
            }
 	
            #--------------------------------------------------
            # Discount Analysis
            #--------------------------------------------------
            DiscountAnalysisModule
            {
              ModuleName = FCT_DiscountAnalysis
              Module
              {
                Active                   = TRUE
                #Active                   = FALSE
                DiscountModelDataModule  = ifw.DataPool.DiscountModelDataModule
                #Filter_SetModule         = ifw.Pipelines.TD_POSTPAID_RATE_TEL.Functions.Processing.FunctionPool.Filter_Set 
                ModelSelectorDataModule  = ifw.DataPool.ModelSelectorDataModule

              } 
            }


            #--------------------------------------------------
            # Discounting
            #--------------------------------------------------
            ApolloDiscountModule
            {
              ModuleName = FCT_Discount
              Module
              {
                Active                   = TRUE
                #Active                   = FALSE
                DiscountDataModule       = ifw.DataPool.DiscountModelDataModule
                BalanceDataModule        = ifw.DataPool.BalanceDataModule
                AccountDataModule        = ifw.DataPool.CustomerData
                CurrencyDataModule       = ifw.DataPool.CurrencyDataModule
                DiscountMoreThanPossible = False 
                BackOut                  = False 
                SupportBundleERA         = False
                IgnoreEDROnDeadlock      = False
		IgnoreEDROnDiscountError = False
		IgnoreEDROnLock          = False
              } 
            }
	    

            #--------------------------------------------------
            # ApplyBalance
            #--------------------------------------------------
            ApolloApplyBalanceModule
            {
              ModuleName = FCT_ApplyBalance
              Module
              {
                Active                       = TRUE
                DiscountDataModule           = ifw.DataPool.DiscountModelDataModule
                BalanceDataModule            = ifw.DataPool.BalanceDataModule
                DiscountFunctionalModule     = Functions.Processing.FunctionPool.ApolloDiscountModule
                PortalConfigDataModule       = ifw.DataPool.PortalConfigDataModule
                #NumberOfNotificationLimit   = 1000
                NotificationOutputDirectory = /cdrapp_postpaid/out/notifybalancebreach
                NotificationOutputPrefix    = balancebreach_
              }
            }


            #--------------------------------------------------
            # ItemAssign PlugIn
            #--------------------------------------------------
            FlexibleItemAssignment
            {
              ModuleName = FCT_ItemAssign
              Module
              {
                 Active     = TRUE
                 DataModule     = ifw.DataPool.ItemAssignDataModule
              }
            }

            #----------------------------------------------------------------
            # Add Infranet Billing Record (plugin version)
            #----------------------------------------------------------------
            AddInfranetBillingRecord
            {
              ModuleName = FCT_BillingRecord
              Module
              {
                Active = TRUE
                CurrencyType = R
                CurrencyDataModule = ifw.DataPool.CurrencyDataModule
                ItemAssignDataModule     = ifw.DataPool.ItemAssignDataModule
                AccountDataModule  = ifw.DataPool.CustomerData
                BalanceDataModule        = ifw.DataPool.BalanceDataModule
                PortalConfigDataModule   = ifw.DataPool.PortalConfigDataModule
              }
            }

            #--------------------------------------------------
            # Split Output per ServiceCode
            #--------------------------------------------------              
            ServiceOutputPostpaidSplit
            {
              ModuleName = FCT_IRules
              Module
              {
                Active = TRUE
                Source = File
                Rules
                {
                }
                Descriptions
                {
                  ServiceCodeSplitPost = ./TD/iScript_custom/IRL_EventTypeSplittingPostpaid.irl
                }
              }
            }

            #--------------------------------------------------
            # Rejection
            #--------------------------------------------------
            Rejection
            {
              ModuleName = FCT_Reject
              Module
              {
                Active          = True 
                NotifyOnReject  = True 
                UseRejectStream = True 
                StreamMap 
                {
                  INF_IGNORE_ON_DISCOUNTACCOUNT_DEADLOCK = DiscountDeadlockOutput
                  INF_IGNORE_ON_DISCOUNT_ERROR           = DiscountErrorOutput
		  INF_IGNORE_ON_BALANCEGROUP_LOCK        = DiscountErrorOutput 
                }
		
		# This is required if FCT_CallAssembing module is being used.
		#CallAssemblingModule = ifw.Pipelines.TD_POSTPAID_RATE_TEL.Functions.Processing.FunctionPool.CallAssembling
              }
            }

            #---------------------------
            # Suspense FCT
            #---------------------------
            Suspense
            {
              ModuleName  = FCT_Suspense
              Module
              {
                Active = True
                SuspenseCreateStream     = SuspenseCreateOutput
                SuspenseUpdateStream     = SuspenseUpdateOutput
                DataConnection           = ifw.DataPool.LoginInfranet
                LogTestResults           = False
                PipelineCategory         = RatingPipeline
                RecycleLog
                {
                } 
              }
            }


          } #END FunctionPool
        }
      } # END Functions

      #--------------------------------------------------
      # Output Section
      #--------------------------------------------------
      Output
      {
        WriteDefaultEdr            = False

        MaxErrorRates
        {
          INF_EDR_REJECTED = 100
          ERR_CUST_NOT_FOUND = 20
        }

        #-------------------------------------------
        # Multithreaded writing. This is recommended
        # when EDRs are associated with multiple
        # output streams.
        #------------------------------------------
        MultiThreading
        {
           Active = False      # Defaults to False
           NumberOfThreads = 1 # Number of threads spawned. Defaults to 1
           #Active = True      
           #NumberOfThreads = 7 
           BatchSize = 0       # The number of EDRs cached before sent for writing. Defaults to 0
        }


        OutputCollection
        {
          #--------------------------------------------------------------------
          # The DevNull stream
          #--------------------------------------------------------------------
          DevNull
          {
            ModuleName = OUT_DevNull
            Module
            { 
            } 
          } # end of DevNull

          
          #--------------------------------------------------------------------
          # Output stream for no balance events
          #--------------------------------------------------------------------
          DiscountErrorOutput
          {
            ModuleName = OUT_Reject
            Module
            {
              DeleteEmptyStream = TRUE # defaults to TRUE
	
              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_postpaid/discountError
                  OutputPrefix = test
                  OutputSuffix = .dsc
                  TempPrefix   = tmp
                  TempDataPath    = /cdrapp_postpaid/discountError
                  TempDataPrefix  = dsc.tmp.
                  TempDataSuffix  = .data
                  Replace = TRUE
                }
              }
            }
          }

          #--------------------------------------------------------------------
	  # Output stream for dead-locked events.
	  #--------------------------------------------------------------------
	  DiscountDeadlockOutput
	  {
	    ModuleName = OUT_Reject
	    Module
	    {
	      DeleteEmptyStream = TRUE # defaults to TRUE
	      OutputStream
	      {
	        ModuleName = EXT_OutFileManager
	        Module
	        {
		  OutputPath = /cdrapp_postpaid/discountError
		  OutputPrefix = test
		  OutputSuffix = .dlk
		  TempPrefix   = tmp
		  TempDataPath    = /cdrapp_postpaid/discountError
		  TempDataPrefix  = dlk.tmp.
		  TempDataSuffix  = .data
		  Replace = TRUE
		}
	      }
	    }
	  }  # end of DiscountDeadlockOutput
 
          #--------------------------------------------------------------------
          # The /service/gsm/telephony output stream
          #--------------------------------------------------------------------
          TELOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/voice

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
               
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_postpaid/out/telephony
                  OutputPrefix = test_TEL
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_postpaid/out/telephony
                  TempDataPrefix  = tel.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of TELOutput

           # end of CONV_TELOutput

          SMSOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/sms

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_postpaid/out/sms
                  OutputPrefix = test_SMS
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_postpaid/out/sms
                  TempDataPrefix  = sms.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of SMSOutput

           # end of CONV_SMSOutput

		 #--------------------------------------------------------------------
          # The /service/telco/gsm/mms output stream
          #--------------------------------------------------------------------
          MMSOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/mms

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_postpaid/out/mms
                  OutputPrefix = test_MMS
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_postpaid/out/mms
                  TempDataPrefix  = mms.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of MMSOutput

           # end of CONV_MMSOutput
			#--------------------------------------------------------------------
          # The /service/telco/gsm/voicemail output stream
          #--------------------------------------------------------------------
          VOMOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/voicemail

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_postpaid/out/voicemail
                  OutputPrefix = test_VOM
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_postpaid/out/voicemail
                  TempDataPrefix  = vom.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of VOMOutput

           # end of CONV_VOMOutput
		  
		  		#--------------------------------------------------------------------
          # The /service/telco/gsm/data output stream
          #--------------------------------------------------------------------
          DATOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/data

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_postpaid/out/data
                  OutputPrefix = test_DAT
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_postpaid/out/data
                  TempDataPrefix  = dat.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of DATOutput

           # end of CONV_DATOutput
		  
		  #--------------------------------------------------------------------
          # The /service/telco/gsm/vas output stream
          #--------------------------------------------------------------------
          VASOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/vas

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_postpaid/out/vas
                  OutputPrefix = test_VAS
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_postpaid/out/vas
                  TempDataPrefix  = vas.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of VASOutput

           # end of CONV_VASOutput
		  
		 #--------------------------------------------------------------------
          # The /service/telco/gsm/valuepack output stream
          #--------------------------------------------------------------------
          VAPOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/valuepack

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_postpaid/out/vap
                  OutputPrefix = test_VAP
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_postpaid/out/vap
                  TempDataPrefix  = vap.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of VAPOutput

           # end of CONV_VAPOutput
		  
          #--------------------------------------------------------------------
          # The /service/wap output stream
          #--------------------------------------------------------------------

          #--------------------------------------------------------------------
          # SuspenseCreateOutput stream
          #--------------------------------------------------------------------
          SuspenseCreateOutput
          {
            ModuleName = OUT_GenericStream
            EventType = /suspended_usage/telco/gsm
            Module
            {
              Grammar = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageCreationGrammar.dsc
              DeleteEmptyStream = True
              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_postpaid/reject
                  OutputPrefix = suspense_create_
                  OutputSuffix = .out
                  TempPrefix = tmp
                  TempDataPath = /cdrapp_postpaid/reject
                  TempDataPrefix = susp.create.tmp.
                  TempDataSuffix = .data
                  Replace = True
                  AppendSequenceNumber = False
                }
              }
            }
          } # end of SuspenseCreateOutput

          #--------------------------------------------------------------------
          # SuspenseUpdateOutput stream
          #--------------------------------------------------------------------
          SuspenseUpdateOutput
          {
            ModuleName = OUT_GenericStream
            EventType = /tmp_suspended_usage

            Module
            {
              Grammar = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageUpdateGrammar.dsc
              DeleteEmptyStream = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_postpaid/reject
                  OutputPrefix = suspense_update_
                  OutputSuffix = .out
                  TempPrefix = tmp
                  TempDataPath = /cdrapp_postpaid/reject
                  TempDataPrefix = susp.update.tmp.
                  TempDataSuffix = .data
                  Replace = True
                  AppendSequenceNumber = False
                }
              }
            }
          } # end of SuspenseUpdateOutput
        } # end of OutputCollection

        OutputLog
        {
          FilePath        = /var/portal/ifw/log/stream
          FileName        = stream
          FilePrefix      = Stream_
          FileSuffix      = .log
		
	  # Added by GSM
           #LogLevel = warning
           LogLevel = major

          SuppressErrors
          {
            ERR_SPEC_VERSION_INVALID
            ERR_RELEASE_VERSION_INVALID
         WRN_NO_GLID 
	 }
        }
        
        #SequenceGeneration = Unit
        SequenceGeneration = Transaction

	#-------------------------------
        EdrTraceEnabled = FALSE
        EdrTrace
        {
            TraceLog
            {
                 FilePath   = /var/portal/ifw/log/edrLog
                 FileName   = edrTraceLog
                 FilePrefix = log_
                 FileSuffix = .log
            }

            TraceStartPoint =  Input
            TraceEndPoint   = Output

        } # END EdrTrace

        
      } # end of Output    
      
    }
   
    TD_POSTPAID_RATE_DATA
    {
      Active                      = TRUE
      
      CountryCode                 = 64 
      MobileCountryCode           = 64
      NationalAccessCode          = 0
      #InternationalAccessCode     = 00
      #InternationalAccessCodeSign = +
      NetworkDestinationCode      = 172
      RejectStream                = SuspenseCreateOutput
      
      TransactionManager
      {
        RedoEnabled = True #False
        SingleTransaction = False
        WriteToLogEnabled = True
        BinaryLogFileName = ./tam/binaryLogFileTD_POSTPAID_RATE_DAT.dat
      }
      
      EdrFactory 
      { 
        DataConnection = ifw.DataPool.Login 
        Description =  ./TD/formatDesc/Portal/td_containerDesc.dsc
        UsageStatistic = /var/portal/ifw/log/statistic/edrStatisticTD_POSTPAID_RATE_DATA.txt 
        EdrVersionDataConnection = ifw.DataPool.LoginInfranet
      }

      DataDescription
      {
        Standard
        {
          ModuleName = Standard
          Module
          {
            StreamFormats
            {
	      SOL42_FORINPUT = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_RATE_FORINPUT.dsc
              EVENT_LOADER = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_Format.dsc
              SUSPENSE_CREATE_OUTPUT = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageCreation.dsc
              SUSPENSE_UPDATE_OUTPUT = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageUpdate.dsc
            }

            InputMapping
            {
              SOL42_FORINPUT = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_RATE_InMap.dsc
            }

            OutputMapping
            {
              EVENT_LOADER = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutMap.dsc
              SUSPENSE_CREATE_OUTPUT = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageCreationMapping.dsc
              SUSPENSE_UPDATE_OUTPUT = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageUpdateMapping.dsc
            }
          }
        }
      } # end of DataDescription

      PipelineLog 
      { 
        ModuleName = LOG
        Module 
        { 
          ITO 
          { 
            WriteMessageKey  = True
            FilePath = /var/portal/ifw/log/pipeline
            FileName = pipeline_TD_POSTPAID_RATE_DATA.log
            ProcessName = ifw
            MessageGroup = IFW
            ShowOriginator = TRUE
	    # Added by GSM
            #LogLevel = warning
            LogLevel = major
          }

          Buffer 
          { 
            #Size = 500
            #Updated by GSM
	    Size = 1000
          } 
        } 
      } # end of PipelineLog


      InputBuffer
      {
        BlockTransfer = False
        #Size = 1
        #BlockSize = 1
	#Updated by GSM
        Size = 100
        BlockSize = 100
      }

      OutputBuffer
      {
        BlockTransfer = False
        #Size = 1
        #BlockSize = 1
        #Updated by GSM
	Size = 100
        BlockSize = 100
      }
      
      #------------------------------------------------------------------------
      # Input section
      #------------------------------------------------------------------------
      Input
      {
        #UnitsPerTransaction = 1
        UnitsPerTransaction = 2

        InputModule
        {
          ModuleName  = INP_GenericStream
          Module
          {
            Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_RATE_InGrammar.dsc
            DefaultOutput = DATOutput

            InputStream
            {
              ModuleName = EXT_InFileManager
              Module
              {
                InputDirEmptyTimeout = 10

                InputPath   = /cdrapp_postpaid/edr/data
                InputPrefix = TD_RATE_POST
                InputSuffix = .edr
 
                DonePath    = /cdrapp_postpaid/done
                DonePrefix  = test_ALLRATE
                DoneSuffix  = .done
           
                ErrorPath   = /cdrapp_postpaid/error
                ErrorPrefix = test_ALLRATE
                ErrorSuffix = .err

                TempPrefix  = tmp_ALLRATE
  
                Replace     = TRUE
              }
            } # end of InputStream
          }
        } # end of InputModule
      } # end of Input

      
      #------------------------------------------------------------------------
      # Function section
      #------------------------------------------------------------------------
      Functions 
      {
        Processing
        {
          FunctionPool
          {

            #---------------------------------------------------
            # PreSuspense FCT
            #---------------------------------------------------
            PreSuspense
            {
              ModuleName = FCT_PreSuspense
              Module
              {
                Active = True
			QueryableFields
			{

				SUSP_USAGE_TELCO_INFO_T
				{
					# format : <database_column_name> = <edr_conatiner_field_name>
					START_TIME = DETAIL.CHARGING_START_TIMESTAMP
					CALL_DURATION = DETAIL.DURATION
					CALLING_FROM = DETAIL.A_NUMBER
					CALLED_TO = DETAIL.B_NUMBER
                                        SERVICE_TYPE = DETAIL.BASIC_SERVICE
                                        USAGE_TYPE = DETAIL.USAGE_TYPE
				}
                     		SUSP_USAGE_TELCO_GSM_INFO_T
                     		{
                        		CELL_ID = DETAIL.ASS_GSMW_EXT.CELL_ID
                         		DESTINATION_SID = DETAIL.ASS_GSMW_EXT.TERMINATING_SWITCH_IDENTIFICATION
                        		DIALED_NUMBER = DETAIL.ASS_GSMW_EXT.DIALED_DIGITS
                        		ORIGIN_SID = DETAIL.ASS_GSMW_EXT.ORIGINATING_SWITCH_IDENTIFICATION 
                                     	SECONDARY_MSID = DETAIL.ASS_GSMW_EXT.PORT_NUMBER
                     		}
			}
              }
            }

            #--------------------------------------------------
            # Service Code Mapping
            #--------------------------------------------------
            ServiceCodeMap 
            { 
              ModuleName = FCT_ServiceCodeMap
              Module 
              { 
                Active             = TRUE
                DataConnection     = ifw.DataPool.Login
                MapGroup           = ALL_RATE
              } 
            } 

            #--------------------------------------------------
            # Usage Class Mapping
            #--------------------------------------------------
            UsageClassMap
            {
              ModuleName = FCT_UsageClassMap 
              Module 
              { 
                Active              = TRUE
                DataConnection      = ifw.DataPool.Login
                OverwriteUsageClass = False 
                MapGroup            = ALL_RATE
                #OptimizeFor        = Memory
              } 
            }


            #--------------------------------------------------
            # Discarding (of events)
            #--------------------------------------------------
            EventDiscarding
            {
              ModuleName = FCT_Discard
              Module
              {
                Active = TRUE
                DataConnection = ifw.DataPool.Login
                Function       = Discard
                StreamName     = DevNull
              }
            }


            #--------------------------------------------------
            # Infranet Customer
            #--------------------------------------------------
            CustomerSearch 
            { 
              ModuleName = FCT_Account
              Module 
              { 
                Active         = TRUE
                DataModule     = ifw.DataPool.CustomerData
                #DisableRatingProductCheck  = False
              }
            } 

	#---------------------------------------------------------
            # UpdateGLID - updates GLID field
            #---------------------------------------------------------
            ItemAssign
            {
              ModuleName = FCT_IScript
              Module
              {
                Active = True
                Source = File
                Scripts
                {
                  ItemAssign
                  {
                        FileName = ./TD/iScript_custom/ISC_TD_ItemTag.isc
                  }
                }
              }
            }

            #--------------------------------------------------
            # Customer Individual Rating
            #--------------------------------------------------
            CustomerRating
            { 
              ModuleName = FCT_CustomerRating 
              Module 
              { 
                Active            = TRUE
                Mode              = CUSTOMER 
                DataConnection    = ifw.DataPool.Login 
                DefaultRateplan   = Standard
                LeastCostRating   = False
                PromotionalSaving = False
              } 
            }

 
            #--------------------------------------------------
            # Pre-Rating (Zoning)
            #--------------------------------------------------
            PreRatingZone
            {
              ModuleName = FCT_PreRating
              Module
              {
                Active = True
                RateplanDataModule = ifw.DataPool.RateplanDataModule
                ZoneDataModule = ifw.DataPool.ZoneDataModule
              }
            }

	##----------------------------------------------------------------------

            # Main Rating (Pricing)
            #--------------------------------------------------
            MainRating
            {
              ModuleName = FCT_MainRating
              Module
              {
                Active                  = TRUE
                RateplanDataModule      = ifw.DataPool.RateplanDataModule
                CalendarDataModule      = ifw.DataPool.CalendarDataModule
                TimeDataModule          = ifw.DataPool.TimeDataModule
                PriceDataModule         = ifw.DataPool.PriceDataModule
                CurrencyDataModule      = ifw.DataPool.CurrencyDataModule
                ModelSelectorDataModule = ifw.DataPool.ModelSelectorDataModule
              }
            }
 	
            #--------------------------------------------------
            # Discount Analysis
            #--------------------------------------------------
            DiscountAnalysisModule
            {
              ModuleName = FCT_DiscountAnalysis
              Module
              {
                Active                   = TRUE
                #Active                   = FALSE
                DiscountModelDataModule  = ifw.DataPool.DiscountModelDataModule
                #Filter_SetModule         = ifw.Pipelines.TD_POSTPAID_RATE_DATA.Functions.Processing.FunctionPool.Filter_Set 
                ModelSelectorDataModule  = ifw.DataPool.ModelSelectorDataModule

              } 
            }


            #--------------------------------------------------
            # Discounting
            #--------------------------------------------------
            ApolloDiscountModule
            {
              ModuleName = FCT_Discount
              Module
              {
                Active                   = TRUE
                #Active                   = FALSE
                DiscountDataModule       = ifw.DataPool.DiscountModelDataModule
                BalanceDataModule        = ifw.DataPool.BalanceDataModule
                AccountDataModule        = ifw.DataPool.CustomerData
                CurrencyDataModule       = ifw.DataPool.CurrencyDataModule
                DiscountMoreThanPossible = False 
                BackOut                  = False 
                SupportBundleERA         = False
                IgnoreEDROnDeadlock      = False
		IgnoreEDROnDiscountError = False
		IgnoreEDROnLock          = False
              } 
            }
	    

            #--------------------------------------------------
            # ApplyBalance
            #--------------------------------------------------
            ApolloApplyBalanceModule
            {
              ModuleName = FCT_ApplyBalance
              Module
              {
                Active                       = TRUE
                DiscountDataModule           = ifw.DataPool.DiscountModelDataModule
                BalanceDataModule            = ifw.DataPool.BalanceDataModule
                DiscountFunctionalModule     = Functions.Processing.FunctionPool.ApolloDiscountModule
                PortalConfigDataModule       = ifw.DataPool.PortalConfigDataModule
                #NumberOfNotificationLimit   = 1000
                NotificationOutputDirectory = /cdrapp_postpaid/out/notifybalancebreach
                NotificationOutputPrefix    = balancebreach_
              }
            }


            #--------------------------------------------------
            # ItemAssign PlugIn
            #--------------------------------------------------
            FlexibleItemAssignment
            {
              ModuleName = FCT_ItemAssign
              Module
              {
                 Active     = TRUE
                 DataModule     = ifw.DataPool.ItemAssignDataModule
              }
            }

            #----------------------------------------------------------------
            # Add Infranet Billing Record (plugin version)
            #----------------------------------------------------------------
            AddInfranetBillingRecord
            {
              ModuleName = FCT_BillingRecord
              Module
              {
                Active = TRUE
                CurrencyType = R
                CurrencyDataModule = ifw.DataPool.CurrencyDataModule
                ItemAssignDataModule     = ifw.DataPool.ItemAssignDataModule
                AccountDataModule  = ifw.DataPool.CustomerData
                BalanceDataModule        = ifw.DataPool.BalanceDataModule
                PortalConfigDataModule   = ifw.DataPool.PortalConfigDataModule
              }
            }

            #--------------------------------------------------
            # Split Output per ServiceCode
            #--------------------------------------------------              
            ServiceOutputPostpaidSplit
            {
              ModuleName = FCT_IRules
              Module
              {
                Active = TRUE
                Source = File
                Rules
                {
                }
                Descriptions
                {
                  ServiceCodeSplitPost = ./TD/iScript_custom/IRL_EventTypeSplittingPostpaid.irl
                }
              }
            }

            #--------------------------------------------------
            # Rejection
            #--------------------------------------------------
            Rejection
            {
              ModuleName = FCT_Reject
              Module
              {
                Active          = True 
                NotifyOnReject  = True 
                UseRejectStream = True 
                StreamMap 
                {
                  INF_IGNORE_ON_DISCOUNTACCOUNT_DEADLOCK = DiscountDeadlockOutput
                  INF_IGNORE_ON_DISCOUNT_ERROR           = DiscountErrorOutput
		  INF_IGNORE_ON_BALANCEGROUP_LOCK        = DiscountErrorOutput 
                }
		
		# This is required if FCT_CallAssembing module is being used.
		#CallAssemblingModule = ifw.Pipelines.TD_POSTPAID_RATE_DATA.Functions.Processing.FunctionPool.CallAssembling
              }
            }

            #---------------------------
            # Suspense FCT
            #---------------------------
            Suspense
            {
              ModuleName  = FCT_Suspense
              Module
              {
                Active = True
                SuspenseCreateStream     = SuspenseCreateOutput
                SuspenseUpdateStream     = SuspenseUpdateOutput
                DataConnection           = ifw.DataPool.LoginInfranet
                LogTestResults           = False
                PipelineCategory         = RatingPipeline
                RecycleLog
                {
                } 
              }
            }


          } #END FunctionPool
        }
      } # END Functions

      #--------------------------------------------------
      # Output Section
      #--------------------------------------------------
      Output
      {
        WriteDefaultEdr            = False

        MaxErrorRates
        {
          INF_EDR_REJECTED = 100
          ERR_CUST_NOT_FOUND = 20
        }

        #-------------------------------------------
        # Multithreaded writing. This is recommended
        # when EDRs are associated with multiple
        # output streams.
        #------------------------------------------
        MultiThreading
        {
           Active = False      # Defaults to False
           NumberOfThreads = 1 # Number of threads spawned. Defaults to 1
           #Active = True      
           #NumberOfThreads = 7 
           BatchSize = 0       # The number of EDRs cached before sent for writing. Defaults to 0
        }


        OutputCollection
        {
          #--------------------------------------------------------------------
          # The DevNull stream
          #--------------------------------------------------------------------
          DevNull
          {
            ModuleName = OUT_DevNull
            Module
            { 
            } 
          } # end of DevNull

          
          #--------------------------------------------------------------------
          # Output stream for no balance events
          #--------------------------------------------------------------------
          DiscountErrorOutput
          {
            ModuleName = OUT_Reject
            Module
            {
              DeleteEmptyStream = TRUE # defaults to TRUE
	
              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_postpaid/discountError
                  OutputPrefix = test
                  OutputSuffix = .dsc
                  TempPrefix   = tmp
                  TempDataPath    = /cdrapp_postpaid/discountError
                  TempDataPrefix  = dsc.tmp.
                  TempDataSuffix  = .data
                  Replace = TRUE
                }
              }
            }
          }

          #--------------------------------------------------------------------
	  # Output stream for dead-locked events.
	  #--------------------------------------------------------------------
	  DiscountDeadlockOutput
	  {
	    ModuleName = OUT_Reject
	    Module
	    {
	      DeleteEmptyStream = TRUE # defaults to TRUE
	      OutputStream
	      {
	        ModuleName = EXT_OutFileManager
	        Module
	        {
		  OutputPath = /cdrapp_postpaid/discountError
		  OutputPrefix = test
		  OutputSuffix = .dlk
		  TempPrefix   = tmp
		  TempDataPath    = /cdrapp_postpaid/discountError
		  TempDataPrefix  = dlk.tmp.
		  TempDataSuffix  = .data
		  Replace = TRUE
		}
	      }
	    }
	  }  # end of DiscountDeadlockOutput
 
          #--------------------------------------------------------------------
          # The /service/gsm/telephony output stream
          #--------------------------------------------------------------------
          TELOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/voice

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
               
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_postpaid/out/telephony
                  OutputPrefix = test_TEL
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_postpaid/out/telephony
                  TempDataPrefix  = tel.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of TELOutput

           # end of CONV_TELOutput

          SMSOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/sms

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_postpaid/out/sms
                  OutputPrefix = test_SMS
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_postpaid/out/sms
                  TempDataPrefix  = sms.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of SMSOutput

           # end of CONV_SMSOutput

		 #--------------------------------------------------------------------
          # The /service/telco/gsm/mms output stream
          #--------------------------------------------------------------------
          MMSOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/mms

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_postpaid/out/mms
                  OutputPrefix = test_MMS
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_postpaid/out/mms
                  TempDataPrefix  = mms.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of MMSOutput

           # end of CONV_MMSOutput
			#--------------------------------------------------------------------
          # The /service/telco/gsm/voicemail output stream
          #--------------------------------------------------------------------
          VOMOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/voicemail

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_postpaid/out/voicemail
                  OutputPrefix = test_VOM
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_postpaid/out/voicemail
                  TempDataPrefix  = vom.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of VOMOutput

           # end of CONV_VOMOutput
		  
		  		#--------------------------------------------------------------------
          # The /service/telco/gsm/data output stream
          #--------------------------------------------------------------------
          DATOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/data

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_postpaid/out/data
                  OutputPrefix = test_DAT
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_postpaid/out/data
                  TempDataPrefix  = dat.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of DATOutput

           # end of CONV_DATOutput
		  
		  #--------------------------------------------------------------------
          # The /service/telco/gsm/vas output stream
          #--------------------------------------------------------------------
          VASOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/vas

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_postpaid/out/vas
                  OutputPrefix = test_VAS
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_postpaid/out/vas
                  TempDataPrefix  = vas.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of VASOutput

           # end of CONV_VASOutput
		  
		 #--------------------------------------------------------------------
          # The /service/telco/gsm/valuepack output stream
          #--------------------------------------------------------------------
          VAPOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/valuepack

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_postpaid/out/vap
                  OutputPrefix = test_VAP
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_postpaid/out/vap
                  TempDataPrefix  = vap.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of VAPOutput

           # end of CONV_VAPOutput
		  
          #--------------------------------------------------------------------
          # The /service/wap output stream
          #--------------------------------------------------------------------

          #--------------------------------------------------------------------
          # SuspenseCreateOutput stream
          #--------------------------------------------------------------------
          SuspenseCreateOutput
          {
            ModuleName = OUT_GenericStream
            EventType = /suspended_usage/telco/gsm
            Module
            {
              Grammar = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageCreationGrammar.dsc
              DeleteEmptyStream = True
              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_postpaid/reject
                  OutputPrefix = suspense_create_
                  OutputSuffix = .out
                  TempPrefix = tmp
                  TempDataPath = /cdrapp_postpaid/reject
                  TempDataPrefix = susp.create.tmp.
                  TempDataSuffix = .data
                  Replace = True
                  AppendSequenceNumber = False
                }
              }
            }
          } # end of SuspenseCreateOutput

          #--------------------------------------------------------------------
          # SuspenseUpdateOutput stream
          #--------------------------------------------------------------------
          SuspenseUpdateOutput
          {
            ModuleName = OUT_GenericStream
            EventType = /tmp_suspended_usage

            Module
            {
              Grammar = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageUpdateGrammar.dsc
              DeleteEmptyStream = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_postpaid/reject
                  OutputPrefix = suspense_update_
                  OutputSuffix = .out
                  TempPrefix = tmp
                  TempDataPath = /cdrapp_postpaid/reject
                  TempDataPrefix = susp.update.tmp.
                  TempDataSuffix = .data
                  Replace = True
                  AppendSequenceNumber = False
                }
              }
            }
          } # end of SuspenseUpdateOutput
        } # end of OutputCollection

        OutputLog
        {
          FilePath        = /var/portal/ifw/log/stream
          FileName        = stream
          FilePrefix      = Stream_
          FileSuffix      = .log
		
	  # Added by GSM
           #LogLevel = warning
           LogLevel = major

          SuppressErrors
          {
            ERR_SPEC_VERSION_INVALID
            ERR_RELEASE_VERSION_INVALID
         WRN_NO_GLID 
	 }
        }
        
        #SequenceGeneration = Unit
        SequenceGeneration = Transaction

	#-------------------------------
        EdrTraceEnabled = FALSE
        EdrTrace
        {
            TraceLog
            {
                 FilePath   = /var/portal/ifw/log/edrLog
                 FileName   = edrTraceLog
                 FilePrefix = log_
                 FileSuffix = .log
            }

            TraceStartPoint =  Input
            TraceEndPoint   = Output

        } # END EdrTrace

        
      } # end of Output    
      
    }

    TD_POSTPAID_RATE_SMS
    {
      Active                      = TRUE
      
      CountryCode                 = 64 
      MobileCountryCode           = 64
      NationalAccessCode          = 0
      #InternationalAccessCode     = 00
      #InternationalAccessCodeSign = +
      NetworkDestinationCode      = 172
      RejectStream                = SuspenseCreateOutput
      
      TransactionManager
      {
        RedoEnabled = True #False
        SingleTransaction = False
        WriteToLogEnabled = True
        BinaryLogFileName = ./tam/binaryLogFileTD_POSTPAID_RATE_SMS.dat
      }
      
      EdrFactory 
      { 
        DataConnection = ifw.DataPool.Login 
        Description =  ./TD/formatDesc/Portal/td_containerDesc.dsc
        UsageStatistic = /var/portal/ifw/log/statistic/edrStatisticTD_POSTPAID_RATE_SMS.txt 
        EdrVersionDataConnection = ifw.DataPool.LoginInfranet
      }

      DataDescription
      {
        Standard
        {
          ModuleName = Standard
          Module
          {
            StreamFormats
            {
	      SOL42_FORINPUT = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_RATE_FORINPUT.dsc
              EVENT_LOADER = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_Format.dsc
              SUSPENSE_CREATE_OUTPUT = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageCreation.dsc
              SUSPENSE_UPDATE_OUTPUT = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageUpdate.dsc
            }

            InputMapping
            {
              SOL42_FORINPUT = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_RATE_InMap.dsc
            }

            OutputMapping
            {
              EVENT_LOADER = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutMap.dsc
              SUSPENSE_CREATE_OUTPUT = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageCreationMapping.dsc
              SUSPENSE_UPDATE_OUTPUT = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageUpdateMapping.dsc
            }
          }
        }
      } # end of DataDescription

      PipelineLog 
      { 
        ModuleName = LOG
        Module 
        { 
          ITO 
          { 
            WriteMessageKey  = True
            FilePath = /var/portal/ifw/log/pipeline
            FileName = pipeline_TD_POSTPAID_RATE_SMS.log
            ProcessName = ifw
            MessageGroup = IFW
            ShowOriginator = TRUE
	    # Added by GSM
            #LogLevel = warning
            LogLevel = major
          }

          Buffer 
          { 
            #Size = 500
            #Updated by GSM
	    Size = 1000
          } 
        } 
      } # end of PipelineLog


      InputBuffer
      {
        BlockTransfer = False
        #Size = 1
        #BlockSize = 1
	#Updated by GSM
        Size = 100
        BlockSize = 100
      }

      OutputBuffer
      {
        BlockTransfer = False
        #Size = 1
        #BlockSize = 1
        #Updated by GSM
	Size = 100
        BlockSize = 100
      }
      
      #------------------------------------------------------------------------
      # Input section
      #------------------------------------------------------------------------
      Input
      {
        #UnitsPerTransaction = 1
        UnitsPerTransaction = 2

        InputModule
        {
          ModuleName  = INP_GenericStream
          Module
          {
            Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_RATE_InGrammar.dsc
            DefaultOutput = SMSOutput

            InputStream
            {
              ModuleName = EXT_InFileManager
              Module
              {
                InputDirEmptyTimeout = 10

                InputPath   = /cdrapp_postpaid/edr/sms
                InputPrefix = TD_RATE_POST
                InputSuffix = .edr
 
                DonePath    = /cdrapp_postpaid/done
                DonePrefix  = test_ALLRATE
                DoneSuffix  = .done
           
                ErrorPath   = /cdrapp_postpaid/error
                ErrorPrefix = test_ALLRATE
                ErrorSuffix = .err

                TempPrefix  = tmp_ALLRATE
  
                Replace     = TRUE
              }
            } # end of InputStream
          }
        } # end of InputModule
      } # end of Input

      
      #------------------------------------------------------------------------
      # Function section
      #------------------------------------------------------------------------
      Functions 
      {
        Processing
        {
          FunctionPool
          {

            #---------------------------------------------------
            # PreSuspense FCT
            #---------------------------------------------------
            PreSuspense
            {
              ModuleName = FCT_PreSuspense
              Module
              {
                Active = True
			QueryableFields
			{

				SUSP_USAGE_TELCO_INFO_T
				{
					# format : <database_column_name> = <edr_conatiner_field_name>
					START_TIME = DETAIL.CHARGING_START_TIMESTAMP
					CALL_DURATION = DETAIL.DURATION
					CALLING_FROM = DETAIL.A_NUMBER
					CALLED_TO = DETAIL.B_NUMBER
                                        SERVICE_TYPE = DETAIL.BASIC_SERVICE
                                        USAGE_TYPE = DETAIL.USAGE_TYPE
				}
                     		SUSP_USAGE_TELCO_GSM_INFO_T
                     		{
                        		CELL_ID = DETAIL.ASS_GSMW_EXT.CELL_ID
                         		DESTINATION_SID = DETAIL.ASS_GSMW_EXT.TERMINATING_SWITCH_IDENTIFICATION
                        		DIALED_NUMBER = DETAIL.ASS_GSMW_EXT.DIALED_DIGITS
                        		ORIGIN_SID = DETAIL.ASS_GSMW_EXT.ORIGINATING_SWITCH_IDENTIFICATION 
                                     	SECONDARY_MSID = DETAIL.ASS_GSMW_EXT.PORT_NUMBER
                     		}
			}
              }
            }

            #--------------------------------------------------
            # Service Code Mapping
            #--------------------------------------------------
            ServiceCodeMap 
            { 
              ModuleName = FCT_ServiceCodeMap
              Module 
              { 
                Active             = TRUE
                DataConnection     = ifw.DataPool.Login
                MapGroup           = ALL_RATE
              } 
            } 

            #--------------------------------------------------
            # Usage Class Mapping
            #--------------------------------------------------
            UsageClassMap
            {
              ModuleName = FCT_UsageClassMap 
              Module 
              { 
                Active              = TRUE
                DataConnection      = ifw.DataPool.Login
                OverwriteUsageClass = False 
                MapGroup            = ALL_RATE
                #OptimizeFor        = Memory
              } 
            }


            #--------------------------------------------------
            # Discarding (of events)
            #--------------------------------------------------
            EventDiscarding
            {
              ModuleName = FCT_Discard
              Module
              {
                Active = TRUE
                DataConnection = ifw.DataPool.Login
                Function       = Discard
                StreamName     = DevNull
              }
            }


            #--------------------------------------------------
            # Infranet Customer
            #--------------------------------------------------
            CustomerSearch 
            { 
              ModuleName = FCT_Account
              Module 
              { 
                Active         = TRUE
                DataModule     = ifw.DataPool.CustomerData
                #DisableRatingProductCheck  = False
              }
            } 

	#---------------------------------------------------------
            # UpdateGLID - updates GLID field
            #---------------------------------------------------------
            ItemAssign
            {
              ModuleName = FCT_IScript
              Module
              {
                Active = True
                Source = File
                Scripts
                {
                  ItemAssign
                  {
                        FileName = ./TD/iScript_custom/ISC_TD_ItemTag.isc
                  }
                }
              }
            }

            #--------------------------------------------------
            # Customer Individual Rating
            #--------------------------------------------------
            CustomerRating
            { 
              ModuleName = FCT_CustomerRating 
              Module 
              { 
                Active            = TRUE
                Mode              = CUSTOMER 
                DataConnection    = ifw.DataPool.Login 
                DefaultRateplan   = Standard
                LeastCostRating   = False
                PromotionalSaving = False
              } 
            }

 
            #--------------------------------------------------
            # Pre-Rating (Zoning)
            #--------------------------------------------------
            PreRatingZone
            {
              ModuleName = FCT_PreRating
              Module
              {
                Active = True
                RateplanDataModule = ifw.DataPool.RateplanDataModule
                ZoneDataModule = ifw.DataPool.ZoneDataModule
              }
            }

	##----------------------------------------------------------------------

            # Main Rating (Pricing)
            #--------------------------------------------------
            MainRating
            {
              ModuleName = FCT_MainRating
              Module
              {
                Active                  = TRUE
                RateplanDataModule      = ifw.DataPool.RateplanDataModule
                CalendarDataModule      = ifw.DataPool.CalendarDataModule
                TimeDataModule          = ifw.DataPool.TimeDataModule
                PriceDataModule         = ifw.DataPool.PriceDataModule
                CurrencyDataModule      = ifw.DataPool.CurrencyDataModule
                ModelSelectorDataModule = ifw.DataPool.ModelSelectorDataModule
              }
            }
 	
            #--------------------------------------------------
            # Discount Analysis
            #--------------------------------------------------
            DiscountAnalysisModule
            {
              ModuleName = FCT_DiscountAnalysis
              Module
              {
                Active                   = TRUE
                #Active                   = FALSE
                DiscountModelDataModule  = ifw.DataPool.DiscountModelDataModule
                #Filter_SetModule         = ifw.Pipelines.TD_POSTPAID_RATE_SMS.Functions.Processing.FunctionPool.Filter_Set 
                ModelSelectorDataModule  = ifw.DataPool.ModelSelectorDataModule

              } 
            }


            #--------------------------------------------------
            # Discounting
            #--------------------------------------------------
            ApolloDiscountModule
            {
              ModuleName = FCT_Discount
              Module
              {
                Active                   = TRUE
                #Active                   = FALSE
                DiscountDataModule       = ifw.DataPool.DiscountModelDataModule
                BalanceDataModule        = ifw.DataPool.BalanceDataModule
                AccountDataModule        = ifw.DataPool.CustomerData
                CurrencyDataModule       = ifw.DataPool.CurrencyDataModule
                DiscountMoreThanPossible = False 
                BackOut                  = False 
                SupportBundleERA         = False
                IgnoreEDROnDeadlock      = False
		IgnoreEDROnDiscountError = False
		IgnoreEDROnLock          = False
              } 
            }
	    

            #--------------------------------------------------
            # ApplyBalance
            #--------------------------------------------------
            ApolloApplyBalanceModule
            {
              ModuleName = FCT_ApplyBalance
              Module
              {
                Active                       = TRUE
                DiscountDataModule           = ifw.DataPool.DiscountModelDataModule
                BalanceDataModule            = ifw.DataPool.BalanceDataModule
                DiscountFunctionalModule     = Functions.Processing.FunctionPool.ApolloDiscountModule
                PortalConfigDataModule       = ifw.DataPool.PortalConfigDataModule
                #NumberOfNotificationLimit   = 1000
                NotificationOutputDirectory = /cdrapp_postpaid/out/notifybalancebreach
                NotificationOutputPrefix    = balancebreach_
              }
            }


            #--------------------------------------------------
            # ItemAssign PlugIn
            #--------------------------------------------------
            FlexibleItemAssignment
            {
              ModuleName = FCT_ItemAssign
              Module
              {
                 Active     = TRUE
                 DataModule     = ifw.DataPool.ItemAssignDataModule
              }
            }

            #----------------------------------------------------------------
            # Add Infranet Billing Record (plugin version)
            #----------------------------------------------------------------
            AddInfranetBillingRecord
            {
              ModuleName = FCT_BillingRecord
              Module
              {
                Active = TRUE
                CurrencyType = R
                CurrencyDataModule = ifw.DataPool.CurrencyDataModule
                ItemAssignDataModule     = ifw.DataPool.ItemAssignDataModule
                AccountDataModule  = ifw.DataPool.CustomerData
                BalanceDataModule        = ifw.DataPool.BalanceDataModule
                PortalConfigDataModule   = ifw.DataPool.PortalConfigDataModule
              }
            }

            #--------------------------------------------------
            # Split Output per ServiceCode
            #--------------------------------------------------              
            ServiceOutputPostpaidSplit
            {
              ModuleName = FCT_IRules
              Module
              {
                Active = TRUE
                Source = File
                Rules
                {
                }
                Descriptions
                {
                  ServiceCodeSplitPost = ./TD/iScript_custom/IRL_EventTypeSplittingPostpaid.irl
                }
              }
            }

            #--------------------------------------------------
            # Rejection
            #--------------------------------------------------
            Rejection
            {
              ModuleName = FCT_Reject
              Module
              {
                Active          = True 
                NotifyOnReject  = True 
                UseRejectStream = True 
                StreamMap 
                {
                  INF_IGNORE_ON_DISCOUNTACCOUNT_DEADLOCK = DiscountDeadlockOutput
                  INF_IGNORE_ON_DISCOUNT_ERROR           = DiscountErrorOutput
		  INF_IGNORE_ON_BALANCEGROUP_LOCK        = DiscountErrorOutput 
                }
		
		# This is required if FCT_CallAssembing module is being used.
		#CallAssemblingModule = ifw.Pipelines.TD_POSTPAID_RATE.Functions.Processing.FunctionPool.CallAssembling
              }
            }

            #---------------------------
            # Suspense FCT
            #---------------------------
            Suspense
            {
              ModuleName  = FCT_Suspense
              Module
              {
                Active = True
                SuspenseCreateStream     = SuspenseCreateOutput
                SuspenseUpdateStream     = SuspenseUpdateOutput
                DataConnection           = ifw.DataPool.LoginInfranet
                LogTestResults           = False
                PipelineCategory         = RatingPipeline
                RecycleLog
                {
                } 
              }
            }


          } #END FunctionPool
        }
      } # END Functions

      #--------------------------------------------------
      # Output Section
      #--------------------------------------------------
      Output
      {
        WriteDefaultEdr            = False

        MaxErrorRates
        {
          INF_EDR_REJECTED = 100
          ERR_CUST_NOT_FOUND = 20
        }

        #-------------------------------------------
        # Multithreaded writing. This is recommended
        # when EDRs are associated with multiple
        # output streams.
        #------------------------------------------
        MultiThreading
        {
           Active = False      # Defaults to False
           NumberOfThreads = 1 # Number of threads spawned. Defaults to 1
           #Active = True      
           #NumberOfThreads = 7 
           BatchSize = 0       # The number of EDRs cached before sent for writing. Defaults to 0
        }


        OutputCollection
        {
          #--------------------------------------------------------------------
          # The DevNull stream
          #--------------------------------------------------------------------
          DevNull
          {
            ModuleName = OUT_DevNull
            Module
            { 
            } 
          } # end of DevNull

          
          #--------------------------------------------------------------------
          # Output stream for no balance events
          #--------------------------------------------------------------------
          DiscountErrorOutput
          {
            ModuleName = OUT_Reject
            Module
            {
              DeleteEmptyStream = TRUE # defaults to TRUE
	
              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_postpaid/discountError
                  OutputPrefix = test
                  OutputSuffix = .dsc
                  TempPrefix   = tmp
                  TempDataPath    = /cdrapp_postpaid/discountError
                  TempDataPrefix  = dsc.tmp.
                  TempDataSuffix  = .data
                  Replace = TRUE
                }
              }
            }
          }

          #--------------------------------------------------------------------
	  # Output stream for dead-locked events.
	  #--------------------------------------------------------------------
	  DiscountDeadlockOutput
	  {
	    ModuleName = OUT_Reject
	    Module
	    {
	      DeleteEmptyStream = TRUE # defaults to TRUE
	      OutputStream
	      {
	        ModuleName = EXT_OutFileManager
	        Module
	        {
		  OutputPath = /cdrapp_postpaid/discountError
		  OutputPrefix = test
		  OutputSuffix = .dlk
		  TempPrefix   = tmp
		  TempDataPath    = /cdrapp_postpaid/discountError
		  TempDataPrefix  = dlk.tmp.
		  TempDataSuffix  = .data
		  Replace = TRUE
		}
	      }
	    }
	  }  # end of DiscountDeadlockOutput
 
          #--------------------------------------------------------------------
          # The /service/gsm/telephony output stream
          #--------------------------------------------------------------------
          TELOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/voice

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
               
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_postpaid/out/telephony
                  OutputPrefix = test_TEL
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_postpaid/out/telephony
                  TempDataPrefix  = tel.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of TELOutput

           # end of CONV_TELOutput

          SMSOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/sms

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_postpaid/out/sms
                  OutputPrefix = test_SMS
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_postpaid/out/sms
                  TempDataPrefix  = sms.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of SMSOutput

           # end of CONV_SMSOutput

		 #--------------------------------------------------------------------
          # The /service/telco/gsm/mms output stream
          #--------------------------------------------------------------------
          MMSOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/mms

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_postpaid/out/mms
                  OutputPrefix = test_MMS
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_postpaid/out/mms
                  TempDataPrefix  = mms.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of MMSOutput

           # end of CONV_MMSOutput
			#--------------------------------------------------------------------
          # The /service/telco/gsm/voicemail output stream
          #--------------------------------------------------------------------
          VOMOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/voicemail

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_postpaid/out/voicemail
                  OutputPrefix = test_VOM
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_postpaid/out/voicemail
                  TempDataPrefix  = vom.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of VOMOutput

           # end of CONV_VOMOutput
		  
		  		#--------------------------------------------------------------------
          # The /service/telco/gsm/data output stream
          #--------------------------------------------------------------------
          DATOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/data

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_postpaid/out/data
                  OutputPrefix = test_DAT
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_postpaid/out/data
                  TempDataPrefix  = dat.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of DATOutput

           # end of CONV_DATOutput
		  
		  #--------------------------------------------------------------------
          # The /service/telco/gsm/vas output stream
          #--------------------------------------------------------------------
          VASOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/vas

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_postpaid/out/vas
                  OutputPrefix = test_VAS
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_postpaid/out/vas
                  TempDataPrefix  = vas.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of VASOutput

           # end of CONV_VASOutput
		  
		 #--------------------------------------------------------------------
          # The /service/telco/gsm/valuepack output stream
          #--------------------------------------------------------------------
          VAPOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/valuepack

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_postpaid/out/vap
                  OutputPrefix = test_VAP
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_postpaid/out/vap
                  TempDataPrefix  = vap.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of VAPOutput

           # end of CONV_VAPOutput
		  
          #--------------------------------------------------------------------
          # The /service/wap output stream
          #--------------------------------------------------------------------

          #--------------------------------------------------------------------
          # SuspenseCreateOutput stream
          #--------------------------------------------------------------------
          SuspenseCreateOutput
          {
            ModuleName = OUT_GenericStream
            EventType = /suspended_usage/telco/gsm
            Module
            {
              Grammar = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageCreationGrammar.dsc
              DeleteEmptyStream = True
              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_postpaid/reject
                  OutputPrefix = suspense_create_
                  OutputSuffix = .out
                  TempPrefix = tmp
                  TempDataPath = /cdrapp_postpaid/reject
                  TempDataPrefix = susp.create.tmp.
                  TempDataSuffix = .data
                  Replace = True
                  AppendSequenceNumber = False
                }
              }
            }
          } # end of SuspenseCreateOutput

          #--------------------------------------------------------------------
          # SuspenseUpdateOutput stream
          #--------------------------------------------------------------------
          SuspenseUpdateOutput
          {
            ModuleName = OUT_GenericStream
            EventType = /tmp_suspended_usage

            Module
            {
              Grammar = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageUpdateGrammar.dsc
              DeleteEmptyStream = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_postpaid/reject
                  OutputPrefix = suspense_update_
                  OutputSuffix = .out
                  TempPrefix = tmp
                  TempDataPath = /cdrapp_postpaid/reject
                  TempDataPrefix = susp.update.tmp.
                  TempDataSuffix = .data
                  Replace = True
                  AppendSequenceNumber = False
                }
              }
            }
          } # end of SuspenseUpdateOutput
        } # end of OutputCollection

        OutputLog
        {
          FilePath        = /var/portal/ifw/log/stream
          FileName        = stream
          FilePrefix      = Stream_
          FileSuffix      = .log
		
	  # Added by GSM
           #LogLevel = warning
           LogLevel = major

          SuppressErrors
          {
            ERR_SPEC_VERSION_INVALID
            ERR_RELEASE_VERSION_INVALID
         WRN_NO_GLID 
	 }
        }
        
        #SequenceGeneration = Unit
        SequenceGeneration = Transaction

	#-------------------------------
        EdrTraceEnabled = FALSE
        EdrTrace
        {
            TraceLog
            {
                 FilePath   = /var/portal/ifw/log/edrLog
                 FileName   = edrTraceLog
                 FilePrefix = log_
                 FileSuffix = .log
            }

            TraceStartPoint =  Input
            TraceEndPoint   = Output

        } # END EdrTrace

        
      } # end of Output    
      
    }
    #=============================================================

    TD_PREPAID_RATE
    {
      Active                      = TRUE
      
      CountryCode                 = 974 
      MobileCountryCode           = 974
      NationalAccessCode          = 0
      #InternationalAccessCode     = 00
      #InternationalAccessCodeSign = +
      NetworkDestinationCode      = 172
      RejectStream                = SuspenseCreateOutput
      
      TransactionManager
      {
        RedoEnabled = True #False
        SingleTransaction = False
        WriteToLogEnabled = True
        BinaryLogFileName = ./tam/binaryLogFilePrepaidWIRELESS.dat
      }
      
      EdrFactory 
      { 
        DataConnection = ifw.DataPool.Login 
        Description =  ./TD/formatDesc/Portal/td_containerDesc.dsc
        UsageStatistic = /var/portal/ifw/log/statistic/edrStatisticTD_PREPAID_RATE.txt 
        EdrVersionDataConnection = ifw.DataPool.LoginInfranet
      }

      DataDescription
      {
        Standard
        {
          ModuleName = Standard
          Module
          {
            StreamFormats
            {
	      SOL42_FORINPUT = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_RATE_FORINPUT.dsc
              EVENT_LOADER = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_Format.dsc
              SUSPENSE_CREATE_OUTPUT = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageCreation.dsc
              SUSPENSE_UPDATE_OUTPUT = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageUpdate.dsc
            }

            InputMapping
            {
              SOL42 = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_RATE_InMap.dsc
            }

            OutputMapping
            {
              EVENT_LOADER = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutMap.dsc
              SUSPENSE_CREATE_OUTPUT = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageCreationMapping.dsc
              SUSPENSE_UPDATE_OUTPUT = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageUpdateMapping.dsc
            }
          }
        }
      } # end of DataDescription

      PipelineLog 
      { 
        ModuleName = LOG
        Module 
        { 
          ITO 
          { 
            WriteMessageKey  = True
            FilePath = /var/portal/ifw/log/pipeline
            FileName = pipeline_TD_PREPAID_RATE.log
            ProcessName = ifw
            MessageGroup = IFW
            ShowOriginator = TRUE
   	# Added by GSM
            #LogLevel = warning	
            LogLevel = major
          }

          Buffer 
          { 
            Size = 1000
          } 
        } 
      } # end of PipelineLog


      InputBuffer
      {
        BlockTransfer = False
        Size = 100
        BlockSize = 100
      }

      OutputBuffer
      {
        BlockTransfer = False
        Size = 100
        BlockSize = 100
      }
      
      #------------------------------------------------------------------------
      # Input section
      #------------------------------------------------------------------------
      Input
      {
        UnitsPerTransaction = 2

        InputModule
        {
          ModuleName  = INP_GenericStream
          Module
          {
            Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_RATE_InGrammar.dsc
            DefaultOutput = TELPREOutput

            InputStream
            {
              ModuleName = EXT_InFileManager
              Module
              {
                InputDirEmptyTimeout = 10

                InputPath   = /cdrapp_prepaid/edr/others
                InputPrefix = TD_RATE_PRE
                InputSuffix = .edr
 
                DonePath    = /cdrapp_prepaid/done
                DonePrefix  = test_ALLRATE
                DoneSuffix  = .done
           
                ErrorPath   = /cdrapp_prepaid/error
                ErrorPrefix = test_ALLRATE
                ErrorSuffix = .err

                TempPrefix  = tmp_ALLRATE
  
                Replace     = TRUE
              }
            } # end of InputStream
          }
        } # end of InputModule
      } # end of Input

      
      #------------------------------------------------------------------------
      # Function section
      #------------------------------------------------------------------------
      Functions 
      {
        Processing
        {
          FunctionPool
          {

        EdrDump_PreSuspenseDump
          {
            ModuleName = FCT_EdrDump
            Module
            {
              Active   = FALSE
              FileName = /cdrapp_prepaid/dump/PreSuspense.dump
            }
          }

            #---------------------------------------------------
            # PreSuspense FCT
            #---------------------------------------------------
            PreSuspense
            {
              ModuleName = FCT_PreSuspense
              Module
              {
                Active = True
                        QueryableFields
                        {

                                SUSP_USAGE_TELCO_INFO_T
                                {
                                        # format : <database_column_name> = <edr_conatiner_field_name>
                                        START_TIME = DETAIL.CHARGING_START_TIMESTAMP
                                        CALL_DURATION = DETAIL.DURATION
                                        CALLING_FROM = DETAIL.A_NUMBER
                                        CALLED_TO = DETAIL.B_NUMBER
                         		SERVICE_TYPE = DETAIL.BASIC_SERVICE
                         		USAGE_TYPE = DETAIL.USAGE_TYPE
                                }
                                SUSP_USAGE_TELCO_GSM_INFO_T
                                {
                                        CELL_ID = DETAIL.ASS_GSMW_EXT.CELL_ID
                                        DESTINATION_SID = DETAIL.ASS_GSMW_EXT.TERMINATING_SWITCH_IDENTIFICATION
                                        DIALED_NUMBER = DETAIL.ASS_GSMW_EXT.DIALED_DIGITS
                                        ORIGIN_SID = DETAIL.ASS_GSMW_EXT.ORIGINATING_SWITCH_IDENTIFICATION
                                        SECONDARY_MSID = DETAIL.ASS_GSMW_EXT.PORT_NUMBER
                                }
                        }

              }
            }

            #--------------------------------------------------
            # Service Code Mapping
            #--------------------------------------------------
            ServiceCodeMap 
            { 
              ModuleName = FCT_ServiceCodeMap
              Module 
              { 
                Active             = TRUE
                DataConnection     = ifw.DataPool.Login
                MapGroup           = ALL_RATE
              } 
            } 

        EdrDump_ServiceCodeMapDump
          {
            ModuleName = FCT_EdrDump
            Module
            {
              Active   = FALSE
              FileName = /cdrapp_prepaid/dump/ServiceCodeMap.dump
            }
          }

            #--------------------------------------------------
            # Usage Class Mapping
            #--------------------------------------------------
            UsageClassMap
            {
              ModuleName = FCT_UsageClassMap 
              Module 
              { 
                Active              = TRUE
                DataConnection      = ifw.DataPool.Login
                OverwriteUsageClass = False 
                MapGroup            = ALL_RATE
                #OptimizeFor        = Memory
              } 
            }

        EdrDump_UsageClassMapDump
          {
            ModuleName = FCT_EdrDump
            Module
            {
              Active   = FALSE
              FileName = /cdrapp_prepaid/dump/UsageClassMap.dump
            }
          }


            #--------------------------------------------------
            # Discarding (of events)
            #--------------------------------------------------
            EventDiscarding
            {
              ModuleName = FCT_Discard
              Module
              {
                Active = TRUE
                DataConnection = ifw.DataPool.Login
                Function       = Discard
                StreamName     = DevNull
              }
            }

            #--------------------------------------------------
            # Call Assembling 
            #--------------------------------------------------
            CallAssembling 
            { 
              ModuleName = FCT_CallAssembling 
              Module 
              { 
                Active = False 

                Path = . 
                FileName = calls 

                RejectMissingChain = False
              } 
            } 

            #--------------------------------------------------
            # Prefix Description
            #--------------------------------------------------
            PrefixDesc
            {
              ModuleName = FCT_PrefixDesc
              Module
              {
                Active = False
                PrefixDataModule = ifw.DataPool.PrefixDescDataModule
              }
            }
 

            #--------------------------------------------------
            # Infranet Customer
            #--------------------------------------------------
            CustomerSearch 
            { 
              ModuleName = FCT_Account
              Module 
              { 
                Active         = TRUE
                DataModule     = ifw.DataPool.CustomerData
                #DisableRatingProductCheck  = False
              }
            } 

        EdrDump_CustomerDataDump
          {
            ModuleName = FCT_EdrDump
            Module
            {
              Active   = FALSE
              FileName = /cdrapp_prepaid/dump/CustomerData.dump
            }
          }



	#---------------------------------------------------------
            # UpdateGLID - updates GLID field
            #---------------------------------------------------------
            ItemAssign
            {
              ModuleName = FCT_IScript
              Module
              {
                Active = True
                Source = File
                Scripts
                {
                  ItemAssign
                  {
                        FileName = ./TD/iScript_custom/ISC_TD_ItemTag.isc
                  }
                }
              }
            }
            #--------------------------------------------------
            # Profile analysis
            #--------------------------------------------------
            ProfileAnalyzer
            {
              ModuleName = FCT_IScript
              Module
              {
                Active = False
                Source = FILE
                Scripts
                {
                  ProfileAnalyzer
                  {
                    ProfileName = FRIENDS_FAMILY
                    LabelSeparator = ,
                    FileName = ./iScriptLib/iScriptLib_Standard/ISC_ProfileAnalyzer.isc
                  }
                }
              }
            }

            #--------------------------------------------------
            # Usage Type Mapping
            #--------------------------------------------------
            UsageType
            {
               ModuleName = FCT_IRules
               Module
               {
                 Active = FALSE
                 Source = File
                 Descriptions
                 {
                   UsageTypeDetermination= ./iScriptLib/iScriptLib_Standard/IRL_UsageType.irl
                 }
               }
            }

            #--------------------------------------------------
            # FCT_Filter_Set registry entry fields.
            #--------------------------------------------------
            # Filter_Set FCT
            #---------------------------
            Filter_Set
            {
              ModuleName                = FCT_Filter_Set
              Module
              {
                Active                   = False
                DiscountDataModule       = ifw.DataPool.DiscountModelDataModule
                AccountDataModule        = ifw.DataPool.CustomerData
                InfranetConnection       = ifw.DataPool.LoginInfranet
              }
            }

            #--------------------------------------------------
            # Get the Least Cost As Per Market Segment and the
            # the product priority for each edr.
            #--------------------------------------------------
            LeastCostPerEDR
            {
               ModuleName = FCT_IRules
               Module
               {
                 Active = False
                 Source = File
                 Descriptions
                 {
                   LeastCostCheck= ./iScriptLib/iScriptLib_Standard/IRL_LeastCostPerEDR.irl
                 }
               }
            }

            #--------------------------------------------------
            # Get the Promotion Saving as per the product attributes
            #--------------------------------------------------
            PromotionalSavingPerEDR
            {
               ModuleName = FCT_IRules
               Module
               {
                 Active = False
                 Source = File
                 Descriptions
                 {
                   PromotionalSaving = ./iScriptLib/iScriptLib_Standard/IRL_PromotionalSavingPerEDR.irl
                 }
               }
            }

        EdrDump_CustomerRatingDump
          {
            ModuleName = FCT_EdrDump
            Module
            {
              Active   = FALSE
              FileName = /cdrapp_prepaid/dump/CustomerRating.dump
            }
          }

            #--------------------------------------------------
            # Customer Individual Rating
            #--------------------------------------------------
            CustomerRating
            { 
              ModuleName = FCT_CustomerRating 
              Module 
              { 
                Active            = TRUE
                Mode              = CUSTOMER 
                DataConnection    = ifw.DataPool.Login 
                DefaultRateplan   = Standard
                LeastCostRating   = False
                PromotionalSaving = False
              } 
            }

        EdrDump_PostCustomerRatingDump
          {
            ModuleName = FCT_EdrDump
            Module
            {
              Active   = FALSE
              FileName = /cdrapp_prepaid/dump/PostCustomerRating.dump
            }
          }


 
            #--------------------------------------------------
            # Pre-Rating (Zoning)
            #--------------------------------------------------
            PreRatingZone
            {
              ModuleName = FCT_PreRating
              Module
              {
                Active = True
                RateplanDataModule = ifw.DataPool.RateplanDataModule
                ZoneDataModule = ifw.DataPool.ZoneDataModule
              }
            }

        EdrDump_PreRatingZone
          {
            ModuleName = FCT_EdrDump
            Module
            {
              Active   = FALSE
              FileName = /cdrapp_prepaid/dump/PreRatingZone.dump
            }
          }


            #--------------------------------------------------
            # Access Point Name Mapping (after zoning)
            #--------------------------------------------------              
            APNMap
            {
              ModuleName = FCT_APN_Map 
              Module 
              { 
                Active         = FALSE
                DataConnection = ifw.DataPool.Login
                APNGroup {} 
              }
            } 
        EdrDump_APNMap
          {
            ModuleName = FCT_EdrDump
            Module
            {
              Active   = FALSE
              FileName = /cdrapp_prepaid/dump/APNMap.dump
            }
          }

            #--------------------------------------------------
            # Usage Scenario Mapping
            #--------------------------------------------------
            UsageScenarioMap
            {
              ModuleName = FCT_USC_Map
              Module
              {
                Active = FALSE
                DataModule = ifw.DataPool.USCDataModule
                DefaultUSCGroup = ALL_RATE
              }
            }
        EdrDump_UsageScenarioMap
          {
            ModuleName = FCT_EdrDump
            Module
            {
              Active   = FALSE
              FileName = /cdrapp_prepaid/dump/UsageScenarioMap.dump
            }
          }



            #--------------------------------------------------
            # Rate Service Class Mapping
            #--------------------------------------------------              
            RateServiceClassMap 
            { 
              ModuleName = FCT_RSC_Map 
              Module 
              {
                Active          = FALSE 
                DataConnection  = ifw.DataPool.Login
                DefaultRscGroup = ALL_RATE
              } 
            }

##----------------------------------------------------------------------
##         Deprecated because of the introduction of EDR Trace
##----------------------------------------------------------------------
          EdrDump_MainRating_pre
          {
            ModuleName = FCT_EdrDump
            Module
            {
              Active   = FALSE
              FileName = /cdrapp_prepaid/dump/MainRating_pre.dump
            }
          }          
##----------------------------------------------------------------------

            # Main Rating (Pricing)
            #--------------------------------------------------
            MainRating
            {
              ModuleName = FCT_MainRating
              Module
              {
                Active                  = TRUE
                RateplanDataModule      = ifw.DataPool.RateplanDataModule
                CalendarDataModule      = ifw.DataPool.CalendarDataModule
                TimeDataModule          = ifw.DataPool.TimeDataModule
                PriceDataModule         = ifw.DataPool.PriceDataModule
                CurrencyDataModule      = ifw.DataPool.CurrencyDataModule
                ModelSelectorDataModule = ifw.DataPool.ModelSelectorDataModule
              }
            }
 	
##----------------------------------------------------------------------
##         Deprecated because of the introduction of EDR Trace
##----------------------------------------------------------------------
          EdrDump_MainRating_post
          {
            ModuleName = FCT_EdrDump
            Module
            {
              Active   = FALSE
              FileName = /cdrapp_prepaid/dump/MainRating_post.dump
            }
          }   
##----------------------------------------------------------------------

            #--------------------------------------------------
            # Special Dayrates
            #--------------------------------------------------
            SpecialDayRate
            {
              ModuleName = FCT_Dayrate
              Module
              {
                Active = FALSE
                DayrateDataModule = ifw.DataPool.DayRateDataModule
              }
            }

            #--------------------------------------------------
            # Rate Adjustment
            #--------------------------------------------------
            RateAdjustment
            {
              ModuleName = FCT_RateAdjust
              Module
              {
                Active         = FALSE
                Source         = Database
                DataConnection = ifw.DataPool.Login
              }
            }

            #--------------------------------------------------
            # Discount Analysis
            #--------------------------------------------------
            DiscountAnalysisModule
            {
              ModuleName = FCT_DiscountAnalysis
              Module
              {
                Active                   = True
                DiscountModelDataModule  = ifw.DataPool.DiscountModelDataModule
                #Filter_SetModule         = ifw.Pipelines.TD_PREPAID_RATE.Functions.Processing.FunctionPool.Filter_Set 
                ModelSelectorDataModule  = ifw.DataPool.ModelSelectorDataModule

              } 
            }

        EdrDump_ApolloDiscountModuleDump
          {
            ModuleName = FCT_EdrDump
            Module
            {
              Active   = FALSE
              FileName = /cdrapp_prepaid/dump/ApolloDiscountModule.dump
            }
          }


            #--------------------------------------------------
            # Discounting
            #--------------------------------------------------
            ApolloDiscountModule
            {
              ModuleName = FCT_Discount
              Module
              {
                Active                   = True
                DiscountDataModule       = ifw.DataPool.DiscountModelDataModule
                BalanceDataModule        = ifw.DataPool.BalanceDataModule
                AccountDataModule        = ifw.DataPool.CustomerData
                CurrencyDataModule       = ifw.DataPool.CurrencyDataModule
                DiscountMoreThanPossible = False 
                BackOut                  = False 
                SupportBundleERA         = False
                IgnoreEDROnDeadlock      = False
		IgnoreEDROnDiscountError = False
		IgnoreEDROnLock          = False
              } 
            }
	    

            #--------------------------------------------------
            # Rounding (Discounting)
            #--------------------------------------------------
            Round_Discounting
            {
              ModuleName = FCT_Rounding
              Module
              {
                //Active             = TRUE
                Active             = FALSE
                CurrencyDataModule = ifw.DataPool.CurrencyDataModule
                Mode               = Discounting
              }
            }

            #--------------------------------------------------
            # ApplyBalance
            #--------------------------------------------------
            ApolloApplyBalanceModule
            {
              ModuleName = FCT_ApplyBalance
              Module
              {
                Active                       = TRUE
                DiscountDataModule           = ifw.DataPool.DiscountModelDataModule
                BalanceDataModule            = ifw.DataPool.BalanceDataModule
                DiscountFunctionalModule     = Functions.Processing.FunctionPool.ApolloDiscountModule
                PortalConfigDataModule       = ifw.DataPool.PortalConfigDataModule
                #NumberOfNotificationLimit   = 1000
                NotificationOutputDirectory = /cdrapp_prepaid/out/notifybalancebreach
                NotificationOutputPrefix    = balancebreach_
              }
            }


            #--------------------------------------------------
            # ItemAssign PlugIn
            #--------------------------------------------------
            FlexibleItemAssignment
            {
              ModuleName = FCT_ItemAssign
              Module
              {
                 Active     = TRUE
                 DataModule     = ifw.DataPool.ItemAssignDataModule
              }
            }

            #----------------------------------------------------------------
            # Add Infranet Billing Record (plugin version)
            #----------------------------------------------------------------
            AddInfranetBillingRecord
            {
              ModuleName = FCT_BillingRecord
              Module
              {
                Active = TRUE
                CurrencyType = R
                CurrencyDataModule = ifw.DataPool.CurrencyDataModule
                ItemAssignDataModule     = ifw.DataPool.ItemAssignDataModule
                AccountDataModule  = ifw.DataPool.CustomerData
                BalanceDataModule        = ifw.DataPool.BalanceDataModule
                PortalConfigDataModule   = ifw.DataPool.PortalConfigDataModule
              }
            }




	EdrDump_PreServiceOutput
          {
            ModuleName = FCT_EdrDump
            Module
            {
              Active   = FALSE
              FileName = /cdrapp_prepaid/dump/PreServiceOutput.dump
            }
          }

            #--------------------------------------------------
            # Split Output per ServiceCode
            #--------------------------------------------------              
            ServiceOutputPrepaidSplit
            {
              ModuleName = FCT_IRules
              Module
              {
                Active = TRUE
                Source = File
                Rules
                {
                }
                Descriptions
                {
                  ServiceCodeSplitPre = ./TD/iScript_custom/IRL_EventTypeSplittingPrepaid.irl
                }
              }
            }

            #--------------------------------------------------
            # Split Output per ObjectCacheType
            #--------------------------------------------------
            ObjectCacheTypeOutputSplit
            {
              ModuleName = FCT_IScript
              Module
              {
                Active = FALSE
                Source = File
                Scripts
                {
                  ObjectCacheTypeOutputSplit
                  {
                    FileName = ./iScriptLib/iScriptLib_Standard/ISC_ObjectCacheTypeOutputSplitter.isc
                  }
                }
              }
            }

            #--------------------------------------------------
            # Aggregation
            #--------------------------------------------------
            Aggregate
            {
              ModuleName = FCT_AggreGate
              Module
              {
               Active = False

                 ScenarioReaderDataModule = ifw.DataPool.ScenarioReader

                 Scenarios
                 {
                 }

                 ResultFile
                 {
                   TempSuffix = .tmp
                   DoneSuffix = .dat
                   WriteEmptyFile = FALSE
                 }

                 ControlFile
                 {
                   Suffix = .ctl
                   DataFilePath = TRUE
                 }
              }
            }  

            #--------------------------------------------------
            # Rejection
            #--------------------------------------------------
            Rejection
            {
              ModuleName = FCT_Reject
              Module
              {
                Active          = True 
                NotifyOnReject  = True 
                UseRejectStream = True 
                StreamMap 
                {
                  INF_IGNORE_ON_DISCOUNTACCOUNT_DEADLOCK = DiscountDeadlockOutput
                  INF_IGNORE_ON_DISCOUNT_ERROR           = DiscountErrorOutput
		  INF_IGNORE_ON_BALANCEGROUP_LOCK        = DiscountErrorOutput 
                }
		
		# This is required if FCT_CallAssembing module is being used.
		#CallAssemblingModule = ifw.Pipelines.TD_PREPAID_RATE.Functions.Processing.FunctionPool.CallAssembling
              }
            }

            #---------------------------
            # Suspense FCT
            #---------------------------
            Suspense
            {
              ModuleName  = FCT_Suspense
              Module
              {
                Active = True
                SuspenseCreateStream     = SuspenseCreateOutput
                SuspenseUpdateStream     = SuspenseUpdateOutput
                DataConnection           = ifw.DataPool.LoginInfranet
                LogTestResults           = False
                PipelineCategory         = RatingPipeline
                RecycleLog
                {
                } 
              }
            }

##----------------------------------------------------------------------
##         Deprecated because of the introduction of EDR Trace
##----------------------------------------------------------------------
##          EdrDump_Suspense_post
##          {
##            ModuleName = FCT_EdrDump
##            Module
##            {
##              Active   = False
##              FileName = /cdrapp_prepaid/dump/Suspense_post.dump
##            }
##          }
##----------------------------------------------------------------------
        EdrDump_ALLRATELastDump
          {
            ModuleName = FCT_EdrDump
            Module
            {
              Active   = FALSE
              FileName = /cdrapp_prepaid/dump/ALLRATELastDump.dump
            }
          }

          } #END FunctionPool
        }
      } # END Functions

      #--------------------------------------------------
      # Output Section
      #--------------------------------------------------
      Output
      {
        WriteDefaultEdr            = False

        MaxErrorRates
        {
	  INF_EDR_REJECTED = 100
          ERR_CUST_NOT_FOUND = 20
        }

        #-------------------------------------------
        # Multithreaded writing. This is recommended
        # when EDRs are associated with multiple
        # output streams.
        #------------------------------------------
        MultiThreading
        {
           Active = False      # Defaults to False
           NumberOfThreads = 1 # Number of threads spawned. Defaults to 1
           BatchSize = 0       # The number of EDRs cached before sent for writing. Defaults to 0
        }


        OutputCollection
        {
          #--------------------------------------------------------------------
          # The DevNull stream
          #--------------------------------------------------------------------
          DevNull
          {
            ModuleName = OUT_DevNull
            Module
            { 
            } 
          } # end of DevNull

          ##--------------------------------------------------------------------
          ## Output stream for duplicate events
          ##--------------------------------------------------------------------
          #DuplicateOutput
          #{
          #  ModuleName = OUT_Reject
          #  Module
          #  {
          #    DeleteEmptyStream = TRUE # defaults to TRUE 
          #    OutputStream
          #    {
          #      ModuleName = EXT_OutFileManager
          #      Module
          #      {
          #        OutputPath = /cdrapp_prepaid/reject
          #        OutputPrefix = test
          #        OutputSuffix = .dup
          #        TempPrefix   = tmp
          #        TempDataPath    = /cdrapp_prepaid/reject
          #        TempDataPrefix  = dup.tmp.
          #        TempDataSuffix  = .data
          #        Replace = TRUE
          #      }
          #    }
          #  } 
          #} # end of DuplicateOutput  #--------------------------------------------------------------------
          # Output stream for no balance events
          #--------------------------------------------------------------------
          DiscountErrorOutput
          {
            ModuleName = OUT_Reject
            Module
            {
              DeleteEmptyStream = TRUE # defaults to TRUE
	
              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/discountError
                  OutputPrefix = test
                  OutputSuffix = .dsc
                  TempPrefix   = tmp
                  TempDataPath    = /cdrapp_prepaid/discountError
                  TempDataPrefix  = dsc.tmp.
                  TempDataSuffix  = .data
                  Replace = TRUE
                }
              }
            }
          }        
          #--------------------------------------------------------------------
	  # Output stream for dead-locked events.
	  #--------------------------------------------------------------------
	  DiscountDeadlockOutput
	  {
	    ModuleName = OUT_Reject
	    Module
	    {
	      DeleteEmptyStream = TRUE # defaults to TRUE
	      OutputStream
	      {
	        ModuleName = EXT_OutFileManager
	        Module
	        {
		  OutputPath = /cdrapp_prepaid/discountError
		  OutputPrefix = test
		  OutputSuffix = .dlk
		  TempPrefix   = tmp
		  TempDataPath    = /cdrapp_prepaid/discountError
		  TempDataPrefix  = dlk.tmp.
		  TempDataSuffix  = .data
		  Replace = TRUE
		}
	      }
	    }
	  }  # end of DiscountDeadlockOutput
 
          #--------------------------------------------------------------------
          # The /service/gsm/telephony output stream
          #--------------------------------------------------------------------
          TELPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/voice

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
               
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/telephony
                  OutputPrefix = test_TEL
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/telephony
                  TempDataPrefix  = tel.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of TELOutput

          CONV_TELPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/voice
            ObjectCacheType = CONVERGENT

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc

              DeleteEmptyStream = True # defaults to TRUE
	      AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/telephony
                  OutputPrefix = test_CONV_TEL
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/telephony
                  TempDataPrefix  = CONV_tel.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of CONV_TELOutput

          SMSPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/sms

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True


              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/sms
                  OutputPrefix = test_SMS
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/sms
                  TempDataPrefix  = sms.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of SMSOutput

          CONV_SMSPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/sms
            ObjectCacheType = CONVERGENT

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/sms
                  OutputPrefix = test_CONV_SMS
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/sms
                  TempDataPrefix  = CONV_sms.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of CONV_SMSOutput

		 #--------------------------------------------------------------------
          # The /service/telco/gsm/mms output stream
          #--------------------------------------------------------------------
          MMSPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/mms

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/mms
                  OutputPrefix = test_MMS
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/mms
                  TempDataPrefix  = mms.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of MMSOutput

          CONV_MMSPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/mms
            ObjectCacheType = CONVERGENT

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/mms
                  OutputPrefix = test_CONV_MMS
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/mms
                  TempDataPrefix  = CONV_mms.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of CONV_MMSOutput
			#--------------------------------------------------------------------
          # The /service/telco/gsm/voicemail output stream
          #--------------------------------------------------------------------
          VOMPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/voicemail

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/voicemail
                  OutputPrefix = test_VOM
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/voicemail
                  TempDataPrefix  = vom.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of VOMOutput

          CONV_VOMPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/voicemail
            ObjectCacheType = CONVERGENT

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/voicemail
                  OutputPrefix = test_CONV_VOM
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/voicemail
                  TempDataPrefix  = CONV_vom.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of CONV_VOMOutput
		  
		  		#--------------------------------------------------------------------
          # The /service/telco/gsm/data output stream
          #--------------------------------------------------------------------
          DATPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/data

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/data
                  OutputPrefix = test_DAT
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/data
                  TempDataPrefix  = dat.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of DATOutput

          CONV_DATPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/data
            ObjectCacheType = CONVERGENT

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/data
                  OutputPrefix = test_CONV_DAT
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/data
                  TempDataPrefix  = CONV_dat.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of CONV_DATOutput
		  
		  #--------------------------------------------------------------------
          # The /service/telco/gsm/vas output stream
          #--------------------------------------------------------------------
          VASPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/vas

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/vas
                  OutputPrefix = test_VAS
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/vas
                  TempDataPrefix  = vas.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of VASOutput

          CONV_VASPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/vas
            ObjectCacheType = CONVERGENT

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/vas
                  OutputPrefix = test_CONV_VAS
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/vas
                  TempDataPrefix  = CONV_vas.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of CONV_VASOutput
		  
		 #--------------------------------------------------------------------
          # The /service/telco/gsm/valuepack output stream
          #--------------------------------------------------------------------
          VAPPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/valuepack

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/vap
                  OutputPrefix = test_VAP
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/vap
                  TempDataPrefix  = vap.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of VAPOutput

          CONV_VAPPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/valuepack
            ObjectCacheType = CONVERGENT

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/vap
                  OutputPrefix = test_CONV_VAP
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/vap
                  TempDataPrefix  = CONV_vap.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of CONV_VAPOutput
		  
          #--------------------------------------------------------------------
          # SuspenseCreateOutput stream
          #--------------------------------------------------------------------
          SuspenseCreateOutput
          {
            ModuleName = OUT_GenericStream
            EventType = /suspended_usage/telco/gsm
            Module
            {
              Grammar = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageCreationGrammar.dsc
              DeleteEmptyStream = True
		AddInvoiceData = True
              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/reject
                  OutputPrefix = suspense_create_
                  OutputSuffix = .out
                  TempPrefix = tmp
                  TempDataPath = /cdrapp_prepaid/reject
                  TempDataPrefix = susp.create.tmp.
                  TempDataSuffix = .data
                  Replace = True
                  AppendSequenceNumber = False
                }
              }
            }
          } # end of SuspenseCreateOutput

          #--------------------------------------------------------------------
          # SuspenseUpdateOutput stream
          #--------------------------------------------------------------------
          SuspenseUpdateOutput
          {
            ModuleName = OUT_GenericStream
            EventType = /tmp_suspended_usage

            Module
            {
              Grammar = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageUpdateGrammar.dsc
              DeleteEmptyStream = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/reject
                  OutputPrefix = suspense_update_
                  OutputSuffix = .out
                  TempPrefix = tmp
                  TempDataPath = /cdrapp_prepaid/reject
                  TempDataPrefix = susp.update.tmp.
                  TempDataSuffix = .data
                  Replace = True
                  AppendSequenceNumber = False
                }
              }
            }
          } # end of SuspenseUpdateOutput
        } # end of OutputCollection

        OutputLog
        {
          FilePath        = /var/portal/ifw/log/stream
          FileName        = stream
          FilePrefix      = Stream_
          FileSuffix      = .log

          SuppressErrors
          {
            ERR_SPEC_VERSION_INVALID
            ERR_RELEASE_VERSION_INVALID
         WRN_NO_GLID 
	 }
        }
        
        SequenceGeneration = Unit

	#-------------------------------
        EdrTraceEnabled = FALSE
        EdrTrace
        {
            TraceLog
            {
                 FilePath   = /var/portal/ifw/log/edrLog
                 FileName   = edrTraceLog
                 FilePrefix = log_
                 FileSuffix = .log
            }

            TraceStartPoint =  Input
            TraceEndPoint   = Output

        } # END EdrTrace

        
      } # end of Output    
      
    } # END of TD_PREPAID_RATE

    #==========================================================
    # Added by GSM
    #==========================================================
    TD_PREPAID_RATE_TEL
    {
      Active                      = TRUE
      
      CountryCode                 = 64 
      MobileCountryCode           = 64
      NationalAccessCode          = 0
      #InternationalAccessCode     = 00
      #InternationalAccessCodeSign = +
      NetworkDestinationCode      = 172
      RejectStream                = SuspenseCreateOutput
      
      TransactionManager
      {
        RedoEnabled = True #False
        SingleTransaction = False
        WriteToLogEnabled = True
        BinaryLogFileName = ./tam/binaryLogFileTD_PREPAID_RATE_TEL.dat
      }
      
      EdrFactory 
      { 
        DataConnection = ifw.DataPool.Login 
        Description =  ./TD/formatDesc/Portal/td_containerDesc.dsc
        UsageStatistic = /var/portal/ifw/log/statistic/edrStatisticTD_PREPAID_RATE_TEL.txt 
        EdrVersionDataConnection = ifw.DataPool.LoginInfranet
      }

      DataDescription
      {
        Standard
        {
          ModuleName = Standard
          Module
          {
            StreamFormats
            {
	      SOL42_FORINPUT = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_RATE_FORINPUT.dsc
              EVENT_LOADER = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_Format.dsc
              SUSPENSE_CREATE_OUTPUT = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageCreation.dsc
              SUSPENSE_UPDATE_OUTPUT = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageUpdate.dsc
            }

            InputMapping
            {
              SOL42_FORINPUT = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_RATE_InMap.dsc
            }

            OutputMapping
            {
              EVENT_LOADER = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutMap.dsc
              SUSPENSE_CREATE_OUTPUT = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageCreationMapping.dsc
              SUSPENSE_UPDATE_OUTPUT = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageUpdateMapping.dsc
            }
          }
        }
      } # end of DataDescription

      PipelineLog 
      { 
        ModuleName = LOG
        Module 
        { 
          ITO 
          { 
            WriteMessageKey  = True
            FilePath = /var/portal/ifw/log/pipeline
            FileName = pipeline_TD_PREPAID_RATE_TEL.log
            ProcessName = ifw
            MessageGroup = IFW
            ShowOriginator = TRUE
	    # Added by GSM
            #LogLevel = warning
            LogLevel = major
          }

          Buffer 
          { 
            #Size = 500
            #Updated by GSM
	    Size = 1000
          } 
        } 
      } # end of PipelineLog


      InputBuffer
      {
        BlockTransfer = False
        #Size = 1
        #BlockSize = 1
	#Updated by GSM
        Size = 100
        BlockSize = 100
      }

      OutputBuffer
      {
        BlockTransfer = False
        #Size = 1
        #BlockSize = 1
        #Updated by GSM
	Size = 100
        BlockSize = 100
      }
      
      #------------------------------------------------------------------------
      # Input section
      #------------------------------------------------------------------------
      Input
      {
        #UnitsPerTransaction = 1
        UnitsPerTransaction = 2

        InputModule
        {
          ModuleName  = INP_GenericStream
          Module
          {
            Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_RATE_InGrammar.dsc
            DefaultOutput = TELPREOutput

            InputStream
            {
              ModuleName = EXT_InFileManager
              Module
              {
                InputDirEmptyTimeout = 10

                InputPath   = /cdrapp_prepaid/edr/telephony
                InputPrefix = TD_RATE_PRE
                InputSuffix = .edr
 
                DonePath    = /cdrapp_prepaid/done
                DonePrefix  = test_ALLRATE
                DoneSuffix  = .done
           
                ErrorPath   = /cdrapp_prepaid/error
                ErrorPrefix = test_ALLRATE
                ErrorSuffix = .err

                TempPrefix  = tmp_ALLRATE
  
                Replace     = TRUE
              }
            } # end of InputStream
          }
        } # end of InputModule
      } # end of Input

      
      #------------------------------------------------------------------------
      # Function section
      #------------------------------------------------------------------------
      Functions 
      {
        Processing
        {
          FunctionPool
          {

            #---------------------------------------------------
            # PreSuspense FCT
            #---------------------------------------------------
            PreSuspense
            {
              ModuleName = FCT_PreSuspense
              Module
              {
                Active = True
			QueryableFields
			{

				SUSP_USAGE_TELCO_INFO_T
				{
					# format : <database_column_name> = <edr_conatiner_field_name>
					START_TIME = DETAIL.CHARGING_START_TIMESTAMP
					CALL_DURATION = DETAIL.DURATION
					CALLING_FROM = DETAIL.A_NUMBER
					CALLED_TO = DETAIL.B_NUMBER
                                        SERVICE_TYPE = DETAIL.BASIC_SERVICE
                                        USAGE_TYPE = DETAIL.USAGE_TYPE
				}
                     		SUSP_USAGE_TELCO_GSM_INFO_T
                     		{
                        		CELL_ID = DETAIL.ASS_GSMW_EXT.CELL_ID
                         		DESTINATION_SID = DETAIL.ASS_GSMW_EXT.TERMINATING_SWITCH_IDENTIFICATION
                        		DIALED_NUMBER = DETAIL.ASS_GSMW_EXT.DIALED_DIGITS
                        		ORIGIN_SID = DETAIL.ASS_GSMW_EXT.ORIGINATING_SWITCH_IDENTIFICATION 
                                     	SECONDARY_MSID = DETAIL.ASS_GSMW_EXT.PORT_NUMBER
                     		}
			}
              }
            }

            #--------------------------------------------------
            # Service Code Mapping
            #--------------------------------------------------
            ServiceCodeMap 
            { 
              ModuleName = FCT_ServiceCodeMap
              Module 
              { 
                Active             = TRUE
                DataConnection     = ifw.DataPool.Login
                MapGroup           = ALL_RATE
              } 
            } 

            #--------------------------------------------------
            # Usage Class Mapping
            #--------------------------------------------------
            UsageClassMap
            {
              ModuleName = FCT_UsageClassMap 
              Module 
              { 
                Active              = TRUE
                DataConnection      = ifw.DataPool.Login
                OverwriteUsageClass = False 
                MapGroup            = ALL_RATE
                #OptimizeFor        = Memory
              } 
            }


            #--------------------------------------------------
            # Discarding (of events)
            #--------------------------------------------------
            EventDiscarding
            {
              ModuleName = FCT_Discard
              Module
              {
                Active = TRUE
                DataConnection = ifw.DataPool.Login
                Function       = Discard
                StreamName     = DevNull
              }
            }


            #--------------------------------------------------
            # Infranet Customer
            #--------------------------------------------------
            CustomerSearch 
            { 
              ModuleName = FCT_Account
              Module 
              { 
                Active         = TRUE
                DataModule     = ifw.DataPool.CustomerData
                #DisableRatingProductCheck  = False
              }
            } 

	#---------------------------------------------------------
            # UpdateGLID - updates GLID field
            #---------------------------------------------------------
            ItemAssign
            {
              ModuleName = FCT_IScript
              Module
              {
                Active = True
                Source = File
                Scripts
                {
                  ItemAssign
                  {
                        FileName = ./TD/iScript_custom/ISC_TD_ItemTag.isc
                  }
                }
              }
            }

            #--------------------------------------------------
            # Customer Individual Rating
            #--------------------------------------------------
            CustomerRating
            { 
              ModuleName = FCT_CustomerRating 
              Module 
              { 
                Active            = TRUE
                Mode              = CUSTOMER 
                DataConnection    = ifw.DataPool.Login 
                DefaultRateplan   = Standard
                LeastCostRating   = False
                PromotionalSaving = False
              } 
            }

 
            #--------------------------------------------------
            # Pre-Rating (Zoning)
            #--------------------------------------------------
            PreRatingZone
            {
              ModuleName = FCT_PreRating
              Module
              {
                Active = True
                RateplanDataModule = ifw.DataPool.RateplanDataModule
                ZoneDataModule = ifw.DataPool.ZoneDataModule
              }
            }

	##----------------------------------------------------------------------

            # Main Rating (Pricing)
            #--------------------------------------------------
            MainRating
            {
              ModuleName = FCT_MainRating
              Module
              {
                Active                  = TRUE
                RateplanDataModule      = ifw.DataPool.RateplanDataModule
                CalendarDataModule      = ifw.DataPool.CalendarDataModule
                TimeDataModule          = ifw.DataPool.TimeDataModule
                PriceDataModule         = ifw.DataPool.PriceDataModule
                CurrencyDataModule      = ifw.DataPool.CurrencyDataModule
                ModelSelectorDataModule = ifw.DataPool.ModelSelectorDataModule
              }
            }
 	
            #--------------------------------------------------
            # Discount Analysis
            #--------------------------------------------------
            DiscountAnalysisModule
            {
              ModuleName = FCT_DiscountAnalysis
              Module
              {
                Active                   = TRUE
                #Active                   = FALSE
                DiscountModelDataModule  = ifw.DataPool.DiscountModelDataModule
                #Filter_SetModule         = ifw.Pipelines.TD_PREPAID_RATE_TEL.Functions.Processing.FunctionPool.Filter_Set 
                ModelSelectorDataModule  = ifw.DataPool.ModelSelectorDataModule

              } 
            }


            #--------------------------------------------------
            # Discounting
            #--------------------------------------------------
            ApolloDiscountModule
            {
              ModuleName = FCT_Discount
              Module
              {
                Active                   = TRUE
                #Active                   = FALSE
                DiscountDataModule       = ifw.DataPool.DiscountModelDataModule
                BalanceDataModule        = ifw.DataPool.BalanceDataModule
                AccountDataModule        = ifw.DataPool.CustomerData
                CurrencyDataModule       = ifw.DataPool.CurrencyDataModule
                DiscountMoreThanPossible = False 
                BackOut                  = False 
                SupportBundleERA         = False
                IgnoreEDROnDeadlock      = False
		IgnoreEDROnDiscountError = False
		IgnoreEDROnLock          = False
              } 
            }
	    

            #--------------------------------------------------
            # ApplyBalance
            #--------------------------------------------------
            ApolloApplyBalanceModule
            {
              ModuleName = FCT_ApplyBalance
              Module
              {
                Active                       = TRUE
                DiscountDataModule           = ifw.DataPool.DiscountModelDataModule
                BalanceDataModule            = ifw.DataPool.BalanceDataModule
                DiscountFunctionalModule     = Functions.Processing.FunctionPool.ApolloDiscountModule
                PortalConfigDataModule       = ifw.DataPool.PortalConfigDataModule
                #NumberOfNotificationLimit   = 1000
                NotificationOutputDirectory = /cdrapp_prepaid/out/notifybalancebreach
                NotificationOutputPrefix    = balancebreach_
              }
            }


            #--------------------------------------------------
            # ItemAssign PlugIn
            #--------------------------------------------------
            FlexibleItemAssignment
            {
              ModuleName = FCT_ItemAssign
              Module
              {
                 Active     = TRUE
                 DataModule     = ifw.DataPool.ItemAssignDataModule
              }
            }

            #----------------------------------------------------------------
            # Add Infranet Billing Record (plugin version)
            #----------------------------------------------------------------
            AddInfranetBillingRecord
            {
              ModuleName = FCT_BillingRecord
              Module
              {
                Active = TRUE
                CurrencyType = R
                CurrencyDataModule = ifw.DataPool.CurrencyDataModule
                ItemAssignDataModule     = ifw.DataPool.ItemAssignDataModule
                AccountDataModule  = ifw.DataPool.CustomerData
                BalanceDataModule        = ifw.DataPool.BalanceDataModule
                PortalConfigDataModule   = ifw.DataPool.PortalConfigDataModule
              }
            }

            #--------------------------------------------------
            # Split Output per ServiceCode
            #--------------------------------------------------              
            ServiceOutputPostpaidSplit
            {
              ModuleName = FCT_IRules
              Module
              {
                Active = TRUE
                Source = File
                Rules
                {
                }
                Descriptions
                {
                  ServiceCodeSplitPost = ./TD/iScript_custom/IRL_EventTypeSplittingPrepaid.irl
                }
              }
            }

            #--------------------------------------------------
            # Rejection
            #--------------------------------------------------
            Rejection
            {
              ModuleName = FCT_Reject
              Module
              {
                Active          = True 
                NotifyOnReject  = True 
                UseRejectStream = True 
                StreamMap 
                {
                  INF_IGNORE_ON_DISCOUNTACCOUNT_DEADLOCK = DiscountDeadlockOutput
                  INF_IGNORE_ON_DISCOUNT_ERROR           = DiscountErrorOutput
		  INF_IGNORE_ON_BALANCEGROUP_LOCK        = DiscountErrorOutput 
                }
		
		# This is required if FCT_CallAssembing module is being used.
		#CallAssemblingModule = ifw.Pipelines.TD_PREPAID_RATE_TEL.Functions.Processing.FunctionPool.CallAssembling
              }
            }

            #---------------------------
            # Suspense FCT
            #---------------------------
            Suspense
            {
              ModuleName  = FCT_Suspense
              Module
              {
                Active = True
                SuspenseCreateStream     = SuspenseCreateOutput
                SuspenseUpdateStream     = SuspenseUpdateOutput
                DataConnection           = ifw.DataPool.LoginInfranet
                LogTestResults           = False
                PipelineCategory         = RatingPipeline
                RecycleLog
                {
                } 
              }
            }


          } #END FunctionPool
        }
      } # END Functions

      #--------------------------------------------------
      # Output Section
      #--------------------------------------------------
      Output
      {
        WriteDefaultEdr            = False

        MaxErrorRates
        {
          INF_EDR_REJECTED = 100
          ERR_CUST_NOT_FOUND = 20
        }

        #-------------------------------------------
        # Multithreaded writing. This is recommended
        # when EDRs are associated with multiple
        # output streams.
        #------------------------------------------
        MultiThreading
        {
           Active = False      # Defaults to False
           NumberOfThreads = 1 # Number of threads spawned. Defaults to 1
           #Active = True      
           #NumberOfThreads = 7 
           BatchSize = 0       # The number of EDRs cached before sent for writing. Defaults to 0
        }


        OutputCollection
        {
          #--------------------------------------------------------------------
          # The DevNull stream
          #--------------------------------------------------------------------
          DevNull
          {
            ModuleName = OUT_DevNull
            Module
            { 
            } 
          } # end of DevNull

          ##--------------------------------------------------------------------
          ## Output stream for duplicate events
          ##--------------------------------------------------------------------
          #DuplicateOutput
          #{
          #  ModuleName = OUT_Reject
          #  Module
          #  {
          #    DeleteEmptyStream = TRUE # defaults to TRUE 
          #    OutputStream
          #    {
          #      ModuleName = EXT_OutFileManager
          #      Module
          #      {
          #        OutputPath = /cdrapp_prepaid/reject
          #        OutputPrefix = test
          #        OutputSuffix = .dup
          #        TempPrefix   = tmp
          #        TempDataPath    = /cdrapp_prepaid/reject
          #        TempDataPrefix  = dup.tmp.
          #        TempDataSuffix  = .data
          #        Replace = TRUE
          #      }
          #    }
          #  } 
          #} # end of DuplicateOutput  
	  
	  #--------------------------------------------------------------------
          # Output stream for no balance events
          #--------------------------------------------------------------------
          DiscountErrorOutput
          {
            ModuleName = OUT_Reject
            Module
            {
              DeleteEmptyStream = TRUE # defaults to TRUE
	
              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/discountError
                  OutputPrefix = test
                  OutputSuffix = .dsc
                  TempPrefix   = tmp
                  TempDataPath    = /cdrapp_prepaid/discountError
                  TempDataPrefix  = dsc.tmp.
                  TempDataSuffix  = .data
                  Replace = TRUE
                }
              }
            }
          }        
          #--------------------------------------------------------------------
	  # Output stream for dead-locked events.
	  #--------------------------------------------------------------------
	  DiscountDeadlockOutput
	  {
	    ModuleName = OUT_Reject
	    Module
	    {
	      DeleteEmptyStream = TRUE # defaults to TRUE
	      OutputStream
	      {
	        ModuleName = EXT_OutFileManager
	        Module
	        {
		  OutputPath = /cdrapp_prepaid/discountError
		  OutputPrefix = test
		  OutputSuffix = .dlk
		  TempPrefix   = tmp
		  TempDataPath    = /cdrapp_prepaid/discountError
		  TempDataPrefix  = dlk.tmp.
		  TempDataSuffix  = .data
		  Replace = TRUE
		}
	      }
	    }
	  }  # end of DiscountDeadlockOutput
 
          #--------------------------------------------------------------------
          # The /service/gsm/telephony output stream
          #--------------------------------------------------------------------
          TELPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/voice

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
               
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/telephony
                  OutputPrefix = test_TEL
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/telephony
                  TempDataPrefix  = tel.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of TELOutput

          CONV_TELPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/voice
            ObjectCacheType = CONVERGENT

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc

              DeleteEmptyStream = True # defaults to TRUE
	      AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/telephony
                  OutputPrefix = test_CONV_TEL
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/telephony
                  TempDataPrefix  = CONV_tel.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of CONV_TELOutput

          SMSPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/sms

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True


              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/sms
                  OutputPrefix = test_SMS
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/sms
                  TempDataPrefix  = sms.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of SMSOutput

          CONV_SMSPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/sms
            ObjectCacheType = CONVERGENT

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/sms
                  OutputPrefix = test_CONV_SMS
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/sms
                  TempDataPrefix  = CONV_sms.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of CONV_SMSOutput

		 #--------------------------------------------------------------------
          # The /service/telco/gsm/mms output stream
          #--------------------------------------------------------------------
          MMSPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/mms

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/mms
                  OutputPrefix = test_MMS
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/mms
                  TempDataPrefix  = mms.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of MMSOutput

          CONV_MMSPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/mms
            ObjectCacheType = CONVERGENT

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/mms
                  OutputPrefix = test_CONV_MMS
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/mms
                  TempDataPrefix  = CONV_mms.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of CONV_MMSOutput
	
	#--------------------------------------------------------------------
          # The /service/telco/gsm/voicemail output stream
          #--------------------------------------------------------------------
          VOMPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/voicemail

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/voicemail
                  OutputPrefix = test_VOM
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/voicemail
                  TempDataPrefix  = vom.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of VOMOutput

          CONV_VOMPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/voicemail
            ObjectCacheType = CONVERGENT

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/voicemail
                  OutputPrefix = test_CONV_VOM
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/voicemail
                  TempDataPrefix  = CONV_vom.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of CONV_VOMOutput
		  
	  #--------------------------------------------------------------------
          # The /service/telco/gsm/data output stream
          #--------------------------------------------------------------------
          DATPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/data

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/data
                  OutputPrefix = test_DAT
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/data
                  TempDataPrefix  = dat.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of DATOutput

          CONV_DATPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/data
            ObjectCacheType = CONVERGENT

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/data
                  OutputPrefix = test_CONV_DAT
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/data
                  TempDataPrefix  = CONV_dat.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of CONV_DATOutput
		  
	 #--------------------------------------------------------------------
          # The /service/telco/gsm/vas output stream
          #--------------------------------------------------------------------
          VASPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/vas

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/vas
                  OutputPrefix = test_VAS
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/vas
                  TempDataPrefix  = vas.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of VASOutput

          CONV_VASPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/vas
            ObjectCacheType = CONVERGENT

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/vas
                  OutputPrefix = test_CONV_VAS
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/vas
                  TempDataPrefix  = CONV_vas.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of CONV_VASOutput
		  
		 #--------------------------------------------------------------------
          # The /service/telco/gsm/valuepack output stream
          #--------------------------------------------------------------------
          VAPPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/valuepack

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/vap
                  OutputPrefix = test_VAP
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/vap
                  TempDataPrefix  = vap.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of VAPOutput

          CONV_VAPPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/valuepack
            ObjectCacheType = CONVERGENT

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/vap
                  OutputPrefix = test_CONV_VAP
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/vap
                  TempDataPrefix  = CONV_vap.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of CONV_VAPOutput
		  
          #--------------------------------------------------------------------
          # SuspenseCreateOutput stream
          #--------------------------------------------------------------------
          SuspenseCreateOutput
          {
            ModuleName = OUT_GenericStream
            EventType = /suspended_usage/telco/gsm
            Module
            {
              Grammar = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageCreationGrammar.dsc
              DeleteEmptyStream = True
		AddInvoiceData = True
              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/reject
                  OutputPrefix = suspense_create_
                  OutputSuffix = .out
                  TempPrefix = tmp
                  TempDataPath = /cdrapp_prepaid/reject
                  TempDataPrefix = susp.create.tmp.
                  TempDataSuffix = .data
                  Replace = True
                  AppendSequenceNumber = False
                }
              }
            }
          } # end of SuspenseCreateOutput

          #--------------------------------------------------------------------
          # SuspenseUpdateOutput stream
          #--------------------------------------------------------------------
          SuspenseUpdateOutput
          {
            ModuleName = OUT_GenericStream
            EventType = /tmp_suspended_usage

            Module
            {
              Grammar = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageUpdateGrammar.dsc
              DeleteEmptyStream = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/reject
                  OutputPrefix = suspense_update_
                  OutputSuffix = .out
                  TempPrefix = tmp
                  TempDataPath = /cdrapp_prepaid/reject
                  TempDataPrefix = susp.update.tmp.
                  TempDataSuffix = .data
                  Replace = True
                  AppendSequenceNumber = False
                }
              }
            }
          } # end of SuspenseUpdateOutput
          
        } # end of OutputCollection

        OutputLog
        {
          FilePath        = /var/portal/ifw/log/stream
          FileName        = stream
          FilePrefix      = Stream_
          FileSuffix      = .log
		
	  # Added by GSM
           #LogLevel = warning
           LogLevel = major

          SuppressErrors
          {
            ERR_SPEC_VERSION_INVALID
            ERR_RELEASE_VERSION_INVALID
         WRN_NO_GLID 
	 }
        }
        
        #SequenceGeneration = Unit
        SequenceGeneration = Transaction

	#-------------------------------
        EdrTraceEnabled = FALSE
        EdrTrace
        {
            TraceLog
            {
                 FilePath   = /var/portal/ifw/log/edrLog
                 FileName   = edrTraceLog
                 FilePrefix = log_
                 FileSuffix = .log
            }

            TraceStartPoint =  Input
            TraceEndPoint   = Output

        } # END EdrTrace

        
      } # end of Output    
      
    } # end of Pipeline TD_PREPAID_RATE_TEL


    TD_PREPAID_RATE_DATA
    {
      Active                      = TRUE
      
      CountryCode                 = 64 
      MobileCountryCode           = 64
      NationalAccessCode          = 0
      #InternationalAccessCode     = 00
      #InternationalAccessCodeSign = +
      NetworkDestinationCode      = 172
      RejectStream                = SuspenseCreateOutput
      
      TransactionManager
      {
        RedoEnabled = True #False
        SingleTransaction = False
        WriteToLogEnabled = True
        BinaryLogFileName = ./tam/binaryLogFileTD_PREPAID_RATE_DATA.dat
      }
      
      EdrFactory 
      { 
        DataConnection = ifw.DataPool.Login 
        Description =  ./TD/formatDesc/Portal/td_containerDesc.dsc
        UsageStatistic = /var/portal/ifw/log/statistic/edrStatisticTD_PREPAID_RATE_DATA.txt 
        EdrVersionDataConnection = ifw.DataPool.LoginInfranet
      }

      DataDescription
      {
        Standard
        {
          ModuleName = Standard
          Module
          {
            StreamFormats
            {
	      SOL42_FORINPUT = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_RATE_FORINPUT.dsc
              EVENT_LOADER = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_Format.dsc
              SUSPENSE_CREATE_OUTPUT = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageCreation.dsc
              SUSPENSE_UPDATE_OUTPUT = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageUpdate.dsc
            }

            InputMapping
            {
              SOL42_FORINPUT = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_RATE_InMap.dsc
            }

            OutputMapping
            {
              EVENT_LOADER = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutMap.dsc
              SUSPENSE_CREATE_OUTPUT = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageCreationMapping.dsc
              SUSPENSE_UPDATE_OUTPUT = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageUpdateMapping.dsc
            }
          }
        }
      } # end of DataDescription

      PipelineLog 
      { 
        ModuleName = LOG
        Module 
        { 
          ITO 
          { 
            WriteMessageKey  = True
            FilePath = /var/portal/ifw/log/pipeline
            FileName = pipeline_TD_PREPAID_RATE_DATA.log
            ProcessName = ifw
            MessageGroup = IFW
            ShowOriginator = TRUE
	    # Added by GSM
            #LogLevel = warning
            LogLevel = major
          }

          Buffer 
          { 
            #Size = 500
            #Updated by GSM
	    Size = 1000
          } 
        } 
      } # end of PipelineLog


      InputBuffer
      {
        BlockTransfer = False
        #Size = 1
        #BlockSize = 1
	#Updated by GSM
        Size = 100
        BlockSize = 100
      }

      OutputBuffer
      {
        BlockTransfer = False
        #Size = 1
        #BlockSize = 1
        #Updated by GSM
	Size = 100
        BlockSize = 100
      }
      
      #------------------------------------------------------------------------
      # Input section
      #------------------------------------------------------------------------
      Input
      {
        #UnitsPerTransaction = 1
        UnitsPerTransaction = 2

        InputModule
        {
          ModuleName  = INP_GenericStream
          Module
          {
            Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_RATE_InGrammar.dsc
            DefaultOutput = DATPREOutput

            InputStream
            {
              ModuleName = EXT_InFileManager
              Module
              {
                InputDirEmptyTimeout = 10

                InputPath   = /cdrapp_prepaid/edr/data
                InputPrefix = TD_RATE_PRE
                InputSuffix = .edr
 
                DonePath    = /cdrapp_prepaid/done
                DonePrefix  = test_ALLRATE
                DoneSuffix  = .done
           
                ErrorPath   = /cdrapp_prepaid/error
                ErrorPrefix = test_ALLRATE
                ErrorSuffix = .err

                TempPrefix  = tmp_ALLRATE
  
                Replace     = TRUE
              }
            } # end of InputStream
          }
        } # end of InputModule
      } # end of Input

      
      #------------------------------------------------------------------------
      # Function section
      #------------------------------------------------------------------------
      Functions 
      {
        Processing
        {
          FunctionPool
          {

            #---------------------------------------------------
            # PreSuspense FCT
            #---------------------------------------------------
            PreSuspense
            {
              ModuleName = FCT_PreSuspense
              Module
              {
                Active = True
			QueryableFields
			{

				SUSP_USAGE_TELCO_INFO_T
				{
					# format : <database_column_name> = <edr_conatiner_field_name>
					START_TIME = DETAIL.CHARGING_START_TIMESTAMP
					CALL_DURATION = DETAIL.DURATION
					CALLING_FROM = DETAIL.A_NUMBER
					CALLED_TO = DETAIL.B_NUMBER
                                        SERVICE_TYPE = DETAIL.BASIC_SERVICE
                                        USAGE_TYPE = DETAIL.USAGE_TYPE
				}
                     		SUSP_USAGE_TELCO_GSM_INFO_T
                     		{
                        		CELL_ID = DETAIL.ASS_GSMW_EXT.CELL_ID
                         		DESTINATION_SID = DETAIL.ASS_GSMW_EXT.TERMINATING_SWITCH_IDENTIFICATION
                        		DIALED_NUMBER = DETAIL.ASS_GSMW_EXT.DIALED_DIGITS
                        		ORIGIN_SID = DETAIL.ASS_GSMW_EXT.ORIGINATING_SWITCH_IDENTIFICATION 
                                     	SECONDARY_MSID = DETAIL.ASS_GSMW_EXT.PORT_NUMBER
                     		}
			}
              }
            }

            #--------------------------------------------------
            # Service Code Mapping
            #--------------------------------------------------
            ServiceCodeMap 
            { 
              ModuleName = FCT_ServiceCodeMap
              Module 
              { 
                Active             = TRUE
                DataConnection     = ifw.DataPool.Login
                MapGroup           = ALL_RATE
              } 
            } 

            #--------------------------------------------------
            # Usage Class Mapping
            #--------------------------------------------------
            UsageClassMap
            {
              ModuleName = FCT_UsageClassMap 
              Module 
              { 
                Active              = TRUE
                DataConnection      = ifw.DataPool.Login
                OverwriteUsageClass = False 
                MapGroup            = ALL_RATE
                #OptimizeFor        = Memory
              } 
            }


            #--------------------------------------------------
            # Discarding (of events)
            #--------------------------------------------------
            EventDiscarding
            {
              ModuleName = FCT_Discard
              Module
              {
                Active = TRUE
                DataConnection = ifw.DataPool.Login
                Function       = Discard
                StreamName     = DevNull
              }
            }


            #--------------------------------------------------
            # Infranet Customer
            #--------------------------------------------------
            CustomerSearch 
            { 
              ModuleName = FCT_Account
              Module 
              { 
                Active         = TRUE
                DataModule     = ifw.DataPool.CustomerData
                #DisableRatingProductCheck  = False
              }
            } 

	#---------------------------------------------------------
            # UpdateGLID - updates GLID field
            #---------------------------------------------------------
            ItemAssign
            {
              ModuleName = FCT_IScript
              Module
              {
                Active = True
                Source = File
                Scripts
                {
                  ItemAssign
                  {
                        FileName = ./TD/iScript_custom/ISC_TD_ItemTag.isc
                  }
                }
              }
            }

            #--------------------------------------------------
            # Customer Individual Rating
            #--------------------------------------------------
            CustomerRating
            { 
              ModuleName = FCT_CustomerRating 
              Module 
              { 
                Active            = TRUE
                Mode              = CUSTOMER 
                DataConnection    = ifw.DataPool.Login 
                DefaultRateplan   = Standard
                LeastCostRating   = False
                PromotionalSaving = False
              } 
            }

 
            #--------------------------------------------------
            # Pre-Rating (Zoning)
            #--------------------------------------------------
            PreRatingZone
            {
              ModuleName = FCT_PreRating
              Module
              {
                Active = True
                RateplanDataModule = ifw.DataPool.RateplanDataModule
                ZoneDataModule = ifw.DataPool.ZoneDataModule
              }
            }

	##----------------------------------------------------------------------

            # Main Rating (Pricing)
            #--------------------------------------------------
            MainRating
            {
              ModuleName = FCT_MainRating
              Module
              {
                Active                  = TRUE
                RateplanDataModule      = ifw.DataPool.RateplanDataModule
                CalendarDataModule      = ifw.DataPool.CalendarDataModule
                TimeDataModule          = ifw.DataPool.TimeDataModule
                PriceDataModule         = ifw.DataPool.PriceDataModule
                CurrencyDataModule      = ifw.DataPool.CurrencyDataModule
                ModelSelectorDataModule = ifw.DataPool.ModelSelectorDataModule
              }
            }
 	
            #--------------------------------------------------
            # Discount Analysis
            #--------------------------------------------------
            DiscountAnalysisModule
            {
              ModuleName = FCT_DiscountAnalysis
              Module
              {
                Active                   = TRUE
                #Active                   = FALSE
                DiscountModelDataModule  = ifw.DataPool.DiscountModelDataModule
                #Filter_SetModule         = ifw.Pipelines.TD_PREPAID_RATE_DATA.Functions.Processing.FunctionPool.Filter_Set 
                ModelSelectorDataModule  = ifw.DataPool.ModelSelectorDataModule

              } 
            }


            #--------------------------------------------------
            # Discounting
            #--------------------------------------------------
            ApolloDiscountModule
            {
              ModuleName = FCT_Discount
              Module
              {
                Active                   = TRUE
                #Active                   = FALSE
                DiscountDataModule       = ifw.DataPool.DiscountModelDataModule
                BalanceDataModule        = ifw.DataPool.BalanceDataModule
                AccountDataModule        = ifw.DataPool.CustomerData
                CurrencyDataModule       = ifw.DataPool.CurrencyDataModule
                DiscountMoreThanPossible = False 
                BackOut                  = False 
                SupportBundleERA         = False
                IgnoreEDROnDeadlock      = False
		IgnoreEDROnDiscountError = False
		IgnoreEDROnLock          = False
              } 
            }
	    

            #--------------------------------------------------
            # ApplyBalance
            #--------------------------------------------------
            ApolloApplyBalanceModule
            {
              ModuleName = FCT_ApplyBalance
              Module
              {
                Active                       = TRUE
                DiscountDataModule           = ifw.DataPool.DiscountModelDataModule
                BalanceDataModule            = ifw.DataPool.BalanceDataModule
                DiscountFunctionalModule     = Functions.Processing.FunctionPool.ApolloDiscountModule
                PortalConfigDataModule       = ifw.DataPool.PortalConfigDataModule
                #NumberOfNotificationLimit   = 1000
                NotificationOutputDirectory = /cdrapp_prepaid/out/notifybalancebreach
                NotificationOutputPrefix    = balancebreach_
              }
            }


            #--------------------------------------------------
            # ItemAssign PlugIn
            #--------------------------------------------------
            FlexibleItemAssignment
            {
              ModuleName = FCT_ItemAssign
              Module
              {
                 Active     = TRUE
                 DataModule     = ifw.DataPool.ItemAssignDataModule
              }
            }

            #----------------------------------------------------------------
            # Add Infranet Billing Record (plugin version)
            #----------------------------------------------------------------
            AddInfranetBillingRecord
            {
              ModuleName = FCT_BillingRecord
              Module
              {
                Active = TRUE
                CurrencyType = R
                CurrencyDataModule = ifw.DataPool.CurrencyDataModule
                ItemAssignDataModule     = ifw.DataPool.ItemAssignDataModule
                AccountDataModule  = ifw.DataPool.CustomerData
                BalanceDataModule        = ifw.DataPool.BalanceDataModule
                PortalConfigDataModule   = ifw.DataPool.PortalConfigDataModule
              }
            }

            #--------------------------------------------------
            # Split Output per ServiceCode
            #--------------------------------------------------              
            ServiceOutputPostpaidSplit
            {
              ModuleName = FCT_IRules
              Module
              {
                Active = TRUE
                Source = File
                Rules
                {
                }
                Descriptions
                {
                  ServiceCodeSplitPost = ./TD/iScript_custom/IRL_EventTypeSplittingPrepaid.irl
                }
              }
            }

            #--------------------------------------------------
            # Rejection
            #--------------------------------------------------
            Rejection
            {
              ModuleName = FCT_Reject
              Module
              {
                Active          = True 
                NotifyOnReject  = True 
                UseRejectStream = True 
                StreamMap 
                {
                  INF_IGNORE_ON_DISCOUNTACCOUNT_DEADLOCK = DiscountDeadlockOutput
                  INF_IGNORE_ON_DISCOUNT_ERROR           = DiscountErrorOutput
		  INF_IGNORE_ON_BALANCEGROUP_LOCK        = DiscountErrorOutput 
                }
		
		# This is required if FCT_CallAssembing module is being used.
		#CallAssemblingModule = ifw.Pipelines.TD_PREPAID_RATE_DATA.Functions.Processing.FunctionPool.CallAssembling
              }
            }

            #---------------------------
            # Suspense FCT
            #---------------------------
            Suspense
            {
              ModuleName  = FCT_Suspense
              Module
              {
                Active = True
                SuspenseCreateStream     = SuspenseCreateOutput
                SuspenseUpdateStream     = SuspenseUpdateOutput
                DataConnection           = ifw.DataPool.LoginInfranet
                LogTestResults           = False
                PipelineCategory         = RatingPipeline
                RecycleLog
                {
                } 
              }
            }


          } #END FunctionPool
        }
      } # END Functions

      #--------------------------------------------------
      # Output Section
      #--------------------------------------------------
      Output
      {
        WriteDefaultEdr            = False

        MaxErrorRates
        {
          INF_EDR_REJECTED = 100
          ERR_CUST_NOT_FOUND = 20
        }

        #-------------------------------------------
        # Multithreaded writing. This is recommended
        # when EDRs are associated with multiple
        # output streams.
        #------------------------------------------
        MultiThreading
        {
           Active = False      # Defaults to False
           NumberOfThreads = 1 # Number of threads spawned. Defaults to 1
           #Active = True      
           #NumberOfThreads = 7 
           BatchSize = 0       # The number of EDRs cached before sent for writing. Defaults to 0
        }


        OutputCollection
        {
          #--------------------------------------------------------------------
          # The DevNull stream
          #--------------------------------------------------------------------
          DevNull
          {
            ModuleName = OUT_DevNull
            Module
            { 
            } 
          } # end of DevNull

          ##--------------------------------------------------------------------
          ## Output stream for duplicate events
          ##--------------------------------------------------------------------
          #DuplicateOutput
          #{
          #  ModuleName = OUT_Reject
          #  Module
          #  {
          #    DeleteEmptyStream = TRUE # defaults to TRUE 
          #    OutputStream
          #    {
          #      ModuleName = EXT_OutFileManager
          #      Module
          #      {
          #        OutputPath = /cdrapp_prepaid/reject
          #        OutputPrefix = test
          #        OutputSuffix = .dup
          #        TempPrefix   = tmp
          #        TempDataPath    = /cdrapp_prepaid/reject
          #        TempDataPrefix  = dup.tmp.
          #        TempDataSuffix  = .data
          #        Replace = TRUE
          #      }
          #    }
          #  } 
          #} # end of DuplicateOutput  
	  
	  #--------------------------------------------------------------------
          # Output stream for no balance events
          #--------------------------------------------------------------------
          DiscountErrorOutput
          {
            ModuleName = OUT_Reject
            Module
            {
              DeleteEmptyStream = TRUE # defaults to TRUE
	
              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/discountError
                  OutputPrefix = test
                  OutputSuffix = .dsc
                  TempPrefix   = tmp
                  TempDataPath    = /cdrapp_prepaid/discountError
                  TempDataPrefix  = dsc.tmp.
                  TempDataSuffix  = .data
                  Replace = TRUE
                }
              }
            }
          }        
          #--------------------------------------------------------------------
	  # Output stream for dead-locked events.
	  #--------------------------------------------------------------------
	  DiscountDeadlockOutput
	  {
	    ModuleName = OUT_Reject
	    Module
	    {
	      DeleteEmptyStream = TRUE # defaults to TRUE
	      OutputStream
	      {
	        ModuleName = EXT_OutFileManager
	        Module
	        {
		  OutputPath = /cdrapp_prepaid/discountError
		  OutputPrefix = test
		  OutputSuffix = .dlk
		  TempPrefix   = tmp
		  TempDataPath    = /cdrapp_prepaid/discountError
		  TempDataPrefix  = dlk.tmp.
		  TempDataSuffix  = .data
		  Replace = TRUE
		}
	      }
	    }
	  }  # end of DiscountDeadlockOutput
 
          #--------------------------------------------------------------------
          # The /service/gsm/telephony output stream
          #--------------------------------------------------------------------
          TELPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/voice

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
               
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/telephony
                  OutputPrefix = test_TEL
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/telephony
                  TempDataPrefix  = tel.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of TELOutput

          CONV_TELPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/voice
            ObjectCacheType = CONVERGENT

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc

              DeleteEmptyStream = True # defaults to TRUE
	      AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/telephony
                  OutputPrefix = test_CONV_TEL
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/telephony
                  TempDataPrefix  = CONV_tel.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of CONV_TELOutput

          SMSPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/sms

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True


              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/sms
                  OutputPrefix = test_SMS
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/sms
                  TempDataPrefix  = sms.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of SMSOutput

          CONV_SMSPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/sms
            ObjectCacheType = CONVERGENT

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/sms
                  OutputPrefix = test_CONV_SMS
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/sms
                  TempDataPrefix  = CONV_sms.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of CONV_SMSOutput

		 #--------------------------------------------------------------------
          # The /service/telco/gsm/mms output stream
          #--------------------------------------------------------------------
          MMSPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/mms

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/mms
                  OutputPrefix = test_MMS
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/mms
                  TempDataPrefix  = mms.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of MMSOutput

          CONV_MMSPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/mms
            ObjectCacheType = CONVERGENT

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/mms
                  OutputPrefix = test_CONV_MMS
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/mms
                  TempDataPrefix  = CONV_mms.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of CONV_MMSOutput
	
	#--------------------------------------------------------------------
          # The /service/telco/gsm/voicemail output stream
          #--------------------------------------------------------------------
          VOMPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/voicemail

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/voicemail
                  OutputPrefix = test_VOM
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/voicemail
                  TempDataPrefix  = vom.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of VOMOutput

          CONV_VOMPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/voicemail
            ObjectCacheType = CONVERGENT

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/voicemail
                  OutputPrefix = test_CONV_VOM
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/voicemail
                  TempDataPrefix  = CONV_vom.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of CONV_VOMOutput
		  
	  #--------------------------------------------------------------------
          # The /service/telco/gsm/data output stream
          #--------------------------------------------------------------------
          DATPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/data

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/data
                  OutputPrefix = test_DAT
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/data
                  TempDataPrefix  = dat.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of DATOutput

          CONV_DATPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/data
            ObjectCacheType = CONVERGENT

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/data
                  OutputPrefix = test_CONV_DAT
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/data
                  TempDataPrefix  = CONV_dat.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of CONV_DATOutput
		  
	 #--------------------------------------------------------------------
          # The /service/telco/gsm/vas output stream
          #--------------------------------------------------------------------
          VASPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/vas

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/vas
                  OutputPrefix = test_VAS
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/vas
                  TempDataPrefix  = vas.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of VASOutput

          CONV_VASPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/vas
            ObjectCacheType = CONVERGENT

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/vas
                  OutputPrefix = test_CONV_VAS
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/vas
                  TempDataPrefix  = CONV_vas.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of CONV_VASOutput
		  
		 #--------------------------------------------------------------------
          # The /service/telco/gsm/valuepack output stream
          #--------------------------------------------------------------------
          VAPPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/valuepack

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/vap
                  OutputPrefix = test_VAP
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/vap
                  TempDataPrefix  = vap.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of VAPOutput

          CONV_VAPPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/valuepack
            ObjectCacheType = CONVERGENT

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/vap
                  OutputPrefix = test_CONV_VAP
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/vap
                  TempDataPrefix  = CONV_vap.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of CONV_VAPOutput
		  
          #--------------------------------------------------------------------
          # SuspenseCreateOutput stream
          #--------------------------------------------------------------------
          SuspenseCreateOutput
          {
            ModuleName = OUT_GenericStream
            EventType = /suspended_usage/telco/gsm
            Module
            {
              Grammar = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageCreationGrammar.dsc
              DeleteEmptyStream = True
		AddInvoiceData = True
              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/reject
                  OutputPrefix = suspense_create_
                  OutputSuffix = .out
                  TempPrefix = tmp
                  TempDataPath = /cdrapp_prepaid/reject
                  TempDataPrefix = susp.create.tmp.
                  TempDataSuffix = .data
                  Replace = True
                  AppendSequenceNumber = False
                }
              }
            }
          } # end of SuspenseCreateOutput

          #--------------------------------------------------------------------
          # SuspenseUpdateOutput stream
          #--------------------------------------------------------------------
          SuspenseUpdateOutput
          {
            ModuleName = OUT_GenericStream
            EventType = /tmp_suspended_usage

            Module
            {
              Grammar = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageUpdateGrammar.dsc
              DeleteEmptyStream = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/reject
                  OutputPrefix = suspense_update_
                  OutputSuffix = .out
                  TempPrefix = tmp
                  TempDataPath = /cdrapp_prepaid/reject
                  TempDataPrefix = susp.update.tmp.
                  TempDataSuffix = .data
                  Replace = True
                  AppendSequenceNumber = False
                }
              }
            }
          } # end of SuspenseUpdateOutput
          
        } # end of OutputCollection

        OutputLog
        {
          FilePath        = /var/portal/ifw/log/stream
          FileName        = stream
          FilePrefix      = Stream_
          FileSuffix      = .log
		
	  # Added by GSM
           #LogLevel = warning
           LogLevel = major

          SuppressErrors
          {
            ERR_SPEC_VERSION_INVALID
            ERR_RELEASE_VERSION_INVALID
         WRN_NO_GLID 
	 }
        }
        
        #SequenceGeneration = Unit
        SequenceGeneration = Transaction

	#-------------------------------
        EdrTraceEnabled = FALSE
        EdrTrace
        {
            TraceLog
            {
                 FilePath   = /var/portal/ifw/log/edrLog
                 FileName   = edrTraceLog
                 FilePrefix = log_
                 FileSuffix = .log
            }

            TraceStartPoint =  Input
            TraceEndPoint   = Output

        } # END EdrTrace

        
      } # end of Output    
      
    } # end of Pipeline TD_PREPAID_RATE_DATA

    TD_PREPAID_RATE_SMS
    {
      Active                      = TRUE
      
      CountryCode                 = 64 
      MobileCountryCode           = 64
      NationalAccessCode          = 0
      #InternationalAccessCode     = 00
      #InternationalAccessCodeSign = +
      NetworkDestinationCode      = 172
      RejectStream                = SuspenseCreateOutput
      
      TransactionManager
      {
        RedoEnabled = True #False
        SingleTransaction = False
        WriteToLogEnabled = True
        BinaryLogFileName = ./tam/binaryLogFileTD_PREPAID_RATE_SMS.dat
      }
      
      EdrFactory 
      { 
        DataConnection = ifw.DataPool.Login 
        Description =  ./TD/formatDesc/Portal/td_containerDesc.dsc
        UsageStatistic = /var/portal/ifw/log/statistic/edrStatisticTD_PREPAID_RATE_SNS.txt 
        EdrVersionDataConnection = ifw.DataPool.LoginInfranet
      }

      DataDescription
      {
        Standard
        {
          ModuleName = Standard
          Module
          {
            StreamFormats
            {
	      SOL42_FORINPUT = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_RATE_FORINPUT.dsc
              EVENT_LOADER = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_Format.dsc
              SUSPENSE_CREATE_OUTPUT = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageCreation.dsc
              SUSPENSE_UPDATE_OUTPUT = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageUpdate.dsc
            }

            InputMapping
            {
              SOL42_FORINPUT = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_RATE_InMap.dsc
            }

            OutputMapping
            {
              EVENT_LOADER = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutMap.dsc
              SUSPENSE_CREATE_OUTPUT = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageCreationMapping.dsc
              SUSPENSE_UPDATE_OUTPUT = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageUpdateMapping.dsc
            }
          }
        }
      } # end of DataDescription

      PipelineLog 
      { 
        ModuleName = LOG
        Module 
        { 
          ITO 
          { 
            WriteMessageKey  = True
            FilePath = /var/portal/ifw/log/pipeline
            FileName = pipeline_TD_PREPAID_RATE_SMS.log
            ProcessName = ifw
            MessageGroup = IFW
            ShowOriginator = TRUE
	    # Added by GSM
            #LogLevel = warning
            LogLevel = major
          }

          Buffer 
          { 
            #Size = 500
            #Updated by GSM
	    Size = 1000
          } 
        } 
      } # end of PipelineLog


      InputBuffer
      {
        BlockTransfer = False
        #Size = 1
        #BlockSize = 1
	#Updated by GSM
        Size = 100
        BlockSize = 100
      }

      OutputBuffer
      {
        BlockTransfer = False
        #Size = 1
        #BlockSize = 1
        #Updated by GSM
	Size = 100
        BlockSize = 100
      }
      
      #------------------------------------------------------------------------
      # Input section
      #------------------------------------------------------------------------
      Input
      {
        #UnitsPerTransaction = 1
        UnitsPerTransaction = 2

        InputModule
        {
          ModuleName  = INP_GenericStream
          Module
          {
            Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_RATE_InGrammar.dsc
            DefaultOutput = SMSPREOutput

            InputStream
            {
              ModuleName = EXT_InFileManager
              Module
              {
                InputDirEmptyTimeout = 10

                InputPath   = /cdrapp_prepaid/edr/sms
                InputPrefix = TD_RATE_PRE
                InputSuffix = .edr
 
                DonePath    = /cdrapp_prepaid/done
                DonePrefix  = test_ALLRATE
                DoneSuffix  = .done
           
                ErrorPath   = /cdrapp_prepaid/error
                ErrorPrefix = test_ALLRATE
                ErrorSuffix = .err

                TempPrefix  = tmp_ALLRATE
  
                Replace     = TRUE
              }
            } # end of InputStream
          }
        } # end of InputModule
      } # end of Input

      
      #------------------------------------------------------------------------
      # Function section
      #------------------------------------------------------------------------
      Functions 
      {
        Processing
        {
          FunctionPool
          {

            #---------------------------------------------------
            # PreSuspense FCT
            #---------------------------------------------------
            PreSuspense
            {
              ModuleName = FCT_PreSuspense
              Module
              {
                Active = True
			QueryableFields
			{

				SUSP_USAGE_TELCO_INFO_T
				{
					# format : <database_column_name> = <edr_conatiner_field_name>
					START_TIME = DETAIL.CHARGING_START_TIMESTAMP
					CALL_DURATION = DETAIL.DURATION
					CALLING_FROM = DETAIL.A_NUMBER
					CALLED_TO = DETAIL.B_NUMBER
                                        SERVICE_TYPE = DETAIL.BASIC_SERVICE
                                        USAGE_TYPE = DETAIL.USAGE_TYPE
				}
                     		SUSP_USAGE_TELCO_GSM_INFO_T
                     		{
                        		CELL_ID = DETAIL.ASS_GSMW_EXT.CELL_ID
                         		DESTINATION_SID = DETAIL.ASS_GSMW_EXT.TERMINATING_SWITCH_IDENTIFICATION
                        		DIALED_NUMBER = DETAIL.ASS_GSMW_EXT.DIALED_DIGITS
                        		ORIGIN_SID = DETAIL.ASS_GSMW_EXT.ORIGINATING_SWITCH_IDENTIFICATION 
                                     	SECONDARY_MSID = DETAIL.ASS_GSMW_EXT.PORT_NUMBER
                     		}
			}
              }
            }

            #--------------------------------------------------
            # Service Code Mapping
            #--------------------------------------------------
            ServiceCodeMap 
            { 
              ModuleName = FCT_ServiceCodeMap
              Module 
              { 
                Active             = TRUE
                DataConnection     = ifw.DataPool.Login
                MapGroup           = ALL_RATE
              } 
            } 

            #--------------------------------------------------
            # Usage Class Mapping
            #--------------------------------------------------
            UsageClassMap
            {
              ModuleName = FCT_UsageClassMap 
              Module 
              { 
                Active              = TRUE
                DataConnection      = ifw.DataPool.Login
                OverwriteUsageClass = False 
                MapGroup            = ALL_RATE
                #OptimizeFor        = Memory
              } 
            }


            #--------------------------------------------------
            # Discarding (of events)
            #--------------------------------------------------
            EventDiscarding
            {
              ModuleName = FCT_Discard
              Module
              {
                Active = TRUE
                DataConnection = ifw.DataPool.Login
                Function       = Discard
                StreamName     = DevNull
              }
            }


            #--------------------------------------------------
            # Infranet Customer
            #--------------------------------------------------
            CustomerSearch 
            { 
              ModuleName = FCT_Account
              Module 
              { 
                Active         = TRUE
                DataModule     = ifw.DataPool.CustomerData
                #DisableRatingProductCheck  = False
              }
            } 

	#---------------------------------------------------------
            # UpdateGLID - updates GLID field
            #---------------------------------------------------------
            ItemAssign
            {
              ModuleName = FCT_IScript
              Module
              {
                Active = True
                Source = File
                Scripts
                {
                  ItemAssign
                  {
                        FileName = ./TD/iScript_custom/ISC_TD_ItemTag.isc
                  }
                }
              }
            }

            #--------------------------------------------------
            # Customer Individual Rating
            #--------------------------------------------------
            CustomerRating
            { 
              ModuleName = FCT_CustomerRating 
              Module 
              { 
                Active            = TRUE
                Mode              = CUSTOMER 
                DataConnection    = ifw.DataPool.Login 
                DefaultRateplan   = Standard
                LeastCostRating   = False
                PromotionalSaving = False
              } 
            }

 
            #--------------------------------------------------
            # Pre-Rating (Zoning)
            #--------------------------------------------------
            PreRatingZone
            {
              ModuleName = FCT_PreRating
              Module
              {
                Active = True
                RateplanDataModule = ifw.DataPool.RateplanDataModule
                ZoneDataModule = ifw.DataPool.ZoneDataModule
              }
            }

	##----------------------------------------------------------------------

            # Main Rating (Pricing)
            #--------------------------------------------------
            MainRating
            {
              ModuleName = FCT_MainRating
              Module
              {
                Active                  = TRUE
                RateplanDataModule      = ifw.DataPool.RateplanDataModule
                CalendarDataModule      = ifw.DataPool.CalendarDataModule
                TimeDataModule          = ifw.DataPool.TimeDataModule
                PriceDataModule         = ifw.DataPool.PriceDataModule
                CurrencyDataModule      = ifw.DataPool.CurrencyDataModule
                ModelSelectorDataModule = ifw.DataPool.ModelSelectorDataModule
              }
            }
 	
            #--------------------------------------------------
            # Discount Analysis
            #--------------------------------------------------
            DiscountAnalysisModule
            {
              ModuleName = FCT_DiscountAnalysis
              Module
              {
                Active                   = TRUE
                #Active                   = FALSE
                DiscountModelDataModule  = ifw.DataPool.DiscountModelDataModule
                #Filter_SetModule         = ifw.Pipelines.TD_PREPAID_RATE_SMS.Functions.Processing.FunctionPool.Filter_Set 
                ModelSelectorDataModule  = ifw.DataPool.ModelSelectorDataModule

              } 
            }


            #--------------------------------------------------
            # Discounting
            #--------------------------------------------------
            ApolloDiscountModule
            {
              ModuleName = FCT_Discount
              Module
              {
                Active                   = TRUE
                #Active                   = FALSE
                DiscountDataModule       = ifw.DataPool.DiscountModelDataModule
                BalanceDataModule        = ifw.DataPool.BalanceDataModule
                AccountDataModule        = ifw.DataPool.CustomerData
                CurrencyDataModule       = ifw.DataPool.CurrencyDataModule
                DiscountMoreThanPossible = False 
                BackOut                  = False 
                SupportBundleERA         = False
                IgnoreEDROnDeadlock      = False
		IgnoreEDROnDiscountError = False
		IgnoreEDROnLock          = False
              } 
            }
	    

            #--------------------------------------------------
            # ApplyBalance
            #--------------------------------------------------
            ApolloApplyBalanceModule
            {
              ModuleName = FCT_ApplyBalance
              Module
              {
                Active                       = TRUE
                DiscountDataModule           = ifw.DataPool.DiscountModelDataModule
                BalanceDataModule            = ifw.DataPool.BalanceDataModule
                DiscountFunctionalModule     = Functions.Processing.FunctionPool.ApolloDiscountModule
                PortalConfigDataModule       = ifw.DataPool.PortalConfigDataModule
                #NumberOfNotificationLimit   = 1000
                NotificationOutputDirectory = /cdrapp_prepaid/out/notifybalancebreach
                NotificationOutputPrefix    = balancebreach_
              }
            }


            #--------------------------------------------------
            # ItemAssign PlugIn
            #--------------------------------------------------
            FlexibleItemAssignment
            {
              ModuleName = FCT_ItemAssign
              Module
              {
                 Active     = TRUE
                 DataModule     = ifw.DataPool.ItemAssignDataModule
              }
            }

            #----------------------------------------------------------------
            # Add Infranet Billing Record (plugin version)
            #----------------------------------------------------------------
            AddInfranetBillingRecord
            {
              ModuleName = FCT_BillingRecord
              Module
              {
                Active = TRUE
                CurrencyType = R
                CurrencyDataModule = ifw.DataPool.CurrencyDataModule
                ItemAssignDataModule     = ifw.DataPool.ItemAssignDataModule
                AccountDataModule  = ifw.DataPool.CustomerData
                BalanceDataModule        = ifw.DataPool.BalanceDataModule
                PortalConfigDataModule   = ifw.DataPool.PortalConfigDataModule
              }
            }

            #--------------------------------------------------
            # Split Output per ServiceCode
            #--------------------------------------------------              
            ServiceOutputPostpaidSplit
            {
              ModuleName = FCT_IRules
              Module
              {
                Active = TRUE
                Source = File
                Rules
                {
                }
                Descriptions
                {
                  ServiceCodeSplitPost = ./TD/iScript_custom/IRL_EventTypeSplittingPrepaid.irl
                }
              }
            }

            #--------------------------------------------------
            # Rejection
            #--------------------------------------------------
            Rejection
            {
              ModuleName = FCT_Reject
              Module
              {
                Active          = True 
                NotifyOnReject  = True 
                UseRejectStream = True 
                StreamMap 
                {
                  INF_IGNORE_ON_DISCOUNTACCOUNT_DEADLOCK = DiscountDeadlockOutput
                  INF_IGNORE_ON_DISCOUNT_ERROR           = DiscountErrorOutput
		  INF_IGNORE_ON_BALANCEGROUP_LOCK        = DiscountErrorOutput 
                }
		
		# This is required if FCT_CallAssembing module is being used.
		#CallAssemblingModule = ifw.Pipelines.TD_PREPAID_RATE_SMS.Functions.Processing.FunctionPool.CallAssembling
              }
            }

            #---------------------------
            # Suspense FCT
            #---------------------------
            Suspense
            {
              ModuleName  = FCT_Suspense
              Module
              {
                Active = True
                SuspenseCreateStream     = SuspenseCreateOutput
                SuspenseUpdateStream     = SuspenseUpdateOutput
                DataConnection           = ifw.DataPool.LoginInfranet
                LogTestResults           = False
                PipelineCategory         = RatingPipeline
                RecycleLog
                {
                } 
              }
            }


          } #END FunctionPool
        }
      } # END Functions

      #--------------------------------------------------
      # Output Section
      #--------------------------------------------------
      Output
      {
        WriteDefaultEdr            = False

        MaxErrorRates
        {
          INF_EDR_REJECTED = 100
          ERR_CUST_NOT_FOUND = 20
        }

        #-------------------------------------------
        # Multithreaded writing. This is recommended
        # when EDRs are associated with multiple
        # output streams.
        #------------------------------------------
        MultiThreading
        {
           Active = False      # Defaults to False
           NumberOfThreads = 1 # Number of threads spawned. Defaults to 1
           #Active = True      
           #NumberOfThreads = 7 
           BatchSize = 0       # The number of EDRs cached before sent for writing. Defaults to 0
        }


        OutputCollection
        {
          #--------------------------------------------------------------------
          # The DevNull stream
          #--------------------------------------------------------------------
          DevNull
          {
            ModuleName = OUT_DevNull
            Module
            { 
            } 
          } # end of DevNull

          ##--------------------------------------------------------------------
          ## Output stream for duplicate events
          ##--------------------------------------------------------------------
          #DuplicateOutput
          #{
          #  ModuleName = OUT_Reject
          #  Module
          #  {
          #    DeleteEmptyStream = TRUE # defaults to TRUE 
          #    OutputStream
          #    {
          #      ModuleName = EXT_OutFileManager
          #      Module
          #     {
          #        OutputPath = /cdrapp_prepaid/reject
          #        OutputPrefix = test
          #        OutputSuffix = .dup
          #        TempPrefix   = tmp
          #        TempDataPath    = /cdrapp_prepaid/reject
          #        TempDataPrefix  = dup.tmp.
          #        TempDataSuffix  = .data
          #        Replace = TRUE
          #      }
          #    }
          #  } 
          #} # end of DuplicateOutput  
	  
	  #--------------------------------------------------------------------
          # Output stream for no balance events
          #--------------------------------------------------------------------
          DiscountErrorOutput
          {
            ModuleName = OUT_Reject
            Module
            {
              DeleteEmptyStream = TRUE # defaults to TRUE
	
              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/discountError
                  OutputPrefix = test
                  OutputSuffix = .dsc
                  TempPrefix   = tmp
                  TempDataPath    = /cdrapp_prepaid/discountError
                  TempDataPrefix  = dsc.tmp.
                  TempDataSuffix  = .data
                  Replace = TRUE
                }
              }
            }
          }        
          #--------------------------------------------------------------------
	  # Output stream for dead-locked events.
	  #--------------------------------------------------------------------
	  DiscountDeadlockOutput
	  {
	    ModuleName = OUT_Reject
	    Module
	    {
	      DeleteEmptyStream = TRUE # defaults to TRUE
	      OutputStream
	      {
	        ModuleName = EXT_OutFileManager
	        Module
	        {
		  OutputPath = /cdrapp_prepaid/discountError
		  OutputPrefix = test
		  OutputSuffix = .dlk
		  TempPrefix   = tmp
		  TempDataPath    = /cdrapp_prepaid/discountError
		  TempDataPrefix  = dlk.tmp.
		  TempDataSuffix  = .data
		  Replace = TRUE
		}
	      }
	    }
	  }  # end of DiscountDeadlockOutput
 
          #--------------------------------------------------------------------
          # The /service/gsm/telephony output stream
          #--------------------------------------------------------------------
          TELPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/voice

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
               
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/telephony
                  OutputPrefix = test_TEL
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/telephony
                  TempDataPrefix  = tel.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of TELOutput

          CONV_TELPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/voice
            ObjectCacheType = CONVERGENT

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc

              DeleteEmptyStream = True # defaults to TRUE
	      AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/telephony
                  OutputPrefix = test_CONV_TEL
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/telephony
                  TempDataPrefix  = CONV_tel.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of CONV_TELOutput

          SMSPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/sms

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True


              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/sms
                  OutputPrefix = test_SMS
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/sms
                  TempDataPrefix  = sms.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of SMSOutput

          CONV_SMSPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/sms
            ObjectCacheType = CONVERGENT

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/sms
                  OutputPrefix = test_CONV_SMS
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/sms
                  TempDataPrefix  = CONV_sms.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of CONV_SMSOutput

		 #--------------------------------------------------------------------
          # The /service/telco/gsm/mms output stream
          #--------------------------------------------------------------------
          MMSPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/mms

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/mms
                  OutputPrefix = test_MMS
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/mms
                  TempDataPrefix  = mms.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of MMSOutput

          CONV_MMSPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/mms
            ObjectCacheType = CONVERGENT

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/mms
                  OutputPrefix = test_CONV_MMS
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/mms
                  TempDataPrefix  = CONV_mms.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of CONV_MMSOutput
	
	#--------------------------------------------------------------------
          # The /service/telco/gsm/voicemail output stream
          #--------------------------------------------------------------------
          VOMPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/voicemail

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/voicemail
                  OutputPrefix = test_VOM
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/voicemail
                  TempDataPrefix  = vom.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of VOMOutput

          CONV_VOMPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/voicemail
            ObjectCacheType = CONVERGENT

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/voicemail
                  OutputPrefix = test_CONV_VOM
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/voicemail
                  TempDataPrefix  = CONV_vom.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of CONV_VOMOutput
		  
	  #--------------------------------------------------------------------
          # The /service/telco/gsm/data output stream
          #--------------------------------------------------------------------
          DATPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/data

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/data
                  OutputPrefix = test_DAT
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/data
                  TempDataPrefix  = dat.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of DATOutput

          CONV_DATPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/data
            ObjectCacheType = CONVERGENT

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/data
                  OutputPrefix = test_CONV_DAT
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/data
                  TempDataPrefix  = CONV_dat.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of CONV_DATOutput
		  
	 #--------------------------------------------------------------------
          # The /service/telco/gsm/vas output stream
          #--------------------------------------------------------------------
          VASPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/vas

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/vas
                  OutputPrefix = test_VAS
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/vas
                  TempDataPrefix  = vas.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of VASOutput

          CONV_VASPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/vas
            ObjectCacheType = CONVERGENT

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/vas
                  OutputPrefix = test_CONV_VAS
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/vas
                  TempDataPrefix  = CONV_vas.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of CONV_VASOutput
		  
		 #--------------------------------------------------------------------
          # The /service/telco/gsm/valuepack output stream
          #--------------------------------------------------------------------
          VAPPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/valuepack

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/vap
                  OutputPrefix = test_VAP
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/vap
                  TempDataPrefix  = vap.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of VAPOutput

          CONV_VAPPREOutput
          {
            ModuleName = OUT_GenericStream

            ProcessType = RATING_PIPELINE
            EventType = /event/delayed/session/telco/gsm/valuepack
            ObjectCacheType = CONVERGENT

            Module
            {
              Grammar = ./TD/formatDesc/Formats/Solution42/TD_SOL42_V670_REL_OutGrammar.dsc
              DeleteEmptyStream = True # defaults to TRUE
		AddInvoiceData = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/out/vap
                  OutputPrefix = test_CONV_VAP
                  OutputSuffix = .out
                  TempPrefix   = .

                  TempDataPath    = /cdrapp_prepaid/out/vap
                  TempDataPrefix  = CONV_vap.tmp.
                  TempDataSuffix  = .data

                  Replace = TRUE
                }
              }
            }
          } # end of CONV_VAPOutput
		  
          #--------------------------------------------------------------------
          # SuspenseCreateOutput stream
          #--------------------------------------------------------------------
          SuspenseCreateOutput
          {
            ModuleName = OUT_GenericStream
            EventType = /suspended_usage/telco/gsm
            Module
            {
              Grammar = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageCreationGrammar.dsc
              DeleteEmptyStream = True
		AddInvoiceData = True
              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/reject
                  OutputPrefix = suspense_create_
                  OutputSuffix = .out
                  TempPrefix = tmp
                  TempDataPath = /cdrapp_prepaid/reject
                  TempDataPrefix = susp.create.tmp.
                  TempDataSuffix = .data
                  Replace = True
                  AppendSequenceNumber = False
                }
              }
            }
          } # end of SuspenseCreateOutput

          #--------------------------------------------------------------------
          # SuspenseUpdateOutput stream
          #--------------------------------------------------------------------
          SuspenseUpdateOutput
          {
            ModuleName = OUT_GenericStream
            EventType = /tmp_suspended_usage

            Module
            {
              Grammar = ./formatDesc/Formats/SuspenseHandling/SuspendedUsageUpdateGrammar.dsc
              DeleteEmptyStream = True

              OutputStream
              {
                ModuleName = EXT_OutFileManager
                Module
                {
                  OutputPath = /cdrapp_prepaid/reject
                  OutputPrefix = suspense_update_
                  OutputSuffix = .out
                  TempPrefix = tmp
                  TempDataPath = /cdrapp_prepaid/reject
                  TempDataPrefix = susp.update.tmp.
                  TempDataSuffix = .data
                  Replace = True
                  AppendSequenceNumber = False
                }
              }
            }
          } # end of SuspenseUpdateOutput
          
        } # end of OutputCollection

        OutputLog
        {
          FilePath        = /var/portal/ifw/log/stream
          FileName        = stream
          FilePrefix      = Stream_
          FileSuffix      = .log
		
	  # Added by GSM
           #LogLevel = warning
           LogLevel = major

          SuppressErrors
          {
            ERR_SPEC_VERSION_INVALID
            ERR_RELEASE_VERSION_INVALID
         WRN_NO_GLID 
	 }
        }
        
        #SequenceGeneration = Unit
        SequenceGeneration = Transaction

	#-------------------------------
        EdrTraceEnabled = FALSE
        EdrTrace
        {
            TraceLog
            {
                 FilePath   = /var/portal/ifw/log/edrLog
                 FileName   = edrTraceLog
                 FilePrefix = log_
                 FileSuffix = .log
            }

            TraceStartPoint =  Input
            TraceEndPoint   = Output

        } # END EdrTrace

        
      } # end of Output    
      
    } # end of Pipeline TD_PREPAID_RATE_SMS

  } # END Pipelines

} # END ifw
